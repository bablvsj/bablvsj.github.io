<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>10-AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶ä½¿ç”¨customRequestæ–¹æ³•è‡ªå®šä¹‰ä¸Šä¼ è¡Œä¸º | Bablvsj's Blog</title><meta name=keywords content="å¼€å‘è½¯ä»¶å¿«æ·ä½¿ç”¨"><meta name=description content="æœ¬æ¬¡åšåå°ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨çš„æ˜¯ AntD æ¡†æ¶ã€‚æ¶‰åŠåˆ°å›¾ç‰‡çš„ä¸Šä¼ ï¼Œç”¨çš„æ˜¯AntDçš„ upload ç»„ä»¶ã€‚ æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ã€Šå‰ç«¯AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶é‡"><meta name=author content="Lvsj"><link rel=canonical href=https://bablvsj.github.io/posts/temp/12-react%E5%9F%BA%E7%A1%80/10-antd%E6%A1%86%E6%9E%B6%E7%9A%84upload%E7%BB%84%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%97%B6%E4%BD%BF%E7%94%A8customrequest%E6%96%B9%E6%B3%95%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8A%E4%BC%A0%E8%A1%8C%E4%B8%BA/><link crossorigin=anonymous href=/assets/css/stylesheet.de52e5063d5c6e4b62255f10cab97d18893776d568014196f938b8af9e3e8caf.css integrity="sha256-3lLlBj1cbktiJV8Qyrl9GIk3dtVoAUGW+Ti4r54+jK8=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://bablvsj.github.io/img/Q.gif><link rel=apple-touch-icon href=https://bablvsj.github.io/Q.gif><link rel=mask-icon href=https://bablvsj.github.io/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="10-AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶ä½¿ç”¨customRequestæ–¹æ³•è‡ªå®šä¹‰ä¸Šä¼ è¡Œä¸º"><meta property="og:description" content="æœ¬æ¬¡åšåå°ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨çš„æ˜¯ AntD æ¡†æ¶ã€‚æ¶‰åŠåˆ°å›¾ç‰‡çš„ä¸Šä¼ ï¼Œç”¨çš„æ˜¯AntDçš„ upload ç»„ä»¶ã€‚ æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ã€Šå‰ç«¯AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶é‡"><meta property="og:type" content="article"><meta property="og:url" content="https://bablvsj.github.io/posts/temp/12-react%E5%9F%BA%E7%A1%80/10-antd%E6%A1%86%E6%9E%B6%E7%9A%84upload%E7%BB%84%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%97%B6%E4%BD%BF%E7%94%A8customrequest%E6%96%B9%E6%B3%95%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8A%E4%BC%A0%E8%A1%8C%E4%B8%BA/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-01-01T17:11:35+08:00"><meta property="article:modified_time" content="2020-01-01T17:11:35+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="10-AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶ä½¿ç”¨customRequestæ–¹æ³•è‡ªå®šä¹‰ä¸Šä¼ è¡Œä¸º"><meta name=twitter:description content="æœ¬æ¬¡åšåå°ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨çš„æ˜¯ AntD æ¡†æ¶ã€‚æ¶‰åŠåˆ°å›¾ç‰‡çš„ä¸Šä¼ ï¼Œç”¨çš„æ˜¯AntDçš„ upload ç»„ä»¶ã€‚ æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ã€Šå‰ç«¯AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶é‡"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"æ–‡ç« ","item":"https://bablvsj.github.io/posts/"},{"@type":"ListItem","position":3,"name":"10-AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶ä½¿ç”¨customRequestæ–¹æ³•è‡ªå®šä¹‰ä¸Šä¼ è¡Œä¸º","item":"https://bablvsj.github.io/posts/temp/12-react%E5%9F%BA%E7%A1%80/10-antd%E6%A1%86%E6%9E%B6%E7%9A%84upload%E7%BB%84%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%97%B6%E4%BD%BF%E7%94%A8customrequest%E6%96%B9%E6%B3%95%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8A%E4%BC%A0%E8%A1%8C%E4%B8%BA/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"10-AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶ä½¿ç”¨customRequestæ–¹æ³•è‡ªå®šä¹‰ä¸Šä¼ è¡Œä¸º","name":"10-AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶ä½¿ç”¨customRequestæ–¹æ³•è‡ªå®šä¹‰ä¸Šä¼ è¡Œä¸º","description":"æœ¬æ¬¡åšåå°ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨çš„æ˜¯ AntD æ¡†æ¶ã€‚æ¶‰åŠåˆ°å›¾ç‰‡çš„ä¸Šä¼ ï¼Œç”¨çš„æ˜¯AntDçš„ upload ç»„ä»¶ã€‚ æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ã€Šå‰ç«¯AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶é‡","keywords":["å¼€å‘è½¯ä»¶å¿«æ·ä½¿ç”¨"],"articleBody":"æœ¬æ¬¡åšåå°ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨çš„æ˜¯ AntD æ¡†æ¶ã€‚æ¶‰åŠåˆ°å›¾ç‰‡çš„ä¸Šä¼ ï¼Œç”¨çš„æ˜¯AntDçš„ upload ç»„ä»¶ã€‚\næˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ã€Šå‰ç«¯AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶é‡åˆ°çš„ä¸€äº›å‘ã€‹ä¸­è®²åˆ°ï¼šAntD çš„ upload ç»„ä»¶æœ‰å¾ˆå¤šå‘ï¼Œå¼•èµ·äº†å¾ˆå¤šäººçš„å…³æ³¨ã€‚æŠ˜è…¾è¿‡çš„äººï¼Œè‡ªç„¶æ˜ç™½å…¶ä¸­çš„è‹¦æ¥šã€‚\nä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç»§ç»­æ¥ç ”ç©¶ AntD çš„ upload ç»„ä»¶çš„å¦ä¸€ä¸ªå‘ã€‚\nå¤‡æ³¨ï¼šæœ¬æ–‡å†™äº2020-06-11ï¼Œä½¿ç”¨çš„ antd ç‰ˆæœ¬æ˜¯ 3.13.6ã€‚\nä½¿ç”¨ AntD çš„ upload ç»„ä»¶åšå›¾ç‰‡çš„ä¸Šä¼ ï¼Œæ•ˆæœæ¼”ç¤º å› ä¸ºéœ€è¦ä¸Šä¼ å¤šå¼ å›¾ç‰‡ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ˜¯ç…§ç‰‡å¢™çš„å½¢å¼ã€‚ä¸Šä¼ æˆåŠŸåçš„ç•Œé¢å¦‚ä¸‹ï¼š\nï¼ˆ1ï¼‰ä¸Šä¼ ä¸­ï¼š\nï¼ˆ2ï¼‰ä¸Šä¼ æˆåŠŸï¼š\nï¼ˆ3ï¼‰å›¾ç‰‡é¢„è§ˆï¼š\nä»£ç å®ç° é¦–å…ˆï¼Œä½ éœ€è¦è®©åå°åŒå­¦æä¾›å¥½å›¾ç‰‡ä¸Šä¼ çš„æ¥å£ã€‚ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ˜¯æŠŠæ¥å£è°ƒç”¨ç›´æ¥å†™åœ¨äº† æ ‡ç­¾çš„ action å±æ€§å½“ä¸­ã€‚ä½†å¦‚æœä½ åœ¨è°ƒæ¥å£çš„æ—¶å€™ï¼ŒåŠ¨ä½œå¾ˆå¤æ‚ï¼ˆæ¯”å¦‚æ ¹æ®ä¸šåŠ¡è¦æ±‚ï¼Œéœ€è¦è¿ç»­è°ƒä¸¤ä¸ªæ¥å£æ‰èƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œæˆ–è€…åœ¨è°ƒæ¥å£æ—¶è¿˜è¦åšå…¶ä»–çš„äº‹æƒ…ï¼‰ï¼Œè¿™ä¸ª action æ–¹æ³•å°±æ— æ³•æ»¡è¶³éœ€æ±‚äº†ã€‚é‚£è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ\nå¥½åœ¨ AntD çš„ upload ç»„ä»¶ç»™æˆ‘ä»¬æä¾›äº† customRequestè¿™ä¸ªæ–¹æ³•ï¼š\nå…³äºcustomRequest è¿™ä¸ªæ–¹æ³•ï¼Œ AntD å®˜æ–¹å¹¶æ²¡æœ‰ç»™å‡ºç¤ºä¾‹ï¼Œä»–ä»¬åªæ˜¯åœ¨ GitHub ä¸Šç»™å‡ºäº†è¿™æ ·ä¸€ä¸ªç®€çŸ­çš„ä»‹ç»ï¼š\nä½†è¿™ä¸ªæ–¹æ³•æ€ä¹ˆç”¨å‘¢ï¼Ÿç”¨çš„æ—¶å€™ï¼Œä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢ï¼ŸAntD å®˜æ–¹æ²¡æœ‰è¯´ã€‚æˆ‘åœ¨ç½‘ä¸Šæœäº†åŠå¤©ï¼Œä¹Ÿæ²¡çœ‹åˆ°æ¯”è¾ƒå®Œæ•´çš„ã€åˆ‡å®å¯è¡Œçš„ Demoã€‚æˆ‘å¤©æœåœ°å¤§ç‰©åšï¼Œç½‘ç»œèµ„æ–™æµ©å¦‚çƒŸæµ·ï¼ŒAntD å¯æ˜¯å£å£å£°å£°è¢«äººä»¬å·ç§°æ˜¯å¤©æœæœ€å¥½ç”¨çš„ç®¡ç†åå°çš„æ ·å¼æ¡†æ¶ã€‚å¯å¦‚ä»Šï¼Œå´é¢ä¸´è¿™æ ·çš„å±€é¢ã€‚æˆ‘çœ‹ç€ä½ ä»¬ï¼Œæ»¡æ€€ç¾¡æ…•ã€‚\næ—¢ç„¶å¦‚æ­¤ï¼Œé‚£æˆ‘å°±è‡ªå·±ç ”ç©¶å§ã€‚æŠ˜è…¾äº†ä¸€å¤©ï¼Œæ€»ç®—æ˜¯æŠŠ customRequest çš„å‘è¸©å¾—å·®ä¸å¤šäº†ã€‚\nå•¥ä¹Ÿä¸è¯´äº†ï¼Œç›´æ¥ä¸Šä»£ç ã€‚\né‡‡ç”¨ AntDæ¡†æ¶çš„ upload ç»„ä»¶çš„ customRequest æ–¹æ³•ï¼Œè‡ªå®šä¹‰ä¸Šä¼ è¡Œä¸ºã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 import React, { PureComponent } from 'react'; import { Button, Card, Form, message, Upload, Icon, Modal, Row, Col } from 'antd'; import { connect } from 'dva'; import { queryMyData, submitData } from '../api'; import { uploadImage } from '../../utils/wq.img.upload'; import styles from '../../utils/form.less'; const FormItem = Form.Item; @Form.create() export default class PicturesWall extends PureComponent { constructor(props) { super(props); const { id } = this.props.match.params; this.state = { id, img: undefined, // ä»æ¥å£æ‹¿åˆ°çš„å›¾ç‰‡å­—æ®µ imgList: [], // å±•ç¤ºåœ¨ antdå›¾ç‰‡ç»„ä»¶ä¸Šçš„æ•°æ® previewVisible: false, previewImage: '', }; } componentDidMount() { const { id } = this.state; id \u0026\u0026 this.queryData(); } // è°ƒæ¥å£ï¼ŒæŸ¥è¯¢å·²æœ‰çš„æ•°æ® queryData() { const { id } = this.state; queryMyData({ id, }) .then(({ ret, data }) =\u003e { if (ret == 0 \u0026\u0026 data \u0026\u0026 data.list \u0026\u0026 data.list.length) { const item = data.list[0]; const img = data.img; const imgList = item.img ? [ { uid: '1', // æ³¨æ„ï¼Œè¿™ä¸ªuidä¸€å®šä¸èƒ½å°‘ï¼Œå¦åˆ™å±•ç¤ºå¤±è´¥ name: 'hehe.png', status: 'done', url: img, }, ] : []; this.setState({ img, imgList, }); } else { return Promise.reject(); } }) .catch(() =\u003e { message.error('æŸ¥è¯¢å‡ºé”™ï¼Œè¯·é‡è¯•'); }); } handleCancel = () =\u003e this.setState({ previewVisible: false }); // æ–¹æ³•ï¼šå›¾ç‰‡é¢„è§ˆ handlePreview = (file) =\u003e { console.log('smyhvae handlePreview:' + JSON.stringify(file)); this.setState({ previewImage: file.url || file.thumbUrl, previewVisible: true, }); }; // å‚è€ƒé“¾æ¥ï¼šhttps://www.jianshu.com/p/f356f050b3c9 handleBeforeUpload = (file) =\u003e { console.log('smyhvae handleBeforeUpload file:' + JSON.stringify(file)); console.log('smyhvae handleBeforeUpload file.file:' + JSON.stringify(file.file)); console.log('smyhvae handleBeforeUpload file type:' + JSON.stringify(file.type)); //é™åˆ¶å›¾ç‰‡ æ ¼å¼ã€sizeã€åˆ†è¾¨ç‡ const isJPG = file.type === 'image/jpeg'; const isJPEG = file.type === 'image/jpeg'; const isGIF = file.type === 'image/gif'; const isPNG = file.type === 'image/png'; const isLt2M = file.size / 1024 / 1024 \u003c 1; if (!(isJPG || isJPEG || isPNG)) { Modal.error({ title: 'åªèƒ½ä¸Šä¼ JPGã€JPEGã€PNGæ ¼å¼çš„å›¾ç‰‡~', }); } else if (!isLt2M) { Modal.error({ title: 'å›¾ç‰‡è¶…è¿‡1Mé™åˆ¶ï¼Œä¸å…è®¸ä¸Šä¼ ~', }); } return (isJPG || isJPEG || isPNG) \u0026\u0026 isLt2M; }; // checkImageWH è¿”å›ä¸€ä¸ªpromise æ£€æµ‹é€šè¿‡è¿”å›resolve å¤±è´¥è¿”å›rejecté˜»æ­¢å›¾ç‰‡ä¸Šä¼  checkImageWH(file) { return new Promise(function (resolve, reject) { let filereader = new FileReader(); filereader.onload = (e) =\u003e { let src = e.target.result; const image = new Image(); image.onload = function () { // è·å–å›¾ç‰‡çš„å®½é«˜ file.width = this.width; file.height = this.height; resolve(); }; image.onerror = reject; image.src = src; }; filereader.readAsDataURL(file); }); } // å›¾ç‰‡ä¸Šä¼  doImgUpload = (options) =\u003e { const { onSuccess, onError, file, onProgress } = options; // startï¼šè¿›åº¦æ¡ç›¸å…³ // ä¼ªè£…æˆ handleChangeé‡Œé¢çš„å›¾ç‰‡ä¸Šä¼ çŠ¶æ€ const imgItem = { uid: '1', // æ³¨æ„ï¼Œè¿™ä¸ªuidä¸€å®šä¸èƒ½å°‘ï¼Œå¦åˆ™ä¸Šä¼ å¤±è´¥ name: 'hehe.png', status: 'uploading', url: '', percent: 99, // æ³¨æ„ä¸è¦å†™100ã€‚100è¡¨ç¤ºä¸Šä¼ å®Œæˆ }; this.setState({ imgList: [imgItem], }); // æ›´æ–° imgList // endï¼šè¿›åº¦æ¡ç›¸å…³ const reader = new FileReader(); reader.readAsDataURL(file); // è¯»å–å›¾ç‰‡æ–‡ä»¶ reader.onload = (file) =\u003e { const params = { myBase64: file.target.result, // æŠŠ æœ¬åœ°å›¾ç‰‡çš„base64ç¼–ç ä¼ ç»™åå°ï¼Œè°ƒæ¥å£ï¼Œç”Ÿæˆå›¾ç‰‡çš„url }; // ä¸Šä¼ å›¾ç‰‡çš„base64ç¼–ç ï¼Œè°ƒæ¥å£åï¼Œè¿”å› imageId uploadImage(params) .then((res) =\u003e { console.log('smyhvae doImgUpload:' + JSON.stringify(res)); console.log('smyhvae å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼š' + res.imageUrl); const imgItem = { uid: '1', // æ³¨æ„ï¼Œè¿™ä¸ªuidä¸€å®šä¸èƒ½å°‘ï¼Œå¦åˆ™ä¸Šä¼ å¤±è´¥ name: 'hehe.png', status: 'done', url: res.imageUrl, // url æ˜¯å±•ç¤ºåœ¨é¡µé¢ä¸Šçš„ç»å¯¹é“¾æ¥ imgUrl: res.imageUrl, // imgUrl æ˜¯å­˜åˆ° db é‡Œçš„ç›¸å¯¹é“¾æ¥ // response: '{\"status\": \"success\"}', }; this.setState({ imgList: [imgItem], }); // æ›´æ–° imgList }) .catch((e) =\u003e { console.log('smyhvae å›¾ç‰‡ä¸Šä¼ å¤±è´¥:' + JSON.stringify(e || '')); message.error('å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•'); }); }; }; handleChange = ({ file, fileList }) =\u003e { console.log('smyhvae handleChange file:' + JSON.stringify(file)); console.log('smyhvae handleChange fileList:' + JSON.stringify(fileList)); if (file.status == 'removed') { this.setState({ imgList: [], }); } }; submit = (e) =\u003e { e.preventDefault(); this.props.form.validateFields((err, fieldsValue) =\u003e { if (err) { return; } const { id, imgList } = this.state; const tempImgList = imgList.filter((item) =\u003e item.status == 'done'); // ç­›é€‰å‡º status = done çš„å›¾ç‰‡ const imgArr = []; tempImgList.forEach((item) =\u003e { imgArr.push(item.imgUrl); // imgArr.push(item.url); }); submitData({ id, img: imgArr[0] || '', // 1ã€æš‚æ—¶åªä¼ ä¸€å¼ å›¾ç‰‡ç»™åå°ã€‚å¦‚æœä¼ å¤šå¼ å›¾ç‰‡ï¼Œé‚£ä¹ˆï¼Œuploadç»„ä»¶éœ€è¦è¿›ä¸€æ­¥å®Œå–„ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œä»¥åæœ‰éœ€æ±‚å†ä¼˜åŒ–ã€‚2ã€å¦‚æœå›¾ç‰‡å­—æ®µæ˜¯é€‰å¡«ï¼Œé‚£å°±ç”¨ç©ºå­—ç¬¦ä¸²å…œåº• }) .then((res) =\u003e { if (res.ret == 0) { message.success(`${id ? 'ä¿®æ”¹' : 'æ–°å¢'}æˆåŠŸï¼Œè‡ªåŠ¨è·³è½¬ä¸­...`); } else if (res.ret == 201 || res.ret == 202 || res.ret == 203 || res.ret == 6) { return Promise.reject(res.msg); } else { return Promise.reject(); } }) .catch((e) =\u003e { message.error(e || 'æäº¤å¤±è´¥ï¼Œè¯·é‡è¯•'); }); }); }; render() { const { id, imgList } = this.state; console.log('smyhvae render imgList:' + JSON.stringify(imgList)); const { getFieldDecorator } = this.props.form; const formItemLayout = { labelCol: { span: 3 }, wrapperCol: { span: 10 }, }; const buttonItemLayout = { wrapperCol: { span: 10, offset: 3 }, }; const uploadButton = ( \"plus\" /\u003e \"ant-upload-text\"\u003eUpload\u003c/div\u003e \u003c/div\u003e ); return ( ","wordCount":"2628","inLanguage":"en","datePublished":"2020-01-01T17:11:35+08:00","dateModified":"2020-01-01T17:11:35+08:00","author":{"@type":"Person","name":"Lvsj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bablvsj.github.io/posts/temp/12-react%E5%9F%BA%E7%A1%80/10-antd%E6%A1%86%E6%9E%B6%E7%9A%84upload%E7%BB%84%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%97%B6%E4%BD%BF%E7%94%A8customrequest%E6%96%B9%E6%B3%95%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%8A%E4%BC%A0%E8%A1%8C%E4%B8%BA/"},"publisher":{"@type":"Organization","name":"Bablvsj's Blog","logo":{"@type":"ImageObject","url":"https://bablvsj.github.io/img/Q.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bablvsj.github.io accesskey=h title="Bablvsj's Blog (Alt + H)">Bablvsj's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bablvsj.github.io/ title=ä¸»é¡µ><span>ä¸»é¡µ</span></a></li><li><a href=https://bablvsj.github.io/archives/ title=æ—¶é—´è½´><span>æ—¶é—´è½´</span></a></li><li><a href=https://bablvsj.github.io/categories title=åˆ†ç±»><span>åˆ†ç±»</span></a></li><li><a href=https://bablvsj.github.io/tags title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://bablvsj.github.io/about title=å…³äº><span>å…³äº</span></a></li><li><a href=https://bablvsj.github.io/search title="ğŸ” (Alt + /)" accesskey=/><span>ğŸ”</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>10-AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶ä½¿ç”¨customRequestæ–¹æ³•è‡ªå®šä¹‰ä¸Šä¼ è¡Œä¸º</h1><div class=post-meta><span title='2020-01-01 17:11:35 +0800 +0800'>2020/01/01</span>&nbsp;Â·&nbsp;6 min&nbsp;Â·&nbsp;Lvsj<ul class=post-tags-meta><a href=https://bablvsj.github.io/tags/%E5%BC%80%E5%8F%91%E8%BD%AF%E4%BB%B6%E5%BF%AB%E6%8D%B7%E4%BD%BF%E7%94%A8/>å¼€å‘è½¯ä»¶å¿«æ·ä½¿ç”¨</a></ul></div></header><aside id=toc-container class="toc-container wide"><div class=toc><div class=inner><ul><li><a href=#%e4%bd%bf%e7%94%a8-antd-%e7%9a%84-upload-%e7%bb%84%e4%bb%b6%e5%81%9a%e5%9b%be%e7%89%87%e7%9a%84%e4%b8%8a%e4%bc%a0%e6%95%88%e6%9e%9c%e6%bc%94%e7%a4%ba aria-label="ä½¿ç”¨ AntD çš„ upload ç»„ä»¶åšå›¾ç‰‡çš„ä¸Šä¼ ï¼Œæ•ˆæœæ¼”ç¤º">ä½¿ç”¨ AntD çš„ upload ç»„ä»¶åšå›¾ç‰‡çš„ä¸Šä¼ ï¼Œæ•ˆæœæ¼”ç¤º</a></li><li><a href=#%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0 aria-label=ä»£ç å®ç°>ä»£ç å®ç°</a></li><li><a href=#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5 aria-label=å‚è€ƒé“¾æ¥>å‚è€ƒé“¾æ¥</a></li></ul></div></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>æœ¬æ¬¡åšåå°ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨çš„æ˜¯ AntD æ¡†æ¶ã€‚æ¶‰åŠåˆ°å›¾ç‰‡çš„ä¸Šä¼ ï¼Œç”¨çš„æ˜¯AntDçš„ <a href=https://ant.design/components/upload-cn/>upload</a> ç»„ä»¶ã€‚</p><p>æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ã€Š<a href=https://www.cnblogs.com/qianguyihao/p/10460834.html>å‰ç«¯AntDæ¡†æ¶çš„uploadç»„ä»¶ä¸Šä¼ å›¾ç‰‡æ—¶é‡åˆ°çš„ä¸€äº›å‘</a>ã€‹ä¸­è®²åˆ°ï¼šAntD çš„ upload ç»„ä»¶æœ‰å¾ˆå¤šå‘ï¼Œå¼•èµ·äº†å¾ˆå¤šäººçš„å…³æ³¨ã€‚æŠ˜è…¾è¿‡çš„äººï¼Œè‡ªç„¶æ˜ç™½å…¶ä¸­çš„è‹¦æ¥šã€‚</p><p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç»§ç»­æ¥ç ”ç©¶ AntD çš„ upload ç»„ä»¶çš„å¦ä¸€ä¸ªå‘ã€‚</p><p>å¤‡æ³¨ï¼šæœ¬æ–‡å†™äº2020-06-11ï¼Œä½¿ç”¨çš„ antd ç‰ˆæœ¬æ˜¯ 3.13.6ã€‚</p><h2 id=ä½¿ç”¨-antd-çš„-upload-ç»„ä»¶åšå›¾ç‰‡çš„ä¸Šä¼ æ•ˆæœæ¼”ç¤º>ä½¿ç”¨ AntD çš„ upload ç»„ä»¶åšå›¾ç‰‡çš„ä¸Šä¼ ï¼Œæ•ˆæœæ¼”ç¤º<a hidden class=anchor aria-hidden=true href=#ä½¿ç”¨-antd-çš„-upload-ç»„ä»¶åšå›¾ç‰‡çš„ä¸Šä¼ æ•ˆæœæ¼”ç¤º>#</a></h2><p>å› ä¸ºéœ€è¦ä¸Šä¼ å¤šå¼ å›¾ç‰‡ï¼Œæ‰€ä»¥é‡‡ç”¨çš„æ˜¯ç…§ç‰‡å¢™çš„å½¢å¼ã€‚ä¸Šä¼ æˆåŠŸåçš„ç•Œé¢å¦‚ä¸‹ï¼š</p><p>ï¼ˆ1ï¼‰ä¸Šä¼ ä¸­ï¼š</p><p><img loading=lazy src=http://img.smyhvae.com/20190302_1335.png alt></p><p>ï¼ˆ2ï¼‰ä¸Šä¼ æˆåŠŸï¼š</p><p><img loading=lazy src=http://img.smyhvae.com/20190302_1336.png alt></p><p>ï¼ˆ3ï¼‰å›¾ç‰‡é¢„è§ˆï¼š</p><p><img loading=lazy src=http://img.smyhvae.com/20190302_1331.png alt></p><h2 id=ä»£ç å®ç°>ä»£ç å®ç°<a hidden class=anchor aria-hidden=true href=#ä»£ç å®ç°>#</a></h2><p>é¦–å…ˆï¼Œä½ éœ€è¦è®©åå°åŒå­¦æä¾›å¥½å›¾ç‰‡ä¸Šä¼ çš„æ¥å£ã€‚ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ˜¯æŠŠæ¥å£è°ƒç”¨ç›´æ¥å†™åœ¨äº† <code>&lt;Upload></code> æ ‡ç­¾çš„ action å±æ€§å½“ä¸­ã€‚ä½†å¦‚æœä½ åœ¨è°ƒæ¥å£çš„æ—¶å€™ï¼ŒåŠ¨ä½œå¾ˆå¤æ‚ï¼ˆæ¯”å¦‚æ ¹æ®ä¸šåŠ¡è¦æ±‚ï¼Œéœ€è¦è¿ç»­è°ƒä¸¤ä¸ªæ¥å£æ‰èƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œæˆ–è€…åœ¨è°ƒæ¥å£æ—¶è¿˜è¦åšå…¶ä»–çš„äº‹æƒ…ï¼‰ï¼Œè¿™ä¸ª action æ–¹æ³•å°±æ— æ³•æ»¡è¶³éœ€æ±‚äº†ã€‚é‚£è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>å¥½åœ¨ AntD çš„ upload ç»„ä»¶ç»™æˆ‘ä»¬æä¾›äº† <code>customRequest</code>è¿™ä¸ªæ–¹æ³•ï¼š</p><p><img loading=lazy src=http://img.smyhvae.com/20200611_1543.png alt></p><p>å…³äºcustomRequest è¿™ä¸ªæ–¹æ³•ï¼Œ AntD å®˜æ–¹å¹¶æ²¡æœ‰ç»™å‡ºç¤ºä¾‹ï¼Œä»–ä»¬åªæ˜¯åœ¨ GitHub ä¸Šç»™å‡ºäº†è¿™æ ·ä¸€ä¸ªç®€çŸ­çš„ä»‹ç»ï¼š</p><p><img loading=lazy src=http://img.smyhvae.com/20200611_1536.png alt></p><p>ä½†è¿™ä¸ªæ–¹æ³•æ€ä¹ˆç”¨å‘¢ï¼Ÿç”¨çš„æ—¶å€™ï¼Œä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢ï¼ŸAntD å®˜æ–¹æ²¡æœ‰è¯´ã€‚æˆ‘åœ¨ç½‘ä¸Šæœäº†åŠå¤©ï¼Œä¹Ÿæ²¡çœ‹åˆ°æ¯”è¾ƒå®Œæ•´çš„ã€åˆ‡å®å¯è¡Œçš„ Demoã€‚æˆ‘å¤©æœåœ°å¤§ç‰©åšï¼Œç½‘ç»œèµ„æ–™æµ©å¦‚çƒŸæµ·ï¼ŒAntD å¯æ˜¯å£å£å£°å£°è¢«äººä»¬å·ç§°æ˜¯å¤©æœæœ€å¥½ç”¨çš„ç®¡ç†åå°çš„æ ·å¼æ¡†æ¶ã€‚å¯å¦‚ä»Šï¼Œå´é¢ä¸´è¿™æ ·çš„å±€é¢ã€‚æˆ‘çœ‹ç€ä½ ä»¬ï¼Œæ»¡æ€€ç¾¡æ…•ã€‚</p><p>æ—¢ç„¶å¦‚æ­¤ï¼Œé‚£æˆ‘å°±è‡ªå·±ç ”ç©¶å§ã€‚æŠ˜è…¾äº†ä¸€å¤©ï¼Œæ€»ç®—æ˜¯æŠŠ customRequest çš„å‘è¸©å¾—å·®ä¸å¤šäº†ã€‚</p><p>å•¥ä¹Ÿä¸è¯´äº†ï¼Œç›´æ¥ä¸Šä»£ç ã€‚</p><p>é‡‡ç”¨ AntDæ¡†æ¶çš„ <a href=https://ant.design/components/upload-cn/>upload</a> ç»„ä»¶çš„ customRequest æ–¹æ³•ï¼Œè‡ªå®šä¹‰ä¸Šä¼ è¡Œä¸ºã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">  9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 57
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 58
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 66
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 67
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 70
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 71
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 72
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 73
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 74
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 75
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 76
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 77
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 78
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 79
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 80
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 81
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 82
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 83
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 84
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 85
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 86
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 87
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 88
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 89
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 90
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 91
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 92
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 93
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 94
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 95
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 96
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 97
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 98
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 99
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">100
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">101
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">102
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">103
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">104
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">105
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">106
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">107
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">108
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">109
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">110
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">111
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">112
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">113
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">114
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">115
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">116
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">117
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">118
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">119
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">120
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">121
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">122
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">123
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">124
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">125
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">126
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">127
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">128
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">129
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">130
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">131
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">132
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">133
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">134
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">135
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">136
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">137
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">138
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">139
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">140
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">141
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">142
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">143
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">144
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">145
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">146
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">147
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">148
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">149
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">150
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">151
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">152
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">153
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">154
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">155
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">156
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">157
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">158
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">159
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">160
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">161
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">162
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">163
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">164
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">165
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">166
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">167
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">168
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">169
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">170
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">171
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">172
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">173
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">174
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">175
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">176
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">177
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">178
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">179
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">180
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">181
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">182
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">183
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">184
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">185
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">186
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">187
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">188
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">189
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">190
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">191
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">192
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">193
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">194
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">195
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">196
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">197
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">198
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">199
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">200
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">201
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">202
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">203
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">204
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">205
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">206
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">207
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">208
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">209
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">210
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">211
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">212
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">213
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">214
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">215
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">216
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">217
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">218
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">219
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">220
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">221
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">222
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">223
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">224
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">225
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">226
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">227
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">228
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">229
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">230
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">231
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">232
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">233
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">234
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">235
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">236
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">237
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">238
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">239
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">240
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">241
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">242
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">243
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">244
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">245
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">246
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">247
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">248
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">249
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">250
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">251
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">252
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">253
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">254
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">255
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">256
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">257
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">258
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">259
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">260
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">261
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">262
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">263
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">264
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">265
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">266
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">267
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">268
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">269
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">270
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">271
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">272
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">273
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">274
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">275
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">276
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">277
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">278
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">279
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">280
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">281
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">282
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">283
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> React, { PureComponent } from <span style=color:#0ff;font-weight:700>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> { Button, Card, Form, message, Upload, Icon, Modal, Row, Col } from <span style=color:#0ff;font-weight:700>&#39;antd&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> { connect } from <span style=color:#0ff;font-weight:700>&#39;dva&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> { queryMyData, submitData } from <span style=color:#0ff;font-weight:700>&#39;../api&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> { uploadImage } from <span style=color:#0ff;font-weight:700>&#39;../../utils/wq.img.upload&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>import</span> styles from <span style=color:#0ff;font-weight:700>&#39;../../utils/form.less&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>const</span> FormItem = Form.Item;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:red>@</span>Form.create()
</span></span><span style=display:flex><span><span style=color:#fff;font-weight:700>export</span> <span style=color:#fff;font-weight:700>default</span> <span style=color:#fff;font-weight:700>class</span> PicturesWall <span style=color:#fff;font-weight:700>extends</span> PureComponent {
</span></span><span style=display:flex><span>  constructor(props) {
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>super</span>(props);
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> { id } = <span style=color:#fff;font-weight:700>this</span>.props.match.params;
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>this</span>.state = {
</span></span><span style=display:flex><span>      id,
</span></span><span style=display:flex><span>      img: <span style=color:#fff;font-weight:700>undefined</span>, <span style=color:#007f7f>// ä»æ¥å£æ‹¿åˆ°çš„å›¾ç‰‡å­—æ®µ
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>      imgList: [], <span style=color:#007f7f>// å±•ç¤ºåœ¨ antdå›¾ç‰‡ç»„ä»¶ä¸Šçš„æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>      previewVisible: <span style=color:#fff;font-weight:700>false</span>,
</span></span><span style=display:flex><span>      previewImage: <span style=color:#0ff;font-weight:700>&#39;&#39;</span>,
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  componentDidMount() {
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> { id } = <span style=color:#fff;font-weight:700>this</span>.state;
</span></span><span style=display:flex><span>    id &amp;&amp; <span style=color:#fff;font-weight:700>this</span>.queryData();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>// è°ƒæ¥å£ï¼ŒæŸ¥è¯¢å·²æœ‰çš„æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>  queryData() {
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> { id } = <span style=color:#fff;font-weight:700>this</span>.state;
</span></span><span style=display:flex><span>    queryMyData({
</span></span><span style=display:flex><span>      id,
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>      .then(({ ret, data }) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>if</span> (ret == <span style=color:#ff0;font-weight:700>0</span> &amp;&amp; data &amp;&amp; data.list &amp;&amp; data.list.length) {
</span></span><span style=display:flex><span>          <span style=color:#fff;font-weight:700>const</span> item = data.list[<span style=color:#ff0;font-weight:700>0</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#fff;font-weight:700>const</span> img = data.img;
</span></span><span style=display:flex><span>          <span style=color:#fff;font-weight:700>const</span> imgList = item.img
</span></span><span style=display:flex><span>            ? [
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                uid: <span style=color:#0ff;font-weight:700>&#39;1&#39;</span>, <span style=color:#007f7f>// æ³¨æ„ï¼Œè¿™ä¸ªuidä¸€å®šä¸èƒ½å°‘ï¼Œå¦åˆ™å±•ç¤ºå¤±è´¥
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>                name: <span style=color:#0ff;font-weight:700>&#39;hehe.png&#39;</span>,
</span></span><span style=display:flex><span>                status: <span style=color:#0ff;font-weight:700>&#39;done&#39;</span>,
</span></span><span style=display:flex><span>                url: img,
</span></span><span style=display:flex><span>              },
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>            : [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#fff;font-weight:700>this</span>.setState({
</span></span><span style=display:flex><span>            img,
</span></span><span style=display:flex><span>            imgList,
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        } <span style=color:#fff;font-weight:700>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#fff;font-weight:700>return</span> <span style=color:#fff;font-weight:700>Promise</span>.reject();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>      .<span style=color:#fff;font-weight:700>catch</span>(() =&gt; {
</span></span><span style=display:flex><span>        message.error(<span style=color:#0ff;font-weight:700>&#39;æŸ¥è¯¢å‡ºé”™ï¼Œè¯·é‡è¯•&#39;</span>);
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  handleCancel = () =&gt; <span style=color:#fff;font-weight:700>this</span>.setState({ previewVisible: <span style=color:#fff;font-weight:700>false</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>// æ–¹æ³•ï¼šå›¾ç‰‡é¢„è§ˆ
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>  handlePreview = (file) =&gt; {
</span></span><span style=display:flex><span>    console.log(<span style=color:#0ff;font-weight:700>&#39;smyhvae handlePreview:&#39;</span> + JSON.stringify(file));
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>this</span>.setState({
</span></span><span style=display:flex><span>      previewImage: file.url || file.thumbUrl,
</span></span><span style=display:flex><span>      previewVisible: <span style=color:#fff;font-weight:700>true</span>,
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>// å‚è€ƒé“¾æ¥ï¼šhttps://www.jianshu.com/p/f356f050b3c9
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>  handleBeforeUpload = (file) =&gt; {
</span></span><span style=display:flex><span>    console.log(<span style=color:#0ff;font-weight:700>&#39;smyhvae handleBeforeUpload file:&#39;</span> + JSON.stringify(file));
</span></span><span style=display:flex><span>    console.log(<span style=color:#0ff;font-weight:700>&#39;smyhvae handleBeforeUpload file.file:&#39;</span> + JSON.stringify(file.file));
</span></span><span style=display:flex><span>    console.log(<span style=color:#0ff;font-weight:700>&#39;smyhvae handleBeforeUpload file type:&#39;</span> + JSON.stringify(file.type));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#007f7f>//é™åˆ¶å›¾ç‰‡ æ ¼å¼ã€sizeã€åˆ†è¾¨ç‡
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>    <span style=color:#fff;font-weight:700>const</span> isJPG = file.type === <span style=color:#0ff;font-weight:700>&#39;image/jpeg&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> isJPEG = file.type === <span style=color:#0ff;font-weight:700>&#39;image/jpeg&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> isGIF = file.type === <span style=color:#0ff;font-weight:700>&#39;image/gif&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> isPNG = file.type === <span style=color:#0ff;font-weight:700>&#39;image/png&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> isLt2M = file.size / <span style=color:#ff0;font-weight:700>1024</span> / <span style=color:#ff0;font-weight:700>1024</span> &lt; <span style=color:#ff0;font-weight:700>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>if</span> (!(isJPG || isJPEG || isPNG)) {
</span></span><span style=display:flex><span>      Modal.error({
</span></span><span style=display:flex><span>        title: <span style=color:#0ff;font-weight:700>&#39;åªèƒ½ä¸Šä¼ JPGã€JPEGã€PNGæ ¼å¼çš„å›¾ç‰‡~&#39;</span>,
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    } <span style=color:#fff;font-weight:700>else</span> <span style=color:#fff;font-weight:700>if</span> (!isLt2M) {
</span></span><span style=display:flex><span>      Modal.error({
</span></span><span style=display:flex><span>        title: <span style=color:#0ff;font-weight:700>&#39;å›¾ç‰‡è¶…è¿‡1Mé™åˆ¶ï¼Œä¸å…è®¸ä¸Šä¼ ~&#39;</span>,
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>return</span> (isJPG || isJPEG || isPNG) &amp;&amp; isLt2M;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>// checkImageWH  è¿”å›ä¸€ä¸ªpromise  æ£€æµ‹é€šè¿‡è¿”å›resolve  å¤±è´¥è¿”å›rejecté˜»æ­¢å›¾ç‰‡ä¸Šä¼ 
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>  checkImageWH(file) {
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>return</span> <span style=color:#fff;font-weight:700>new</span> <span style=color:#fff;font-weight:700>Promise</span>(<span style=color:#fff;font-weight:700>function</span> (resolve, reject) {
</span></span><span style=display:flex><span>      <span style=color:#fff;font-weight:700>let</span> filereader = <span style=color:#fff;font-weight:700>new</span> FileReader();
</span></span><span style=display:flex><span>      filereader.onload = (e) =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>let</span> src = e.target.result;
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>const</span> image = <span style=color:#fff;font-weight:700>new</span> Image();
</span></span><span style=display:flex><span>        image.onload = <span style=color:#fff;font-weight:700>function</span> () {
</span></span><span style=display:flex><span>          <span style=color:#007f7f>// è·å–å›¾ç‰‡çš„å®½é«˜
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>          file.width = <span style=color:#fff;font-weight:700>this</span>.width;
</span></span><span style=display:flex><span>          file.height = <span style=color:#fff;font-weight:700>this</span>.height;
</span></span><span style=display:flex><span>          resolve();
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        image.onerror = reject;
</span></span><span style=display:flex><span>        image.src = src;
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      filereader.readAsDataURL(file);
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#007f7f>// å›¾ç‰‡ä¸Šä¼ 
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>  doImgUpload = (options) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> { onSuccess, onError, file, onProgress } = options;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#007f7f>// startï¼šè¿›åº¦æ¡ç›¸å…³
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>    <span style=color:#007f7f>// ä¼ªè£…æˆ handleChangeé‡Œé¢çš„å›¾ç‰‡ä¸Šä¼ çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>    <span style=color:#fff;font-weight:700>const</span> imgItem = {
</span></span><span style=display:flex><span>      uid: <span style=color:#0ff;font-weight:700>&#39;1&#39;</span>, <span style=color:#007f7f>// æ³¨æ„ï¼Œè¿™ä¸ªuidä¸€å®šä¸èƒ½å°‘ï¼Œå¦åˆ™ä¸Šä¼ å¤±è´¥
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>      name: <span style=color:#0ff;font-weight:700>&#39;hehe.png&#39;</span>,
</span></span><span style=display:flex><span>      status: <span style=color:#0ff;font-weight:700>&#39;uploading&#39;</span>,
</span></span><span style=display:flex><span>      url: <span style=color:#0ff;font-weight:700>&#39;&#39;</span>,
</span></span><span style=display:flex><span>      percent: <span style=color:#ff0;font-weight:700>99</span>, <span style=color:#007f7f>// æ³¨æ„ä¸è¦å†™100ã€‚100è¡¨ç¤ºä¸Šä¼ å®Œæˆ
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>this</span>.setState({
</span></span><span style=display:flex><span>      imgList: [imgItem],
</span></span><span style=display:flex><span>    }); <span style=color:#007f7f>// æ›´æ–° imgList
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>    <span style=color:#007f7f>// endï¼šè¿›åº¦æ¡ç›¸å…³
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> reader = <span style=color:#fff;font-weight:700>new</span> FileReader();
</span></span><span style=display:flex><span>    reader.readAsDataURL(file); <span style=color:#007f7f>// è¯»å–å›¾ç‰‡æ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>
</span></span><span style=display:flex><span>    reader.onload = (file) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#fff;font-weight:700>const</span> params = {
</span></span><span style=display:flex><span>        myBase64: file.target.result, <span style=color:#007f7f>// æŠŠ æœ¬åœ°å›¾ç‰‡çš„base64ç¼–ç ä¼ ç»™åå°ï¼Œè°ƒæ¥å£ï¼Œç”Ÿæˆå›¾ç‰‡çš„url
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>      };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#007f7f>// ä¸Šä¼ å›¾ç‰‡çš„base64ç¼–ç ï¼Œè°ƒæ¥å£åï¼Œè¿”å› imageId
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>      uploadImage(params)
</span></span><span style=display:flex><span>        .then((res) =&gt; {
</span></span><span style=display:flex><span>          console.log(<span style=color:#0ff;font-weight:700>&#39;smyhvae doImgUpload:&#39;</span> + JSON.stringify(res));
</span></span><span style=display:flex><span>          console.log(<span style=color:#0ff;font-weight:700>&#39;smyhvae å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼š&#39;</span> + res.imageUrl);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#fff;font-weight:700>const</span> imgItem = {
</span></span><span style=display:flex><span>            uid: <span style=color:#0ff;font-weight:700>&#39;1&#39;</span>, <span style=color:#007f7f>// æ³¨æ„ï¼Œè¿™ä¸ªuidä¸€å®šä¸èƒ½å°‘ï¼Œå¦åˆ™ä¸Šä¼ å¤±è´¥
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>            name: <span style=color:#0ff;font-weight:700>&#39;hehe.png&#39;</span>,
</span></span><span style=display:flex><span>            status: <span style=color:#0ff;font-weight:700>&#39;done&#39;</span>,
</span></span><span style=display:flex><span>            url: res.imageUrl, <span style=color:#007f7f>// url æ˜¯å±•ç¤ºåœ¨é¡µé¢ä¸Šçš„ç»å¯¹é“¾æ¥
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>            imgUrl: res.imageUrl, <span style=color:#007f7f>// imgUrl æ˜¯å­˜åˆ° db é‡Œçš„ç›¸å¯¹é“¾æ¥
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>            <span style=color:#007f7f>// response: &#39;{&#34;status&#34;: &#34;success&#34;}&#39;,
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>          };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#fff;font-weight:700>this</span>.setState({
</span></span><span style=display:flex><span>            imgList: [imgItem],
</span></span><span style=display:flex><span>          }); <span style=color:#007f7f>// æ›´æ–° imgList
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>        })
</span></span><span style=display:flex><span>        .<span style=color:#fff;font-weight:700>catch</span>((e) =&gt; {
</span></span><span style=display:flex><span>          console.log(<span style=color:#0ff;font-weight:700>&#39;smyhvae å›¾ç‰‡ä¸Šä¼ å¤±è´¥:&#39;</span> + JSON.stringify(e || <span style=color:#0ff;font-weight:700>&#39;&#39;</span>));
</span></span><span style=display:flex><span>          message.error(<span style=color:#0ff;font-weight:700>&#39;å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•&#39;</span>);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  handleChange = ({ file, fileList }) =&gt; {
</span></span><span style=display:flex><span>    console.log(<span style=color:#0ff;font-weight:700>&#39;smyhvae handleChange file:&#39;</span> + JSON.stringify(file));
</span></span><span style=display:flex><span>    console.log(<span style=color:#0ff;font-weight:700>&#39;smyhvae handleChange fileList:&#39;</span> + JSON.stringify(fileList));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>if</span> (file.status == <span style=color:#0ff;font-weight:700>&#39;removed&#39;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#fff;font-weight:700>this</span>.setState({
</span></span><span style=display:flex><span>        imgList: [],
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  submit = (e) =&gt; {
</span></span><span style=display:flex><span>    e.preventDefault();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>this</span>.props.form.validateFields((err, fieldsValue) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#fff;font-weight:700>if</span> (err) {
</span></span><span style=display:flex><span>        <span style=color:#fff;font-weight:700>return</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#fff;font-weight:700>const</span> { id, imgList } = <span style=color:#fff;font-weight:700>this</span>.state;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#fff;font-weight:700>const</span> tempImgList = imgList.filter((item) =&gt; item.status == <span style=color:#0ff;font-weight:700>&#39;done&#39;</span>); <span style=color:#007f7f>// ç­›é€‰å‡º status = done çš„å›¾ç‰‡
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>      <span style=color:#fff;font-weight:700>const</span> imgArr = [];
</span></span><span style=display:flex><span>      tempImgList.forEach((item) =&gt; {
</span></span><span style=display:flex><span>        imgArr.push(item.imgUrl);
</span></span><span style=display:flex><span>        <span style=color:#007f7f>// imgArr.push(item.url);
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>      });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      submitData({
</span></span><span style=display:flex><span>        id,
</span></span><span style=display:flex><span>        img: imgArr[<span style=color:#ff0;font-weight:700>0</span>] || <span style=color:#0ff;font-weight:700>&#39;&#39;</span>, <span style=color:#007f7f>// 1ã€æš‚æ—¶åªä¼ ä¸€å¼ å›¾ç‰‡ç»™åå°ã€‚å¦‚æœä¼ å¤šå¼ å›¾ç‰‡ï¼Œé‚£ä¹ˆï¼Œuploadç»„ä»¶éœ€è¦è¿›ä¸€æ­¥å®Œå–„ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œä»¥åæœ‰éœ€æ±‚å†ä¼˜åŒ–ã€‚2ã€å¦‚æœå›¾ç‰‡å­—æ®µæ˜¯é€‰å¡«ï¼Œé‚£å°±ç”¨ç©ºå­—ç¬¦ä¸²å…œåº•
</span></span></span><span style=display:flex><span><span style=color:#007f7f></span>      })
</span></span><span style=display:flex><span>        .then((res) =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#fff;font-weight:700>if</span> (res.ret == <span style=color:#ff0;font-weight:700>0</span>) {
</span></span><span style=display:flex><span>            message.success(<span style=color:#0ff;font-weight:700>`</span><span style=color:#0ff;font-weight:700>${</span>id ? <span style=color:#0ff;font-weight:700>&#39;ä¿®æ”¹&#39;</span> : <span style=color:#0ff;font-weight:700>&#39;æ–°å¢&#39;</span><span style=color:#0ff;font-weight:700>}</span><span style=color:#0ff;font-weight:700>æˆåŠŸï¼Œè‡ªåŠ¨è·³è½¬ä¸­...`</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          } <span style=color:#fff;font-weight:700>else</span> <span style=color:#fff;font-weight:700>if</span> (res.ret == <span style=color:#ff0;font-weight:700>201</span> || res.ret == <span style=color:#ff0;font-weight:700>202</span> || res.ret == <span style=color:#ff0;font-weight:700>203</span> || res.ret == <span style=color:#ff0;font-weight:700>6</span>) {
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>return</span> <span style=color:#fff;font-weight:700>Promise</span>.reject(res.msg);
</span></span><span style=display:flex><span>          } <span style=color:#fff;font-weight:700>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#fff;font-weight:700>return</span> <span style=color:#fff;font-weight:700>Promise</span>.reject();
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        .<span style=color:#fff;font-weight:700>catch</span>((e) =&gt; {
</span></span><span style=display:flex><span>          message.error(e || <span style=color:#0ff;font-weight:700>&#39;æäº¤å¤±è´¥ï¼Œè¯·é‡è¯•&#39;</span>);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  render() {
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> { id, imgList } = <span style=color:#fff;font-weight:700>this</span>.state;
</span></span><span style=display:flex><span>    console.log(<span style=color:#0ff;font-weight:700>&#39;smyhvae render imgList:&#39;</span> + JSON.stringify(imgList));
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> { getFieldDecorator } = <span style=color:#fff;font-weight:700>this</span>.props.form;
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> formItemLayout = {
</span></span><span style=display:flex><span>      labelCol: { span: <span style=color:#ff0;font-weight:700>3</span> },
</span></span><span style=display:flex><span>      wrapperCol: { span: <span style=color:#ff0;font-weight:700>10</span> },
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> buttonItemLayout = {
</span></span><span style=display:flex><span>      wrapperCol: { span: <span style=color:#ff0;font-weight:700>10</span>, offset: <span style=color:#ff0;font-weight:700>3</span> },
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>const</span> uploadButton = (
</span></span><span style=display:flex><span>      &lt;div&gt;
</span></span><span style=display:flex><span>        &lt;Icon type=<span style=color:#0ff;font-weight:700>&#34;plus&#34;</span> /&gt;
</span></span><span style=display:flex><span>        &lt;div className=<span style=color:#0ff;font-weight:700>&#34;ant-upload-text&#34;</span>&gt;Upload&lt;<span style=color:red>/div&gt;</span>
</span></span><span style=display:flex><span>      &lt;<span style=color:red>/div&gt;</span>
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>return</span> (
</span></span><span style=display:flex><span>      &lt;Card title={id ? <span style=color:#0ff;font-weight:700>&#39;ä¿®æ”¹ä¿¡æ¯&#39;</span> : <span style=color:#0ff;font-weight:700>&#39;æ–°å¢ä¿¡æ¯&#39;</span>}&gt;
</span></span><span style=display:flex><span>        &lt;Form onSubmit={<span style=color:#fff;font-weight:700>this</span>.submit} layout=<span style=color:#0ff;font-weight:700>&#34;horizontal&#34;</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          {<span style=color:#007f7f>/* æ–°å»ºå›¾ç‰‡ã€ç¼–è¾‘å›¾ç‰‡ */</span>}
</span></span><span style=display:flex><span>          &lt;FormItem label=<span style=color:#0ff;font-weight:700>&#34;å›¾ç‰‡&#34;</span> {...formItemLayout}&gt;
</span></span><span style=display:flex><span>            {getFieldDecorator(<span style=color:#0ff;font-weight:700>&#39;img&#39;</span>, {
</span></span><span style=display:flex><span>              rules: [{ required: <span style=color:#fff;font-weight:700>false</span>, message: <span style=color:#0ff;font-weight:700>&#39;è¯·ä¸Šä¼ å›¾ç‰‡&#39;</span> }],
</span></span><span style=display:flex><span>            })(
</span></span><span style=display:flex><span>              &lt;Upload
</span></span><span style=display:flex><span>                action=<span style=color:#0ff;font-weight:700>&#34;2&#34;</span>
</span></span><span style=display:flex><span>                customRequest={<span style=color:#fff;font-weight:700>this</span>.doImgUpload}
</span></span><span style=display:flex><span>                listType=<span style=color:#0ff;font-weight:700>&#34;picture-card&#34;</span>
</span></span><span style=display:flex><span>                fileList={imgList}
</span></span><span style=display:flex><span>                onPreview={<span style=color:#fff;font-weight:700>this</span>.handlePreview}
</span></span><span style=display:flex><span>                beforeUpload={<span style=color:#fff;font-weight:700>this</span>.handleBeforeUpload}
</span></span><span style=display:flex><span>                onChange={<span style=color:#fff;font-weight:700>this</span>.handleChange}
</span></span><span style=display:flex><span>              &gt;
</span></span><span style=display:flex><span>                {imgList.length &gt;= <span style=color:#ff0;font-weight:700>1</span> ? <span style=color:#fff;font-weight:700>null</span> : uploadButton}
</span></span><span style=display:flex><span>              &lt;<span style=color:red>/Upload&gt;</span>
</span></span><span style=display:flex><span>            )}
</span></span><span style=display:flex><span>          &lt;<span style=color:red>/FormItem&gt;</span>
</span></span><span style=display:flex><span>          &lt;Row&gt;
</span></span><span style=display:flex><span>            &lt;Col span={<span style=color:#ff0;font-weight:700>3</span>} /&gt;
</span></span><span style=display:flex><span>            &lt;Col span={<span style=color:#ff0;font-weight:700>18</span>} className={styles.graytext}&gt;
</span></span><span style=display:flex><span>              æ³¨<span style=color:red>ï¼š</span>å›¾ç‰‡æ”¯æŒJPG<span style=color:red>ã€</span>JPEG<span style=color:red>ã€</span>PNGæ ¼å¼<span style=color:red>ï¼Œ</span>å°äº1M<span style=color:red>ï¼Œ</span>æœ€å¤šä¸Šä¼ 1å¼ 
</span></span><span style=display:flex><span>            &lt;<span style=color:red>/Col&gt;</span>
</span></span><span style=display:flex><span>          &lt;<span style=color:red>/Row&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          &lt;FormItem {...buttonItemLayout}&gt;
</span></span><span style=display:flex><span>            &lt;Button type=<span style=color:#0ff;font-weight:700>&#34;primary&#34;</span> htmlType=<span style=color:#0ff;font-weight:700>&#34;submit&#34;</span>&gt;
</span></span><span style=display:flex><span>              æäº¤
</span></span><span style=display:flex><span>            &lt;<span style=color:red>/Button&gt;</span>
</span></span><span style=display:flex><span>          &lt;<span style=color:red>/FormItem&gt;</span>
</span></span><span style=display:flex><span>        &lt;<span style=color:red>/Form&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        {<span style=color:#007f7f>/* å›¾ç‰‡ç‚¹å¼€é¢„è§ˆ */</span>}
</span></span><span style=display:flex><span>        &lt;Modal visible={<span style=color:#fff;font-weight:700>this</span>.state.previewVisible} footer={<span style=color:#fff;font-weight:700>null</span>} onCancel={<span style=color:#fff;font-weight:700>this</span>.handleCancel}&gt;
</span></span><span style=display:flex><span>          &lt;img alt=<span style=color:#0ff;font-weight:700>&#34;example&#34;</span> style={{ width: <span style=color:#0ff;font-weight:700>&#39;100%&#39;</span> }} src={<span style=color:#fff;font-weight:700>this</span>.state.previewImage} /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:red>/Modal&gt;</span>
</span></span><span style=display:flex><span>      &lt;<span style=color:red>/Card&gt;</span>
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=å‚è€ƒé“¾æ¥>å‚è€ƒé“¾æ¥<a hidden class=anchor aria-hidden=true href=#å‚è€ƒé“¾æ¥>#</a></h2><p>æ³¨æ„fileçš„æ ¼å¼ï¼šhttps://www.lmonkey.com/t/oREQA5XE1</p><p>Demoåœ¨çº¿æ¼”ç¤ºï¼š</p><ul><li><p><a href=https://stackoverflow.com/questions/58128062/using-customrequest-in-ant-design-file-upload>https://stackoverflow.com/questions/58128062/using-customrequest-in-ant-design-file-upload</a></p></li><li><p><a href=https://stackblitz.com/edit/so-58128062-upload-progress>https://stackblitz.com/edit/so-58128062-upload-progress</a></p></li></ul><p>fileList æ ¼å¼åœ¨çº¿æ¼”ç¤ºï¼š</p><ul><li><p><a href=https://stackoverflow.com/questions/51514757/action-function-is-required-with-antd-upload-control-but-i-dont-need-it>https://stackoverflow.com/questions/51514757/action-function-is-required-with-antd-upload-control-but-i-dont-need-it</a></p></li><li><p><a href=https://codesandbox.io/s/rl7ooo544q>https://codesandbox.io/s/rl7ooo544q</a></p></li></ul><p>ant design Uploadç»„ä»¶çš„ä½¿ç”¨æ€»ç»“ï¼šhttps://www.jianshu.com/p/0aa4612af987</p><p>antdä¸Šä¼ åŠŸèƒ½çš„CustomRequestï¼šhttps://mlog.club/article/3832743</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bablvsj.github.io/tags/%E5%BC%80%E5%8F%91%E8%BD%AF%E4%BB%B6%E5%BF%AB%E6%8D%B7%E4%BD%BF%E7%94%A8/>å¼€å‘è½¯ä»¶å¿«æ·ä½¿ç”¨</a></li></ul><nav class=paginav><a class=prev href=https://bablvsj.github.io/posts/temp/04-javascript/09-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5%E9%80%89%E6%8B%A9%E7%BB%93%E6%9E%84if%E5%92%8Cswitch/><span class=title>Â« Prev</span><br><span>09-æµç¨‹æ§åˆ¶è¯­å¥ï¼šé€‰æ‹©ç»“æ„ï¼ˆifå’Œswitchï¼‰</span></a>
<a class=next href=https://bablvsj.github.io/posts/temp/04-javascript/10-promise%E5%85%A5%E9%97%A8%E8%AF%A6%E8%A7%A3/><span class=title>Next Â»</span><br><span>10-Promiseå…¥é—¨è¯¦è§£</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://bablvsj.github.io>Bablvsj's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div class=flex-c-d><a class=flex-d-c href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target=_blank><span>æœ¬ç«™ç”±</span><img width=60 src=/images/upyun.png>æä¾›CDNåŠ é€Ÿ/äº‘å­˜å‚¨æœåŠ¡</a></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>