<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>13 Three.jsåŸºç¡€ä¹‹é˜´å½± | Bablvsj's Blog</title><meta name=keywords content="Three.js"><meta name=description content="13 Three.jsåŸºç¡€ä¹‹é˜´å½± - Bablvsj's Blog"><meta name=author content><link rel=canonical href=https://bablvsj.github.io/posts/threejs/13-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%98%B4%E5%BD%B1/><link crossorigin=anonymous href=/assets/css/stylesheet.b33b75c69bb2ec0d4accfeaad1d3ba05b272f180583f687c640a522d6492076f.css integrity="sha256-szt1xpuy7A1KzP6q0dO6BbJy8YBYP2h8ZApSLWSSB28=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://bablvsj.github.io/img/Q.gif><link rel=apple-touch-icon href=https://bablvsj.github.io/Q.gif><link rel=mask-icon href=https://bablvsj.github.io/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=/css/syntax.css><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="13 Three.jsåŸºç¡€ä¹‹é˜´å½±"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://bablvsj.github.io/posts/threejs/13-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%98%B4%E5%BD%B1/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-19T17:11:35+08:00"><meta property="article:modified_time" content="2023-12-19T17:11:35+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="13 Three.jsåŸºç¡€ä¹‹é˜´å½±"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"æ–‡ç« ","item":"https://bablvsj.github.io/posts/"},{"@type":"ListItem","position":3,"name":"13 Three.jsåŸºç¡€ä¹‹é˜´å½±","item":"https://bablvsj.github.io/posts/threejs/13-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%98%B4%E5%BD%B1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"13 Three.jsåŸºç¡€ä¹‹é˜´å½±","name":"13 Three.jsåŸºç¡€ä¹‹é˜´å½±","description":"","keywords":["Three.js"],"articleBody":"é˜´å½±(Shadow)æ¦‚è¿° LightShadow åœ¨ Three.js ä¸­ï¼Œæ‰€æœ‰é˜´å½±çš„åŸºç±»éƒ½æ˜¯ Three.LightShadowã€‚\nè¯·æ³¨æ„ï¼šä¸èƒ½ç›´æ¥å»å®ä¾‹åŒ– LightShadowï¼Œå¹³æ—¶çœŸæ­£å»åˆ›å»ºçš„é˜´å½±ï¼Œéƒ½æ˜¯è¯¥ç±»çš„ä¹‹ç±»ã€‚\né˜´å½±ç±»å‹ ç›®å‰ï¼Œä¸€å…±æœ‰ 3 ç§é˜´å½±ï¼Œé€šè¿‡åå­—åŸºæœ¬éƒ½å¯ä»¥çŒœå‡ºå¯¹åº”çš„ç¯å…‰çš„ç±»å‹ã€‚\né˜´å½±ç±»å‹(éƒ½ç»§æ‰¿äºLightShadow) é˜´å½±åç§° è§£é‡Šè¯´æ˜ PointLightShadow ç‚¹å…‰æºé˜´å½± å¯¹åº” PointLight å…‰æº DirectionalLightShadow å¹³è¡Œå…‰é˜´å½± å¯¹åº” DirectionalLight å…‰æº SpotLightShadow èšå…‰ç¯é˜´å½± å¯¹åº” SpootLight å…‰æº æ³¨æ„ï¼šDirectionalLightShadowåªèƒ½ä½¿ç”¨ OrthographicCamera é•œå¤´æ¥è®¡ç®—é˜´å½±ï¼Œæ— æ³•åœ¨ PerspectiveCamera é•œå¤´ä¸‹ä½¿ç”¨ã€‚\nè¿™æ˜¯å› ä¸º PerspectiveCamera çš„å…‰çº¿æ˜¯å¹³è¡Œçš„ã€‚\nç‰¹åˆ«å¼ºè°ƒï¼šä½ æ— éœ€åˆ›å»ºé˜´å½±å®ä¾‹ï¼Œé˜´å½±å®ä¾‹æ˜¯ç”± ç¯å…‰ å†…éƒ¨åˆ›å»ºçš„ é˜´å½±è´´å›¾ é»˜è®¤æƒ…å†µä¸‹ Three.js ä½¿ç”¨é˜´å½±è´´å›¾æ¥ç»˜åˆ¶é˜´å½±ã€‚\nä½•ä¸º â€œé˜´å½±è´´å›¾â€ ï¼Ÿ\nç­”ï¼šæ‰€è°“ â€è´´å›¾â€œï¼Œä½ å¯ä»¥æƒ³è±¡æˆ â€ä¸€å±‚å±‚çª—æˆ·çº¸â€œã€‚\nå‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªçª—æˆ·ï¼Œä½ å¯ä»¥ä¸€å±‚ä¸€å±‚çš„ç²˜è´´ä¸åŒé€æ˜åº¦çš„çª—æˆ·çº¸ï¼Œæ¯ä¸€å±‚çª—æˆ·çº¸éƒ½ä¼šå åŠ åˆ°ä¹‹å‰çš„é‚£ä¸€å±‚ï¼Œæœ€ç»ˆçª—æˆ·çº¸æ‰€å‘ˆç°çš„æ•ˆæœæ˜¯æ‰€æœ‰çª—æˆ·çº¸æœ€ç»ˆåˆå¹¶åä¸€å—å‘ˆç°çš„æ•ˆæœã€‚\nå½“ç„¶ï¼Œç”±äºé˜´å½±éƒ½æ˜¯é»‘ç°è‰²ï¼Œä¸å­˜åœ¨å½©è‰²ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä¸¾ä¾‹ä¸­ï¼Œçª—æˆ·çº¸éƒ½æ˜¯ä¸åŒé€æ˜åº¦(æ˜æš—åº¦)çš„ï¼Œä¸éœ€è¦è€ƒè™‘çª—æˆ·çº¸çš„é¢œè‰²ã€‚\né˜´å½±çš„å®é™…æ¸²æŸ“è¿‡ç¨‹ï¼š\nå‡è®¾ç›®å‰åœºæ™¯ä¸‹ï¼Œæœ‰ 5 ä¸ªå¯äº§ç”Ÿé˜´å½±çš„ç¯å…‰ã€20 ä¸ªé˜´å½±å¯¹è±¡ã€‚\né‚£ä¹ˆæœ€ç»ˆæ¸²æŸ“å‡ºçš„é˜´å½±ï¼Œæ‰€ç»å†çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š\nä½¿ç”¨ ç¬¬1ä¸ªç¯å…‰ æ¸²æŸ“å‡ºä¸€ä»½ 20 ä¸ªé˜´å½±å¯¹è±¡ ä½¿ç”¨ ç¬¬2ä¸ªç¯å…‰ æ¸²æŸ“å‡ºä¸€ä»½ 20 ä¸ªé˜´å½±å¯¹è±¡ â€¦ ä½¿ç”¨ ç¬¬5ä¸ªç¯å…‰ æ¸²æŸ“å‡ºä¸€ä»½ 20 ä¸ªé˜´å½±å¯¹è±¡ æœ€ç»ˆå°† 5 æ¬¡æ¸²æŸ“çš„é˜´å½±ç»“æœè¿›è¡Œåˆå¹¶ï¼Œå¾—å‡ºæœ€ç»ˆçš„é˜´å½± ä»ä¸Šè¿°æ¸²æŸ“è¿‡ç¨‹å¯ä»¥çœ‹å‡ºï¼Œæ¯å¤šä¸€ä¸ªå¯äº§ç”Ÿé˜´å½±çš„å…‰æºã€é˜´å½±å¯¹è±¡ï¼Œåˆ™éœ€è¦å¤šæ¸²æŸ“ä¸€æ¬¡åœºæ™¯ã€‚\nç”±æ­¤å¯è§ï¼Œé˜´å½±çš„æ¸²æŸ“éœ€è¦å¤§é‡çš„è®¡ç®—å’Œæ€§èƒ½ã€‚\né™ä½é˜´å½±æ‰€éœ€æ€§èƒ½çš„è§£å†³åŠæ³• æ–¹æ¡ˆ1ï¼šå¯ä»¥æœ‰å¤šä¸ªç¯å…‰ï¼Œä½†åªæœ‰ä¸€ä¸ªå¹³è¡Œå…‰å¯äº§ç”Ÿé˜´å½±\næ–¹æ¡ˆ2ï¼šä½¿ç”¨ å…‰ç…§è´´å›¾ æˆ– ç¯å¢ƒå…‰ç…§é®æŒ¡è´´å›¾ æ¥é¢„å…ˆè®¡ç®—ç¦»çº¿ç…§æ˜çš„æ•ˆæœ\næ–¹æ¡ˆ3ï¼šä½¿ç”¨ å‡é˜´å½±ï¼Œæ·»åŠ ä¸€ä¸ªå¹³é¢æ”¾åˆ°ç‰©ä½“ä¸‹æ–¹çš„åœ°é¢ä¸Šï¼ŒåŒæ—¶èµ‹äºˆä¸€ä¸ªçœ‹ç€åƒé˜´å½±çš„çº¹ç†å›¾ç‰‡æè´¨\næ–¹æ¡ˆ1ã€æ–¹æ¡ˆ2 æˆ‘ä»¬ä¼šåœ¨ä»¥åå†è¯¦ç»†è®²è¿°å­¦ä¹ ï¼Œæœ¬æ–‡å…ˆå®ç°ä¸€ä¸‹æ–¹æ¡ˆ3ã€‚\nè¡¥å……è¯´æ˜ï¼š\nå¯¹äºç»å¤§å¤šæ•° æ¸¸æˆåœºæ™¯ æ¥è¯´ï¼Œäººç‰©è„šä¸‹çš„é˜´å½±éƒ½æ˜¯é‡‡ç”¨ æ–¹æ¡ˆ3 çš„ç­–ç•¥ï¼Œä¸€èˆ¬äººä»¬æ˜¯å¯ä»¥æ¥å—è¿™ç§å‡é˜´å½±ã€‚\nè¿™ç§å‡é˜´å½±å¯¹æ¸²æŸ“æ€§èƒ½çš„æå‡éå¸¸å¤§ã€‚\nå‡é˜´å½±ç¤ºä¾‹ï¼šHelloFakeShadow ç¤ºä¾‹ç›®æ ‡ ä¸€ä¸ªç±»ä¼¼é»‘ç™½æ£‹ç›˜ä¸€æ ·çš„åœ°é¢(ä¹‹å‰ç¤ºä¾‹å·²ç»ä½¿ç”¨å¤šæ¬¡)\nåœ¨è¿™ä¸ªå¹³å°ä¸Šé¢æœ‰ 15 ä¸ªè·³åŠ¨çš„å°çƒ\næ¯ä¸ªå°çƒé¢œè‰²å‡ä¸åŒ\næ¯ä¸ªå°çƒåœ¨ä¸€å®šèŒƒå›´å†…å¾ªç¯ã€ä¸”æœ‰è§„å¾‹çš„è·³åŠ¨\næ¯ä¸ªå°çƒéƒ½æœ‰è‡ªå·±çš„åœ¨åœ°é¢ä¸Šçš„é˜´å½±\næ³¨æ„è¿™ä¸ªé˜´å½±æ˜¯å‡çš„é˜´å½±ï¼Œå¹¶ä¸æ˜¯å…‰ç…§äº§ç”Ÿçš„ï¼Œè€Œæ˜¯æˆ‘ä»¬æ¨¡æ‹Ÿå‡ºæ¥çš„\nå°çƒé˜´å½±éšç€å°çƒè·³åŠ¨è€Œåšå‡ºå¯¹åº”çš„ä½ç½®ã€æµ“åº¦(æ˜æš—)å˜åŒ–\nä»£ç æ€è·¯ 1ã€å¦‚ä½•åˆ›å»ºåœ°é¢ï¼Ÿ\nç­”ï¼šæˆ‘ä»¬ä¹‹å‰ç¤ºä¾‹å·²ç»æ¼”ç¤ºè¿‡ï¼Œç»§ç»­ä½¿ç”¨ é»‘ç™½çº¹ç†å›¾ç‰‡ äº§ç”Ÿåœ°é¢ï¼Œä¸å†å¤šè¨€ã€‚\n2ã€å¦‚ä½•åˆ›å»º 15 ä¸ªé¢œè‰²ä¸åŒçš„å°çƒï¼Ÿ\nç­”ï¼šå¯ä»¥é€šè¿‡ for å¾ªç¯æ¥åˆ›å»º 15 ä¸ªå°çƒï¼Œåœ¨æ¯ä¸€æ¬¡ for å¾ªç¯ä¸­ï¼Œè®¾ç½®ä¸åŒçš„å°çƒæè´¨é¢œè‰²ã€‚\nå¤§ä½“ä»£ç å¦‚ä¸‹ï¼š\nconst numSphere = 15 for(let i = 0; i","wordCount":"6511","inLanguage":"en","datePublished":"2023-12-19T17:11:35+08:00","dateModified":"2023-12-19T17:11:35+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://bablvsj.github.io/posts/threejs/13-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%98%B4%E5%BD%B1/"},"publisher":{"@type":"Organization","name":"Bablvsj's Blog","logo":{"@type":"ImageObject","url":"https://bablvsj.github.io/img/Q.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bablvsj.github.io accesskey=h title="Bablvsj's Blog (Alt + H)">Bablvsj's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bablvsj.github.io/ title=ä¸»é¡µ><span>ä¸»é¡µ</span></a></li><li><a href=https://bablvsj.github.io/archives/ title=æ—¶é—´è½´><span>æ—¶é—´è½´</span></a></li><li><a href=https://bablvsj.github.io/tags title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://bablvsj.github.io/about title=å…³äº><span>å…³äº</span></a></li><li><a href=https://bablvsj.github.io/search title="ğŸ” (Alt + /)" accesskey=/><span>ğŸ”</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>13 Three.jsåŸºç¡€ä¹‹é˜´å½±</h1><div class=post-meta><div class=post-tags-meta><a href=https://bablvsj.github.io/tags/three.js/>Three.js</a></div>13 min&nbsp;Â·&nbsp;<span title='2023-12-19 17:11:35 +0800 +0800'>2023/12/19</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><div class=inner><ul><li><a href=#%e9%98%b4%e5%bd%b1shadow%e6%a6%82%e8%bf%b0 aria-label=é˜´å½±(Shadow)æ¦‚è¿°>é˜´å½±(Shadow)æ¦‚è¿°</a><ul><ul><li><a href=#lightshadow aria-label=LightShadow>LightShadow</a></li><li><a href=#%e9%98%b4%e5%bd%b1%e7%b1%bb%e5%9e%8b aria-label=é˜´å½±ç±»å‹>é˜´å½±ç±»å‹</a></li><li><a href=#%e7%89%b9%e5%88%ab%e5%bc%ba%e8%b0%83%e4%bd%a0%e6%97%a0%e9%9c%80%e5%88%9b%e5%bb%ba%e9%98%b4%e5%bd%b1%e5%ae%9e%e4%be%8b%e9%98%b4%e5%bd%b1%e5%ae%9e%e4%be%8b%e6%98%af%e7%94%b1-%e7%81%af%e5%85%89-%e5%86%85%e9%83%a8%e5%88%9b%e5%bb%ba%e7%9a%84 aria-label="ç‰¹åˆ«å¼ºè°ƒï¼šä½ æ— éœ€åˆ›å»ºé˜´å½±å®ä¾‹ï¼Œé˜´å½±å®ä¾‹æ˜¯ç”± ç¯å…‰ å†…éƒ¨åˆ›å»ºçš„">ç‰¹åˆ«å¼ºè°ƒï¼šä½ æ— éœ€åˆ›å»ºé˜´å½±å®ä¾‹ï¼Œé˜´å½±å®ä¾‹æ˜¯ç”± ç¯å…‰ å†…éƒ¨åˆ›å»ºçš„</a></li><li><a href=#%e9%98%b4%e5%bd%b1%e8%b4%b4%e5%9b%be aria-label=é˜´å½±è´´å›¾>é˜´å½±è´´å›¾</a></li><li><a href=#%e9%99%8d%e4%bd%8e%e9%98%b4%e5%bd%b1%e6%89%80%e9%9c%80%e6%80%a7%e8%83%bd%e7%9a%84%e8%a7%a3%e5%86%b3%e5%8a%9e%e6%b3%95 aria-label=é™ä½é˜´å½±æ‰€éœ€æ€§èƒ½çš„è§£å†³åŠæ³•>é™ä½é˜´å½±æ‰€éœ€æ€§èƒ½çš„è§£å†³åŠæ³•</a></li></ul></ul></li><li><a href=#%e5%81%87%e9%98%b4%e5%bd%b1%e7%a4%ba%e4%be%8bhellofakeshadow aria-label=å‡é˜´å½±ç¤ºä¾‹ï¼šHelloFakeShadow>å‡é˜´å½±ç¤ºä¾‹ï¼šHelloFakeShadow</a><ul><ul><li><a href=#%e7%a4%ba%e4%be%8b%e7%9b%ae%e6%a0%87 aria-label=ç¤ºä¾‹ç›®æ ‡>ç¤ºä¾‹ç›®æ ‡</a></li><li><a href=#%e4%bb%a3%e7%a0%81%e6%80%9d%e8%b7%af aria-label=ä»£ç æ€è·¯>ä»£ç æ€è·¯</a></li><li><a href=#%e7%a4%ba%e4%be%8b%e4%bb%a3%e7%a0%81 aria-label=ç¤ºä¾‹ä»£ç >ç¤ºä¾‹ä»£ç </a></li></ul></ul></li><li><a href=#%e5%b9%b3%e8%a1%8c%e5%85%89%e9%98%b4%e5%bd%b1directionallightshadow%e7%a4%ba%e4%be%8bhelloshadow aria-label=å¹³è¡Œå…‰é˜´å½±(DirectionalLightShadow)ç¤ºä¾‹ï¼šHelloShadow>å¹³è¡Œå…‰é˜´å½±(DirectionalLightShadow)ç¤ºä¾‹ï¼šHelloShadow</a><ul><ul><li><a href=#%e7%a4%ba%e4%be%8b%e7%9b%ae%e6%a0%87-1 aria-label=ç¤ºä¾‹ç›®æ ‡>ç¤ºä¾‹ç›®æ ‡</a></li><li><a href=#%e4%bb%a3%e7%a0%81%e6%80%9d%e8%b7%af-1 aria-label=ä»£ç æ€è·¯>ä»£ç æ€è·¯</a></li><li><a href=#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9 aria-label=æ³¨æ„äº‹é¡¹>æ³¨æ„äº‹é¡¹</a></li><li><a href=#%e7%a4%ba%e4%be%8b%e4%bb%a3%e7%a0%81-1 aria-label=ç¤ºä¾‹ä»£ç >ç¤ºä¾‹ä»£ç </a></li><li><a href=#%e5%9b%9e%e9%a1%be%e4%b9%8b%e5%89%8d%e6%8f%90%e5%87%ba%e7%9a%84%e9%97%ae%e9%a2%98%e4%b8%ba%e4%bb%80%e4%b9%88%e9%98%b4%e5%bd%b1%e9%95%9c%e5%a4%b4%e7%9a%84%e8%a7%86%e6%a4%8e%e6%97%a2%e8%a6%81%e8%a6%86%e7%9b%96%e7%89%a9%e4%bd%93%e5%8f%88%e8%a6%81%e8%8c%83%e5%9b%b4%e5%90%88%e9%80%82%e4%b8%8d%e8%a6%81%e8%bf%87%e5%a4%a7 aria-label=å›é¡¾ä¹‹å‰æå‡ºçš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆé˜´å½±é•œå¤´çš„è§†æ¤æ—¢è¦è¦†ç›–ç‰©ä½“ï¼Œåˆè¦èŒƒå›´åˆé€‚ï¼Œä¸è¦è¿‡å¤§ï¼Ÿ>å›é¡¾ä¹‹å‰æå‡ºçš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆé˜´å½±é•œå¤´çš„è§†æ¤æ—¢è¦è¦†ç›–ç‰©ä½“ï¼Œåˆè¦èŒƒå›´åˆé€‚ï¼Œä¸è¦è¿‡å¤§ï¼Ÿ</a></li><li><a href=#%e5%a6%82%e4%bd%95%e8%ae%a9%e5%bd%b1%e5%ad%90%e4%b8%8d%e9%82%a3%e4%b9%88%e9%bb%91%e6%98%be%e7%a4%ba%e5%be%97%e6%af%94%e8%be%83%e6%b7%a1%e4%b8%80%e4%ba%9b aria-label=å¦‚ä½•è®©å½±å­ä¸é‚£ä¹ˆé»‘ï¼Œæ˜¾ç¤ºå¾—æ¯”è¾ƒæ·¡ä¸€äº›ï¼Ÿ>å¦‚ä½•è®©å½±å­ä¸é‚£ä¹ˆé»‘ï¼Œæ˜¾ç¤ºå¾—æ¯”è¾ƒæ·¡ä¸€äº›ï¼Ÿ</a></li></ul></ul></li><li><a href=#%e8%81%9a%e5%85%89%e7%81%af%e9%98%b4%e5%bd%b1spotlightshadow%e7%a4%ba%e4%be%8b aria-label=èšå…‰ç¯é˜´å½±(SpotLightShadow)ç¤ºä¾‹>èšå…‰ç¯é˜´å½±(SpotLightShadow)ç¤ºä¾‹</a></li><li><a href=#%e7%82%b9%e5%85%89%e6%ba%90%e9%98%b4%e5%bd%b1pointlightshadow%e7%a4%ba%e4%be%8b aria-label=ç‚¹å…‰æºé˜´å½±(PointLightShadow)ç¤ºä¾‹>ç‚¹å…‰æºé˜´å½±(PointLightShadow)ç¤ºä¾‹</a><ul><ul><li><a href=#%e7%82%b9%e5%85%89%e6%ba%90pointlight%e7%9a%84%e7%89%b9%e6%ae%8a%e4%b9%8b%e5%a4%84 aria-label=ç‚¹å…‰æº(PointLight)çš„ç‰¹æ®Šä¹‹å¤„>ç‚¹å…‰æº(PointLight)çš„ç‰¹æ®Šä¹‹å¤„</a></li><li><a href=#%e7%a4%ba%e4%be%8b%e7%9a%84%e7%89%b9%e6%ae%8a%e6%94%b9%e5%8a%a8%e4%b9%8b%e5%a4%84 aria-label=ç¤ºä¾‹çš„ç‰¹æ®Šæ”¹åŠ¨ä¹‹å¤„>ç¤ºä¾‹çš„ç‰¹æ®Šæ”¹åŠ¨ä¹‹å¤„</a></li><li><a href=#%e8%a1%a5%e5%85%85%e8%af%b4%e6%98%8e aria-label=è¡¥å……è¯´æ˜>è¡¥å……è¯´æ˜</a></li><li><a href=#%e5%85%b7%e4%bd%93%e7%9a%84%e4%bb%a3%e7%a0%81 aria-label=å…·ä½“çš„ä»£ç >å…·ä½“çš„ä»£ç </a></li><li><a href=#%e6%b3%a8%e6%84%8f%e4%b8%ba%e4%bb%80%e4%b9%88%e7%89%a9%e4%bd%93%e4%b8%8b%e6%96%b9%e6%98%be%e7%a4%ba%e7%9a%84%e9%98%b4%e5%bd%b1-%e6%98%af%e5%9c%a8%e5%9c%b0%e9%9d%a2planemesh%e8%80%8c%e4%b8%8d%e6%98%af-roommesh-%e7%9a%84%e5%ba%95%e9%9d%a2 aria-label="æ³¨æ„ï¼šä¸ºä»€ä¹ˆç‰©ä½“ä¸‹æ–¹æ˜¾ç¤ºçš„é˜´å½± æ˜¯åœ¨åœ°é¢(planeMesh)è€Œä¸æ˜¯ roomMesh çš„åº•é¢ï¼Ÿ">æ³¨æ„ï¼šä¸ºä»€ä¹ˆç‰©ä½“ä¸‹æ–¹æ˜¾ç¤ºçš„é˜´å½± æ˜¯åœ¨åœ°é¢(planeMesh)è€Œä¸æ˜¯ roomMesh çš„åº•é¢ï¼Ÿ</a></li></ul></ul></li></ul></div></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=é˜´å½±shadowæ¦‚è¿°>é˜´å½±(Shadow)æ¦‚è¿°<a hidden class=anchor aria-hidden=true href=#é˜´å½±shadowæ¦‚è¿°>#</a></h2><h4 id=lightshadow>LightShadow<a hidden class=anchor aria-hidden=true href=#lightshadow>#</a></h4><p>åœ¨ Three.js ä¸­ï¼Œæ‰€æœ‰é˜´å½±çš„åŸºç±»éƒ½æ˜¯ Three.LightShadowã€‚</p><p>è¯·æ³¨æ„ï¼šä¸èƒ½ç›´æ¥å»å®ä¾‹åŒ– LightShadowï¼Œå¹³æ—¶çœŸæ­£å»åˆ›å»ºçš„é˜´å½±ï¼Œéƒ½æ˜¯è¯¥ç±»çš„ä¹‹ç±»ã€‚</p><h4 id=é˜´å½±ç±»å‹>é˜´å½±ç±»å‹<a hidden class=anchor aria-hidden=true href=#é˜´å½±ç±»å‹>#</a></h4><p>ç›®å‰ï¼Œä¸€å…±æœ‰ 3 ç§é˜´å½±ï¼Œé€šè¿‡åå­—åŸºæœ¬éƒ½å¯ä»¥çŒœå‡ºå¯¹åº”çš„ç¯å…‰çš„ç±»å‹ã€‚</p><table><thead><tr><th>é˜´å½±ç±»å‹(éƒ½ç»§æ‰¿äºLightShadow)</th><th>é˜´å½±åç§°</th><th>è§£é‡Šè¯´æ˜</th></tr></thead><tbody><tr><td>PointLightShadow</td><td>ç‚¹å…‰æºé˜´å½±</td><td>å¯¹åº” PointLight å…‰æº</td></tr><tr><td>DirectionalLightShadow</td><td>å¹³è¡Œå…‰é˜´å½±</td><td>å¯¹åº” DirectionalLight å…‰æº</td></tr><tr><td>SpotLightShadow</td><td>èšå…‰ç¯é˜´å½±</td><td>å¯¹åº” SpootLight å…‰æº</td></tr></tbody></table><p><strong>æ³¨æ„ï¼šDirectionalLightShadowåªèƒ½ä½¿ç”¨ OrthographicCamera é•œå¤´æ¥è®¡ç®—é˜´å½±ï¼Œæ— æ³•åœ¨ PerspectiveCamera é•œå¤´ä¸‹ä½¿ç”¨ã€‚</strong></p><blockquote><p>è¿™æ˜¯å› ä¸º PerspectiveCamera çš„å…‰çº¿æ˜¯å¹³è¡Œçš„ã€‚</p></blockquote><h4 id=ç‰¹åˆ«å¼ºè°ƒä½ æ— éœ€åˆ›å»ºé˜´å½±å®ä¾‹é˜´å½±å®ä¾‹æ˜¯ç”±-ç¯å…‰-å†…éƒ¨åˆ›å»ºçš„>ç‰¹åˆ«å¼ºè°ƒï¼šä½ æ— éœ€åˆ›å»ºé˜´å½±å®ä¾‹ï¼Œé˜´å½±å®ä¾‹æ˜¯ç”± ç¯å…‰ å†…éƒ¨åˆ›å»ºçš„<a hidden class=anchor aria-hidden=true href=#ç‰¹åˆ«å¼ºè°ƒä½ æ— éœ€åˆ›å»ºé˜´å½±å®ä¾‹é˜´å½±å®ä¾‹æ˜¯ç”±-ç¯å…‰-å†…éƒ¨åˆ›å»ºçš„>#</a></h4><h4 id=é˜´å½±è´´å›¾>é˜´å½±è´´å›¾<a hidden class=anchor aria-hidden=true href=#é˜´å½±è´´å›¾>#</a></h4><p>é»˜è®¤æƒ…å†µä¸‹ Three.js ä½¿ç”¨é˜´å½±è´´å›¾æ¥ç»˜åˆ¶é˜´å½±ã€‚</p><p><strong>ä½•ä¸º â€œé˜´å½±è´´å›¾â€ ï¼Ÿ</strong></p><p>ç­”ï¼šæ‰€è°“ â€è´´å›¾â€œï¼Œä½ å¯ä»¥æƒ³è±¡æˆ â€ä¸€å±‚å±‚çª—æˆ·çº¸â€œã€‚</p><p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªçª—æˆ·ï¼Œä½ å¯ä»¥ä¸€å±‚ä¸€å±‚çš„ç²˜è´´ä¸åŒé€æ˜åº¦çš„çª—æˆ·çº¸ï¼Œæ¯ä¸€å±‚çª—æˆ·çº¸éƒ½ä¼šå åŠ åˆ°ä¹‹å‰çš„é‚£ä¸€å±‚ï¼Œæœ€ç»ˆçª—æˆ·çº¸æ‰€å‘ˆç°çš„æ•ˆæœæ˜¯æ‰€æœ‰çª—æˆ·çº¸æœ€ç»ˆåˆå¹¶åä¸€å—å‘ˆç°çš„æ•ˆæœã€‚</p><p>å½“ç„¶ï¼Œç”±äºé˜´å½±éƒ½æ˜¯é»‘ç°è‰²ï¼Œä¸å­˜åœ¨å½©è‰²ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä¸¾ä¾‹ä¸­ï¼Œçª—æˆ·çº¸éƒ½æ˜¯ä¸åŒé€æ˜åº¦(æ˜æš—åº¦)çš„ï¼Œä¸éœ€è¦è€ƒè™‘çª—æˆ·çº¸çš„é¢œè‰²ã€‚</p><p><strong>é˜´å½±çš„å®é™…æ¸²æŸ“è¿‡ç¨‹ï¼š</strong></p><p>å‡è®¾ç›®å‰åœºæ™¯ä¸‹ï¼Œæœ‰ 5 ä¸ªå¯äº§ç”Ÿé˜´å½±çš„ç¯å…‰ã€20 ä¸ªé˜´å½±å¯¹è±¡ã€‚</p><p>é‚£ä¹ˆæœ€ç»ˆæ¸²æŸ“å‡ºçš„é˜´å½±ï¼Œæ‰€ç»å†çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li>ä½¿ç”¨ ç¬¬1ä¸ªç¯å…‰ æ¸²æŸ“å‡ºä¸€ä»½ 20 ä¸ªé˜´å½±å¯¹è±¡</li><li>ä½¿ç”¨ ç¬¬2ä¸ªç¯å…‰ æ¸²æŸ“å‡ºä¸€ä»½ 20 ä¸ªé˜´å½±å¯¹è±¡</li><li>&mldr;</li><li>ä½¿ç”¨ ç¬¬5ä¸ªç¯å…‰ æ¸²æŸ“å‡ºä¸€ä»½ 20 ä¸ªé˜´å½±å¯¹è±¡</li><li>æœ€ç»ˆå°† 5 æ¬¡æ¸²æŸ“çš„é˜´å½±ç»“æœè¿›è¡Œåˆå¹¶ï¼Œå¾—å‡ºæœ€ç»ˆçš„é˜´å½±</li></ol><p>ä»ä¸Šè¿°æ¸²æŸ“è¿‡ç¨‹å¯ä»¥çœ‹å‡ºï¼Œæ¯å¤šä¸€ä¸ªå¯äº§ç”Ÿé˜´å½±çš„å…‰æºã€é˜´å½±å¯¹è±¡ï¼Œåˆ™éœ€è¦å¤šæ¸²æŸ“ä¸€æ¬¡åœºæ™¯ã€‚</p><p><strong>ç”±æ­¤å¯è§ï¼Œé˜´å½±çš„æ¸²æŸ“éœ€è¦å¤§é‡çš„è®¡ç®—å’Œæ€§èƒ½ã€‚</strong></p><h4 id=é™ä½é˜´å½±æ‰€éœ€æ€§èƒ½çš„è§£å†³åŠæ³•>é™ä½é˜´å½±æ‰€éœ€æ€§èƒ½çš„è§£å†³åŠæ³•<a hidden class=anchor aria-hidden=true href=#é™ä½é˜´å½±æ‰€éœ€æ€§èƒ½çš„è§£å†³åŠæ³•>#</a></h4><p><strong>æ–¹æ¡ˆ1ï¼šå¯ä»¥æœ‰å¤šä¸ªç¯å…‰ï¼Œä½†åªæœ‰ä¸€ä¸ªå¹³è¡Œå…‰å¯äº§ç”Ÿé˜´å½±</strong></p><p><strong>æ–¹æ¡ˆ2ï¼šä½¿ç”¨ å…‰ç…§è´´å›¾ æˆ– ç¯å¢ƒå…‰ç…§é®æŒ¡è´´å›¾ æ¥é¢„å…ˆè®¡ç®—ç¦»çº¿ç…§æ˜çš„æ•ˆæœ</strong></p><p><strong>æ–¹æ¡ˆ3ï¼šä½¿ç”¨ å‡é˜´å½±ï¼Œæ·»åŠ ä¸€ä¸ªå¹³é¢æ”¾åˆ°ç‰©ä½“ä¸‹æ–¹çš„åœ°é¢ä¸Šï¼ŒåŒæ—¶èµ‹äºˆä¸€ä¸ªçœ‹ç€åƒé˜´å½±çš„çº¹ç†å›¾ç‰‡æè´¨</strong></p><p>æ–¹æ¡ˆ1ã€æ–¹æ¡ˆ2 æˆ‘ä»¬ä¼šåœ¨ä»¥åå†è¯¦ç»†è®²è¿°å­¦ä¹ ï¼Œæœ¬æ–‡å…ˆå®ç°ä¸€ä¸‹æ–¹æ¡ˆ3ã€‚</p><p><strong>è¡¥å……è¯´æ˜ï¼š</strong></p><p>å¯¹äºç»å¤§å¤šæ•° æ¸¸æˆåœºæ™¯ æ¥è¯´ï¼Œäººç‰©è„šä¸‹çš„é˜´å½±éƒ½æ˜¯é‡‡ç”¨ æ–¹æ¡ˆ3 çš„ç­–ç•¥ï¼Œä¸€èˆ¬äººä»¬æ˜¯å¯ä»¥æ¥å—è¿™ç§å‡é˜´å½±ã€‚</p><p>è¿™ç§å‡é˜´å½±å¯¹æ¸²æŸ“æ€§èƒ½çš„æå‡éå¸¸å¤§ã€‚</p><h2 id=å‡é˜´å½±ç¤ºä¾‹hellofakeshadow>å‡é˜´å½±ç¤ºä¾‹ï¼šHelloFakeShadow<a hidden class=anchor aria-hidden=true href=#å‡é˜´å½±ç¤ºä¾‹hellofakeshadow>#</a></h2><h4 id=ç¤ºä¾‹ç›®æ ‡>ç¤ºä¾‹ç›®æ ‡<a hidden class=anchor aria-hidden=true href=#ç¤ºä¾‹ç›®æ ‡>#</a></h4><ol><li><p>ä¸€ä¸ªç±»ä¼¼é»‘ç™½æ£‹ç›˜ä¸€æ ·çš„åœ°é¢(ä¹‹å‰ç¤ºä¾‹å·²ç»ä½¿ç”¨å¤šæ¬¡)</p></li><li><p>åœ¨è¿™ä¸ªå¹³å°ä¸Šé¢æœ‰ 15 ä¸ªè·³åŠ¨çš„å°çƒ</p></li><li><p>æ¯ä¸ªå°çƒé¢œè‰²å‡ä¸åŒ</p></li><li><p>æ¯ä¸ªå°çƒåœ¨ä¸€å®šèŒƒå›´å†…å¾ªç¯ã€ä¸”æœ‰è§„å¾‹çš„è·³åŠ¨</p></li><li><p>æ¯ä¸ªå°çƒéƒ½æœ‰è‡ªå·±çš„åœ¨åœ°é¢ä¸Šçš„é˜´å½±</p><blockquote><p>æ³¨æ„è¿™ä¸ªé˜´å½±æ˜¯å‡çš„é˜´å½±ï¼Œå¹¶ä¸æ˜¯å…‰ç…§äº§ç”Ÿçš„ï¼Œè€Œæ˜¯æˆ‘ä»¬æ¨¡æ‹Ÿå‡ºæ¥çš„</p></blockquote></li><li><p>å°çƒé˜´å½±éšç€å°çƒè·³åŠ¨è€Œåšå‡ºå¯¹åº”çš„ä½ç½®ã€æµ“åº¦(æ˜æš—)å˜åŒ–</p></li></ol><h4 id=ä»£ç æ€è·¯>ä»£ç æ€è·¯<a hidden class=anchor aria-hidden=true href=#ä»£ç æ€è·¯>#</a></h4><p><strong>1ã€å¦‚ä½•åˆ›å»ºåœ°é¢ï¼Ÿ</strong></p><p>ç­”ï¼šæˆ‘ä»¬ä¹‹å‰ç¤ºä¾‹å·²ç»æ¼”ç¤ºè¿‡ï¼Œç»§ç»­ä½¿ç”¨ é»‘ç™½çº¹ç†å›¾ç‰‡ äº§ç”Ÿåœ°é¢ï¼Œä¸å†å¤šè¨€ã€‚</p><p><strong>2ã€å¦‚ä½•åˆ›å»º 15 ä¸ªé¢œè‰²ä¸åŒçš„å°çƒï¼Ÿ</strong></p><p>ç­”ï¼šå¯ä»¥é€šè¿‡ for å¾ªç¯æ¥åˆ›å»º 15 ä¸ªå°çƒï¼Œåœ¨æ¯ä¸€æ¬¡ for å¾ªç¯ä¸­ï¼Œè®¾ç½®ä¸åŒçš„å°çƒæè´¨é¢œè‰²ã€‚</p><p>å¤§ä½“ä»£ç å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>const numSphere = 15
</span></span><span style=display:flex><span>for(let i = 0; i&lt;numSphere; i++){
</span></span><span style=display:flex><span>  const sphereMat = new Three.MeshPhongMaterial()
</span></span><span style=display:flex><span>  sphereMat.color.setHSL(i / numSphere, 1, 0.75)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>3ã€å¦‚ä½•åˆ›å»ºå‡é˜´å½±ï¼Ÿ</strong></p><p>ç­”ï¼šé¦–å…ˆåˆ›å»ºå‡é˜´å½±å¯¹åº”çš„ PNG å›¾ç‰‡ï¼Œåƒå¢¨æ°´æ»´åœ¨æ°´ä¸Šåçš„æ ·å­ã€‚å›¾ç‰‡ä¸­é—´é¢œè‰²æ·±ï¼Œè¶Šå¾€å¤–æ‰©é¢œè‰²è¶Šæ·¡ç›´è‡³é€æ˜ã€‚</p><p><img loading=lazy src=https://threejsfundamentals.org/threejs/resources/images/roundshadow.png alt></p><blockquote><p>æ„å¤–ä¸æ„å¤–ï¼Œæœ¬æ–‡ç»ˆäºæœ‰ä¸€å¼ é…å›¾äº†^_^</p></blockquote><p>æˆ‘ä»¬é€šè¿‡ çº¹ç†åŠ è½½å™¨ï¼ŒåŠ è½½è¿™å¼ å›¾ç‰‡ä½œä¸ºé˜´å½±çš„çº¹ç†ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª Three.PlaneBufferGeometry å‡ ä½•ä½“ï¼Œé€šè¿‡åˆ›å»ºç½‘æ ¼è®©å‡ ä½•ä½“å’Œæè´¨æœ€ç»ˆå˜æˆé˜´å½±ç‰©ä½“ç½‘æ ¼ã€‚</p><p>ç‰¹åˆ«æé†’ï¼š</p><ol><li>åœ¨å°çƒå‡ ä½•ä½“çš„æ„é€ å‚æ•°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¾å®š <code>transparent: true</code>ï¼Œå¯ç”¨é€æ˜åº¦ï¼Œå¦åˆ™æ¸²æŸ“å‡ºçš„é˜´å½±ä¸ºä¸€ä¸ªæ•´ä½“çš„é»‘å—ã€‚</li><li>åŒæ—¶è®¾å®š <code>depthWrite: false</code>ï¼Œä»¥é™ä½é˜´å½±æ¸²æŸ“çš„ç²¾ç¡®åº¦ï¼Œè®©é˜´å½±æ›´åŠ æ¨¡ç³Šå¹³æ»‘ã€‚</li></ol><p><strong>4ã€å¦‚ä½•è®©æŸä¸ªå°çƒå’Œå®ƒçš„é˜´å½±ä¸ºä¸€ä¸ªæ•´ä½“ï¼Ÿ</strong></p><p>ç­”ï¼šåˆ›å»ºä¸€ä¸ª Three.Object3D çš„å¯¹è±¡ï¼Œå°† å°çƒ å’Œ é˜´å½± éƒ½æ·»åŠ è¿›å»ï¼Œè®©ä»–ä»¬å½¢æˆä¸€ä¸ªæ•´ä½“ã€‚åœ¨å†…éƒ¨è®¾ç½®é˜´å½±çš„ position.y = 0.001ï¼Œè®©é˜´å½±çœ‹ä¸Šå»æ›´åŠ è´´è¿‘åœ°é¢ï¼ŒåŒæ—¶è®¾ç½®å°çƒçš„ position ä¸º å…¶ä»–å€¼ï¼Œè®©å°çƒå’Œé˜´å½±åœ¨ y è½´ä¸Šä¿æŒä¸€å®šçš„è·ç¦»ã€‚</p><p><strong>5ã€å¦‚ä½•è®©å°çƒå¾ªç¯ã€ä¸”æœ‰è§„å¾‹çš„è·³åŠ¨ï¼Ÿ</strong></p><p>ç­”ï¼šè¿™ä¸ªç‰µæ‰¯ä¸€äº›å…·ä½“çš„æ•°å­¦ç®—æ³•ï¼Œå‚è§åé¢ç¤ºä¾‹ä¸­è´´å‡ºæ¥çš„å…·ä½“ä»£ç å§ã€‚</p><p><strong>6ã€å¦‚ä½•è®©é˜´å½±éšç€å°çƒè·³åŠ¨é«˜åº¦è€Œå‘ç”Ÿå¯¹åº”çš„å˜åŒ–ï¼Ÿ</strong></p><p>ç­”ï¼šæ¯æ¬¡æ›´æ–°å°çƒ y è½´çš„å€¼æ—¶ï¼Œæ ¹æ®ä¸€å®šæ¯”ä¾‹ï¼Œä¿®æ”¹ é˜´å½±å¯¹åº”çš„é€æ˜åº¦ï¼Œä»¥æ­¤æ¥ä»è§†è§‰ä¸Šæ„Ÿå—åˆ°é˜´å½±çš„å˜åŒ–ã€‚</p><p>è¯·æ³¨æ„ï¼šå¹¶æ²¡æœ‰æ›´æ”¹é˜´å½±çš„å°ºå¯¸å¤§å°ï¼Œè€Œä»…ä»…æ›´æ”¹é˜´å½±çš„é€æ˜åº¦æ¥æ¨¡æ‹Ÿé˜´å½±çš„æ˜æš—å˜åŒ–ã€‚</p><p><strong>7ã€é˜´å½±å’Œå°çƒè®²æ¸…æ¥šäº†ï¼Œé‚£ç¯å…‰å‘¢ï¼Ÿ</strong></p><p>ç­”ï¼šä¸ºäº†è®©æ•´ä¸ªåœºæ™¯èƒ½å¤Ÿæœ‰å…‰ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ  1 ä¸ªåŠçƒç¯å¢ƒå…‰æºã€‚</p><p>ä¸ºäº†ä¸ªå°çƒçœ‹ä¸Šå»æœ‰å…‰æ³½æ„Ÿï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ  1 ä¸ªå¹³è¡Œå…‰ï¼Œè´Ÿè´£ç…§å°„åœ¨å°çƒä¸Šã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ä¸€å…±è¦æ·»åŠ  2 ä¸ªå…‰æºã€‚</p><p><strong>å…³é”®ç‚¹è¡¥å……ï¼š</strong></p><p>æˆ‘ä»¬éœ€è¦å°†æ¸²æŸ“å™¨ WebGLRenderer çš„ physicallyCorrectLights çš„å€¼è®¾ç½®ä¸º trueï¼Œä»¥æŒ‰ç…§ç‰©ç†æ ¡æ­£æ­£ç¡®å…‰ç…§çš„æ¨¡å¼æ¥æ¸²æŸ“åœºæ™¯ã€‚</p><blockquote><p>è¯¥å€¼é»˜è®¤ä¸º falseï¼Œå¦‚æœä¸è®¾ç½®è¯¥å€¼ä¸º trueï¼Œåˆ™æ¸²æŸ“å‡ºçš„å°çƒç‰¹åˆ«äº®ã€‚</p></blockquote><h4 id=ç¤ºä¾‹ä»£ç >ç¤ºä¾‹ä»£ç <a hidden class=anchor aria-hidden=true href=#ç¤ºä¾‹ä»£ç >#</a></h4><p>æˆ‘ä»¬åˆ›å»º src/components/hello-fake-shadow/index.tsx æ–‡ä»¶ã€‚</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>import { useRef, useEffect } from &#39;react&#39;
</span></span><span style=display:flex><span>import * as Three from &#39;three&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>import { OrbitControls } from &#39;three/examples/jsm/controls/OrbitControls&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>import &#39;./index.scss&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>interface SphereShadowBase {
</span></span><span style=display:flex><span>    base: Three.Object3D,
</span></span><span style=display:flex><span>    sphereMesh: Three.Mesh,
</span></span><span style=display:flex><span>    shadowMesh: Three.Mesh,
</span></span><span style=display:flex><span>    y: number
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>const HelloFakeShadow = () =&gt; {
</span></span><span style=display:flex><span>    const canvasRef = useRef&lt;HTMLCanvasElement&gt;(null)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    useEffect(() =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        if (canvasRef.current === null) {
</span></span><span style=display:flex><span>            return
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const renderer = new Three.WebGLRenderer({ canvas: canvasRef.current })
</span></span><span style=display:flex><span>        renderer.physicallyCorrectLights = true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const camera = new Three.PerspectiveCamera(45, 2, 0.1, 1000)
</span></span><span style=display:flex><span>        camera.position.set(0, 10, 20)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const scene = new Three.Scene()
</span></span><span style=display:flex><span>        scene.background = new Three.Color(0xFFFFFF)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const hemisphereLight = new Three.HemisphereLight(0xB1E1FF, 0xB97A20, 2)
</span></span><span style=display:flex><span>        scene.add(hemisphereLight)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const directionalLight = new Three.DirectionalLight(0xFFFFFF, 1)
</span></span><span style=display:flex><span>        directionalLight.position.set(0, 10, 5)
</span></span><span style=display:flex><span>        directionalLight.target.position.set(-5, 0, 0)
</span></span><span style=display:flex><span>        scene.add(directionalLight)
</span></span><span style=display:flex><span>        scene.add(directionalLight.target)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const planeSize = 40
</span></span><span style=display:flex><span>        const loader = new Three.TextureLoader()
</span></span><span style=display:flex><span>        const texture = loader.load(require(&#39;@/assets/imgs/checker.png&#39;).default)
</span></span><span style=display:flex><span>        texture.wrapS = Three.RepeatWrapping
</span></span><span style=display:flex><span>        texture.wrapT = Three.RepeatWrapping
</span></span><span style=display:flex><span>        texture.magFilter = Three.NearestFilter
</span></span><span style=display:flex><span>        texture.repeat.set(planeSize / 2, planeSize / 2)
</span></span><span style=display:flex><span>        const planeMaterial = new Three.MeshBasicMaterial({
</span></span><span style=display:flex><span>            map: texture,
</span></span><span style=display:flex><span>            side: Three.DoubleSide
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        planeMaterial.color.setRGB(1.5, 1.5, 1.5) //åœ¨çº¹ç†å›¾ç‰‡é¢œè‰²çš„RGBåŸºç¡€ä¸Šï¼Œåˆ†åˆ«ä¹˜ä»¥ 1.5ï¼Œè¿™æ ·å¯ä»¥ä¸ä¿®æ”¹çº¹ç†å›¾ç‰‡çš„å‰æä¸‹è®©çº¹ç†å›¾ç‰‡æ›´åŠ åç™½ä¸€äº›
</span></span><span style=display:flex><span>        const planeGeo = new Three.PlaneBufferGeometry(planeSize, planeSize)
</span></span><span style=display:flex><span>        const mesh = new Three.Mesh(planeGeo, planeMaterial)
</span></span><span style=display:flex><span>        mesh.rotation.x = Math.PI * -0.5
</span></span><span style=display:flex><span>        scene.add(mesh)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const shadowTexture = loader.load(require(&#39;@/assets/imgs/roundshadow.png&#39;).default)
</span></span><span style=display:flex><span>        const basesArray: SphereShadowBase[] = [] //æ‰€æœ‰çƒä½“å‡é˜´å½±å¯¹åº”çš„æ•°ç»„
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const sphereRadius = 1
</span></span><span style=display:flex><span>        const sphereGeo = new Three.SphereBufferGeometry(sphereRadius, 32, 16)
</span></span><span style=display:flex><span>        const shadowSize = 1 //å‡é˜´å½±çš„å°ºå¯¸
</span></span><span style=display:flex><span>        const shadowGeo = new Three.PlaneBufferGeometry(shadowSize, shadowSize) //å‡é˜´å½±å¯¹åº”çš„å¹³é¢å‡ ä½•ä½“
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const numSphere = 15 //å°†éšæœºåˆ›å»º 15 ä¸ªçƒä½“
</span></span><span style=display:flex><span>        for (let i = 0; i &lt; numSphere; i++) {
</span></span><span style=display:flex><span>            const base = new Three.Object3D() //åˆ›å»º çƒå’Œé˜´å½± çš„æ•´ä½“å¯¹è±¡
</span></span><span style=display:flex><span>            scene.add(base)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            const shadowMat = new Three.MeshBasicMaterial({
</span></span><span style=display:flex><span>                map: shadowTexture,
</span></span><span style=display:flex><span>                transparent: true,
</span></span><span style=display:flex><span>                depthWrite: false
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            const shadowSize = sphereRadius * 4
</span></span><span style=display:flex><span>            const shadowMesh = new Three.Mesh(shadowGeo, shadowMat)
</span></span><span style=display:flex><span>            shadowMesh.position.y = 0.001
</span></span><span style=display:flex><span>            shadowMesh.rotation.x = Math.PI * -0.5
</span></span><span style=display:flex><span>            shadowMesh.scale.set(shadowSize, shadowSize, shadowSize)
</span></span><span style=display:flex><span>            base.add(shadowMesh)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            const sphereMat = new Three.MeshPhongMaterial()
</span></span><span style=display:flex><span>            sphereMat.color.setHSL(i / numSphere, 1, 0.75) //ç»™ çƒ è®¾ç½®ä¸åŒé¢œè‰²
</span></span><span style=display:flex><span>            const sphereMesh = new Three.Mesh(sphereGeo, sphereMat)
</span></span><span style=display:flex><span>            sphereMesh.position.set(0, sphereRadius + 2, 0)
</span></span><span style=display:flex><span>            base.add(sphereMesh)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            basesArray.push({
</span></span><span style=display:flex><span>                base,
</span></span><span style=display:flex><span>                sphereMesh,
</span></span><span style=display:flex><span>                shadowMesh,
</span></span><span style=display:flex><span>                y: sphereMesh.position.y
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const controls = new OrbitControls(camera, canvasRef.current)
</span></span><span style=display:flex><span>        controls.target.set(0, 5, 0)
</span></span><span style=display:flex><span>        controls.update()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const render = (time: number) =&gt; {
</span></span><span style=display:flex><span>            time *= 0.001
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            basesArray.forEach((item, index) =&gt; {
</span></span><span style=display:flex><span>                const { base, sphereMesh, shadowMesh, y } = item
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                const u = index / basesArray.length
</span></span><span style=display:flex><span>                const speed = time * 0.2
</span></span><span style=display:flex><span>                const angle = speed + u * Math.PI * 2 * (index % 1 ? 1 : -1)
</span></span><span style=display:flex><span>                const radius = Math.sin(speed - index) * 10
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                base.position.set(Math.cos(angle)* radius,0,Math.sin(angle)* radius)
</span></span><span style=display:flex><span>                const yOff = Math.abs(Math.sin(time*2+index))
</span></span><span style=display:flex><span>                sphereMesh.position.y = y + Three.MathUtils.lerp(-2,2,yOff);
</span></span><span style=display:flex><span>                (shadowMesh.material as Three.Material).opacity = Three.MathUtils.lerp(1,0.25,yOff)
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            renderer.render(scene, camera)
</span></span><span style=display:flex><span>            window.requestAnimationFrame(render)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        window.requestAnimationFrame(render)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const handleResize = () =&gt; {
</span></span><span style=display:flex><span>            if (canvasRef.current === null) {
</span></span><span style=display:flex><span>                return
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            const width = canvasRef.current.clientWidth
</span></span><span style=display:flex><span>            const height = canvasRef.current.clientHeight
</span></span><span style=display:flex><span>            camera.aspect = width / height
</span></span><span style=display:flex><span>            camera.updateProjectionMatrix()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            renderer.setSize(width, height, false)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        handleResize()
</span></span><span style=display:flex><span>        window.addEventListener(&#39;resize&#39;, handleResize)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        return () =&gt; {
</span></span><span style=display:flex><span>            window.removeEventListener(&#39;resize&#39;, handleResize)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }, [canvasRef])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    return (
</span></span><span style=display:flex><span>        &lt;canvas ref={canvasRef} className=&#39;full-screen&#39; /&gt;
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>export default HelloFakeShadow
</span></span></code></pre></div><p>è¿è¡Œåï¼Œå°±ä¼šçœ‹åˆ° 15 ä¸ªè·³åŠ¨ä¸”æœ‰é˜´å½±çš„å°çƒã€‚</p><p><strong>è¡¥å……ä¸€ç‚¹ï¼šç‰©ä½“ç¢°æ’</strong></p><p>å¦‚æœä½ æŠŠè§†è§’å˜ä¸ºé¡¶è§†å›¾ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªç°è±¡ï¼šåœ¨è·³åŠ¨è¿‡ç¨‹ä¸­è‹¥ä¸¤ä¸ªå°çƒå‘ç”Ÿä½ç½®ä¸Šçš„é‡å ï¼Œå°çƒä¼šç›´æ¥èå…¥åˆ°å¯¹æ–¹ä¹‹ä¸­ã€‚</p><p>è¿™ä¸€ç‚¹å¹¶ä¸åƒæˆ‘ä»¬ç°å®ä¸­ï¼Œå°çƒä¼šå‘ç”Ÿç¢°æ’äº’ç›¸ä½œç”¨ä¹‹ç±»çš„ç‰©ä½“ç°è±¡ã€‚</p><p><strong>Three.js é»˜è®¤å¹¶ä¸åŒ…å«ç‰©ä½“ç¢°æ’ç‰©ç†æ®·å‹¤ã€‚</strong></p><p>è‹¥ä½ çœŸçš„éœ€è¦åœ¨ Three.js ä¸­éœ€è¦ç‰©ä½“ä¹‹é—´çš„ç¢°æ’ï¼Œé‚£ä¹ˆä½ å¯ä»¥å¼•å…¥ç¬¬ä¸‰æ–¹ç¼–å†™çš„ ç‰©ä½“ç¢°æ’æ¨¡å—ï¼Œå…·ä½“å¦‚ä½•å¼•å…¥æˆ‘ä»¬å…ˆç•¥è¿‡ã€‚</p><p>ä½ åªéœ€çŸ¥é“ Three.js è¿™ä¸ªç‰¹æ€§å°±å¥½ã€‚</p><p><strong>Three.js ä¾§é‡ç‚¹æ—¶åœºæ™¯æ¸²æŸ“ï¼Œè€Œä¸æ˜¯ 3D æ¸¸æˆã€‚</strong></p><blockquote><p>äº‹å®ä¸Šè¿™æ˜¯ Three.js çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œä¹Ÿæ˜¯ç¼ºç‚¹</p></blockquote><blockquote><p>è‹¥å¼€å‘ 3D æ¸¸æˆç±»ï¼Œé€šå¸¸å¹¶ä¸ä¼šé€‰æ‹© Three.jsï¼Œä¼šé€‰æ‹©å…¶ä»– 3D æ¸¸æˆå¼•æ“ï¼Œä¾‹å¦‚ï¼šBabylon.jsã€PlayCanvas.js</p></blockquote><h2 id=å¹³è¡Œå…‰é˜´å½±directionallightshadowç¤ºä¾‹helloshadow>å¹³è¡Œå…‰é˜´å½±(DirectionalLightShadow)ç¤ºä¾‹ï¼šHelloShadow<a hidden class=anchor aria-hidden=true href=#å¹³è¡Œå…‰é˜´å½±directionallightshadowç¤ºä¾‹helloshadow>#</a></h2><h4 id=ç¤ºä¾‹ç›®æ ‡-1>ç¤ºä¾‹ç›®æ ‡<a hidden class=anchor aria-hidden=true href=#ç¤ºä¾‹ç›®æ ‡-1>#</a></h4><ol><li><p>ä¸€ä¸ªé»‘ç™½ç›¸é—´çš„åœ°é¢ä¸Šï¼Œæ”¾ç½®æœ‰ ä¸€ä¸ªç«‹æ–¹ä½“å’Œä¸€ä¸ªçƒä½“</p></li><li><p>åœºæ™¯ä¸­æœ‰ä¸€ä¸ª å¹³è¡Œå…‰æº</p></li><li><p>åœ°é¢ä¸Šæ˜¾ç¤ºå‡º ç«‹æ–¹ä½“å’Œçƒä½“ çœŸæ­£çš„é˜´å½±</p><blockquote><p>è¿™é‡Œè¯´çš„é˜´å½±æ˜¯çœŸçš„é˜´å½±å¯¹è±¡ï¼Œè€Œä¸æ˜¯â€œç‰©ä½“æ˜¾ç¤ºå‡ºçš„æ˜æš—â€æˆ–â€œåƒ HelloFakeShadow é‚£æ ·å‡çš„é˜´å½±â€</p></blockquote></li><li><p>ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬è§‚å¯Ÿï¼Œåœºæ™¯ä¸­éœ€è¦æ·»åŠ ï¼šç¯å…‰çš„è¾…åŠ©å¯¹è±¡ã€é•œå¤´çš„è¾…åŠ©å¯¹è±¡ã€â€œé˜´å½±çš„è¾…åŠ©å¯¹è±¡â€</p><blockquote><p>è¯·æ³¨æ„ â€œé˜´å½±çš„è¾…åŠ©å¯¹è±¡â€å…¶å®æ˜¯åŠ ä¸Šäº†åŒå¼•å·ï¼Œäº‹å®ä¸Šå¹¶ä¸å­˜åœ¨é˜´å½±çš„è¾…åŠ©å¯¹è±¡ï¼Œè¿™é‡Œçš„è¾…åŠ©å¯¹è±¡å®é™…ä¸ŠæŒ‡çš„æ˜¯ â€œç¯å…‰ä¸­å¯¹åº”çš„é˜´å½±é•œå¤´çš„è¾…åŠ©å¯¹è±¡â€ã€‚</p></blockquote></li></ol><h4 id=ä»£ç æ€è·¯-1>ä»£ç æ€è·¯<a hidden class=anchor aria-hidden=true href=#ä»£ç æ€è·¯-1>#</a></h4><p><strong>1ã€åŸºç¡€åœºæ™¯çš„æ­å»º</strong></p><p>è¿™ä¸ªåœºæ™¯åœ¨ä¹‹å‰ç¤ºä¾‹ä¸­å·²ç»åå¤å‡ºç°äº†ï¼Œä¸å†è¿‡å¤šè®²è¿°ã€‚</p><p><strong>2ã€é˜´å½±çš„ç›¸å…³è®¾ç½®æœ‰å“ªäº›ï¼Ÿ</strong></p><ol><li><p>æ¸²æŸ“å™¨(WebGLRenderer)å¼€å¯æ¸²æŸ“é˜´å½±</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>renderer.shadowMap.enable = true
</span></span></code></pre></div></li><li><p>å¹³è¡Œç¯å…‰(DirectionalLight)å¼€å¯æŠ•å°„é˜´å½±</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>light.castShadow = true
</span></span></code></pre></div></li><li><p>åœ°é¢å¼€å¯ æ¥æ”¶æŠ•å½±</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>planeMesh.receiveShadow = true
</span></span></code></pre></div></li><li><p>ç«‹æ–¹ä½“å’Œçƒä½“éƒ½å¼€å¯ æ¥æ”¶å’ŒæŠ•å°„é˜´å½±</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>boxMesh.castShadow = true
</span></span><span style=display:flex><span>boxMesh.receiveShadow = true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sphereMesh.castShadow = true
</span></span><span style=display:flex><span>sphereMesh.receiveShadow = true
</span></span></code></pre></div></li></ol><p><strong>3ã€é˜´å½±çš„è¾…åŠ©å¯¹è±¡ï¼Ÿ</strong></p><p>ç¯å…‰ã€é•œå¤´ çš„è¾…åŠ©å¯¹è±¡åœ¨ä¹‹å‰ç« èŠ‚ä¸­ï¼Œå·²ç»ä½¿ç”¨è¿‡äº†ï¼Œé‚£ä¹ˆè¯´ä¸€ä¸‹ â€œé˜´å½±çš„è¾…åŠ©å¯¹è±¡â€ã€‚</p><p>é¦–å…ˆåœ¨ Three.js ä¸­æ ¹æœ¬ä¸å­˜åœ¨é˜´å½±çš„è¾…åŠ©å¯¹è±¡ï¼Œâ€œé˜´å½±çš„è¾…åŠ©å¯¹è±¡â€å…¶å®æ˜¯æˆ‘ä¸ªäººæƒ³å‡ºæ¥çš„ä¸€ä¸ªè¯ã€‚</p><p>è¿™ä¸ªæ‰€è°“çš„â€œé˜´å½±çš„è¾…åŠ©å¯¹è±¡â€å…¶å®æ˜¯ ç¯å…‰ä¸­é˜´å½±çš„é•œå¤´å¯¹åº”çš„è¾…åŠ©å¯¹è±¡ã€‚</p><blockquote><p>ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬é€šè¿‡ç¯å…‰çš„è¾…åŠ©å¯¹è±¡æ¥è§‚å¯Ÿç¯å…‰æ‰€èƒ½æŠ•å°„çš„é˜´å½±å¯è§åŒºåŸŸã€‚</p></blockquote><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>const shadowCamera = light.shadow.camera
</span></span><span style=display:flex><span>const shadowHelper = new Three.CameraHelper(shadowCamera)
</span></span><span style=display:flex><span>scene.add(shadowHelper)
</span></span></code></pre></div><p><strong>4ã€ä¿®æ”¹ç¯å…‰ä¸­é˜´å½±çš„é•œå¤´å±æ€§ï¼Œè¦†ç›–ä½æ‰€æœ‰ç‰©ä½“ï¼Œå¥½è®©é˜´å½±æ˜¾ç¤ºå®Œæ•´</strong></p><p>å¦‚æœä½ åœ¨ç¼–å†™ç¤ºä¾‹æ—¶å‘ç°ç‰©ä½“åœ¨åœ°é¢ä¸Šçš„å½±å­æ˜¾ç¤ºä¸å®Œæ•´(çœ‹ç€å½±å­ä¼¼ä¹è¢«è£åˆ‡æ‰äº†ä¸€éƒ¨åˆ†)ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µå¤šæ•°åŸå› å°±æ˜¯ ç¯å…‰ä¸­é˜´å½±çš„é•œå¤´ç…§ç€èŒƒå›´ä¸è¶³ä»¥è¦†ç›–ç‰©ä½“ï¼Œæ‰€ä»¥æ‰å‡ºç°äº†å½±å­è¢«è£åˆ‡æ‰çš„æƒ…å†µã€‚</p><p>åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰‹å·¥ä¿®æ”¹é˜´å½±é•œå¤´è§†æ¤çš„å¯è§èŒƒå›´ï¼Œè®©è§†æ¤åˆšå¥½å¯ä»¥è¦†ç›–ä½ç‰©ä½“ã€‚åŒæ—¶æˆ‘ä»¬è¦å°½é‡ä¿è¯è§†æ¤åˆä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œè€Œæ˜¯åˆšå¥½æ¯”è¾ƒåˆé€‚çš„å¤§å°ã€‚</p><p>ç‰¹åˆ«å¼ºè°ƒï¼š</p><ol><li>å¹³è¡Œå…‰ä¸­å½±å­(DirectionalLightShadow)çš„é•œå¤´ä½¿ç”¨çš„æ˜¯ OrthographicCameraï¼Œä¸æ˜¯ PerspectiveCamera</li><li>å…¶ä»– 2 ç§é˜´å½± PointLightShadowã€SpotLightShadow é•œå¤´é»˜è®¤ä½¿ç”¨çš„æ˜¯ PerspectiveCameraã€‚</li><li>å› æ­¤åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œå½“æˆ‘ä»¬è¦ä¿®æ”¹ é˜´å½±çš„é•œå¤´è¦†ç›–åŒºåŸŸæ—¶ä¿®æ”¹çš„æ˜¯ OrthographicCamera çš„ leftã€rightã€topã€bottom å±æ€§ã€‚</li></ol><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>const shadowCamera = light.shadow.camera
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ shadowCamera.left = -10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ shadowCamera.right = 10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ shadowCamera.top = 10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ shadowCamera.bottom = -10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ shadowCamera.updateProjectionMatrix()
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e></span>
</span></span><span style=display:flex><span>const shadowHelper = new Three.CameraHelper(shadowCamera)
</span></span><span style=display:flex><span>scene.add(shadowHelper)
</span></span></code></pre></div><blockquote><p>ç»è¿‡ä¿®æ”¹åçš„è§†æ¤ï¼Œå®é™…å®½ 20ã€é«˜ 20</p></blockquote><p>åœ¨æœ¬ç¤ºä¾‹ä¸­æˆ‘ä»¬æ·»åŠ çš„ shadowHelper äº‹å®ä¸Šå°±æ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬è§‚å¯Ÿè§†æ¤æ˜¯å¦å®Œå…¨è¦†ç›–ä½äº†ç‰©ä½“ã€‚</p><blockquote><p>è¿™é‡Œæˆ‘ä»¬å…ˆæå‡ºä¸€ä¸ªé—®é¢˜ï¼šä¸ºäº†çœäº‹æˆ‘ä»¬æ˜¯å¦å¯ä»¥ç›´æ¥å°†é˜´å½±é•œå¤´è§†æ¤çš„èŒƒå›´è®¾ç½®æˆç‰¹åˆ«å¤§ï¼Œè¿™æ ·å°±ä¸ç”¨æ‹…å¿ƒä¸‡ä¸€ç‰©ä½“ä¸åœ¨è§†æ¤èŒƒå›´é‡Œäº†ã€‚å¯ä»¥è¿™æ ·åšå—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼šä¸å¯ä»¥ï¼</p><p>è‡³äºä¸ºä»€ä¹ˆï¼Œä¼šåœ¨åé¢è¯¦ç»†è®²è¿°ã€‚</p></blockquote><h4 id=æ³¨æ„äº‹é¡¹>æ³¨æ„äº‹é¡¹<a hidden class=anchor aria-hidden=true href=#æ³¨æ„äº‹é¡¹>#</a></h4><ol><li><p>åœ¨ å‡é˜´å½±ç¤ºä¾‹(HelloFakeShadow)ä¸­ï¼Œæˆ‘ä»¬å°† åœ°é¢å¹³å°ä½¿ç”¨çš„æ˜¯ä¸åå…‰æè´¨ MeshBasicMaterialï¼Œä½†æ˜¯åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œéœ€è¦å°†åœ°é¢å¹³å°è®¾ç½®ä¸ºå¯åå…‰æè´¨ MeshPhoneMaterialã€‚</p><blockquote><p>å¦‚æœåœ°é¢å¹³å°æè´¨ç»§ç»­ä½¿ç”¨ MeshBasicMaterialï¼Œåˆ™æ°¸è¿œæ˜¾ç¤ºä¸å‡ºé˜´å½±ã€‚</p></blockquote></li><li><p>å†æ¬¡å¼ºè°ƒä¸€éï¼Œä½ æ— éœ€è¦åˆ›å»º DirectionalLightShadow å®ä¾‹ï¼Œé˜´å½±å®ä¾‹æ˜¯ç”± ç¯å…‰(DirectionalLight) å†…éƒ¨åˆ›å»ºçš„ã€‚</p></li><li><p>ç›®å‰æˆ‘ä»¬ä¸€ç›´é‡‡ç”¨çš„æ˜¯ ç®€å•å…‰ç…§æ¨¡å‹ï¼Œæ‰€ä»¥ç‰©ä½“çš„é˜´å½±æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯ç‰©ä½“çš„æ˜æš—ä¸å®é™…ç”Ÿæ´»ä¸­çš„æ•ˆæœåœ¨æŸäº›åœ°æ–¹ç•¥å¾®ä¸åŒï¼Œè¯´ç›´ç™½ç‚¹å°±æ˜¯æœ‰äº›åœ°æ–¹çš„æ˜æš—ä¸ç¬¦åˆè‡ªç„¶ç°è±¡ã€‚</p></li><li><p>ç”±äºåœºæ™¯ä¸­æ·»åŠ äº† é•œå¤´äº¤äº’å¯¹è±¡ OrbitControlsï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶ï¼Œä¹Ÿè¦å°† å„ä¸ªè¾…åŠ©å¯¹è±¡è¿›è¡Œæ›´æ–°ã€‚</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>const render = () =&gt; {
</span></span><span style=display:flex><span>  cameraHelper.update()
</span></span><span style=display:flex><span>  lightHelper.update()
</span></span><span style=display:flex><span>  shadowHelper.update()
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li></ol><h4 id=ç¤ºä¾‹ä»£ç -1>ç¤ºä¾‹ä»£ç <a hidden class=anchor aria-hidden=true href=#ç¤ºä¾‹ä»£ç -1>#</a></h4><p>ç¤ºä¾‹ä»£ç ä½äº src/components/hello-shadow/index.stx</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>import { useEffect, useRef } from &#39;react&#39;
</span></span><span style=display:flex><span>import * as Three from &#39;three&#39;
</span></span><span style=display:flex><span>import { OrbitControls } from &#39;three/examples/jsm/controls/OrbitControls&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>import &#39;./index.scss&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>const HelloShadow = () =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    const canvasRef = useRef&lt;HTMLCanvasElement&gt;(null)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    useEffect(() =&gt; {
</span></span><span style=display:flex><span>        if (canvasRef.current === null) {
</span></span><span style=display:flex><span>            return
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const renderer = new Three.WebGLRenderer({ canvas: canvasRef.current })
</span></span><span style=display:flex><span>        renderer.shadowMap.enabled = true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const scene = new Three.Scene()
</span></span><span style=display:flex><span>        scene.background = new Three.Color(0x333333)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const camera = new Three.PerspectiveCamera(45, 2, 5, 100)
</span></span><span style=display:flex><span>        camera.position.set(0, 10, 20)
</span></span><span style=display:flex><span>        scene.add(camera)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const helperCamera = new Three.PerspectiveCamera(45, 2, 5, 100)
</span></span><span style=display:flex><span>        helperCamera.position.set(20, 10, 20)
</span></span><span style=display:flex><span>        helperCamera.lookAt(0, 5, 0)
</span></span><span style=display:flex><span>        scene.add(helperCamera)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const cameraHelper = new Three.CameraHelper(helperCamera)
</span></span><span style=display:flex><span>        scene.add(cameraHelper)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const controls = new OrbitControls(camera, canvasRef.current)
</span></span><span style=display:flex><span>        controls.target.set(0, 5, 0)
</span></span><span style=display:flex><span>        controls.update()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const light = new Three.DirectionalLight(0xFFFFFF, 1)
</span></span><span style=display:flex><span>        light.castShadow = true
</span></span><span style=display:flex><span>        light.position.set(0, 10, 0)
</span></span><span style=display:flex><span>        light.target.position.set(-4, 0, -4)
</span></span><span style=display:flex><span>        scene.add(light)
</span></span><span style=display:flex><span>        scene.add(light.target)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const shadowCamera = light.shadow.camera
</span></span><span style=display:flex><span>        shadowCamera.left = -10
</span></span><span style=display:flex><span>        shadowCamera.right = 10
</span></span><span style=display:flex><span>        shadowCamera.top = 10
</span></span><span style=display:flex><span>        shadowCamera.bottom = -10
</span></span><span style=display:flex><span>        shadowCamera.updateProjectionMatrix()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const lightHelper = new Three.DirectionalLightHelper(light)
</span></span><span style=display:flex><span>        scene.add(lightHelper)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const shadowHelper = new Three.CameraHelper(shadowCamera)
</span></span><span style=display:flex><span>        scene.add(shadowHelper)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const planeSize = 40
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const loader = new Three.TextureLoader()
</span></span><span style=display:flex><span>        const texture = loader.load(require(&#39;@/assets/imgs/checker.png&#39;).default)
</span></span><span style=display:flex><span>        texture.wrapS = Three.RepeatWrapping
</span></span><span style=display:flex><span>        texture.wrapT = Three.RepeatWrapping
</span></span><span style=display:flex><span>        texture.magFilter = Three.NearestFilter
</span></span><span style=display:flex><span>        texture.repeat.set(planeSize / 2, planeSize / 2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const planGeo = new Three.PlaneBufferGeometry(planeSize, planeSize)
</span></span><span style=display:flex><span>        const planeMat = new Three.MeshPhongMaterial({
</span></span><span style=display:flex><span>            map: texture,
</span></span><span style=display:flex><span>            side: Three.DoubleSide
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        const planeMesh = new Three.Mesh(planGeo, planeMat)
</span></span><span style=display:flex><span>        planeMesh.receiveShadow = true
</span></span><span style=display:flex><span>        planeMesh.rotation.x = Math.PI * -0.5
</span></span><span style=display:flex><span>        scene.add(planeMesh)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const material = new Three.MeshPhongMaterial({
</span></span><span style=display:flex><span>            color: 0x88AACC
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        const boxMat = new Three.BoxBufferGeometry(4, 4, 4)
</span></span><span style=display:flex><span>        const boxMesh = new Three.Mesh(boxMat, material)
</span></span><span style=display:flex><span>        boxMesh.castShadow = true
</span></span><span style=display:flex><span>        boxMesh.receiveShadow = true
</span></span><span style=display:flex><span>        boxMesh.position.set(5, 3, 0)
</span></span><span style=display:flex><span>        scene.add(boxMesh)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const sphereMat = new Three.SphereBufferGeometry(3, 32, 16)
</span></span><span style=display:flex><span>        const sphereMesh = new Three.Mesh(sphereMat, material)
</span></span><span style=display:flex><span>        sphereMesh.castShadow = true
</span></span><span style=display:flex><span>        sphereMesh.receiveShadow = true
</span></span><span style=display:flex><span>        sphereMesh.position.set(-4, 5, 0)
</span></span><span style=display:flex><span>        scene.add(sphereMesh)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const render = () =&gt; {
</span></span><span style=display:flex><span>            cameraHelper.update()
</span></span><span style=display:flex><span>            lightHelper.update()
</span></span><span style=display:flex><span>            shadowHelper.update()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            renderer.render(scene, camera)
</span></span><span style=display:flex><span>            window.requestAnimationFrame(render)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        window.requestAnimationFrame(render)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const handleResize = () =&gt; {
</span></span><span style=display:flex><span>            if (canvasRef.current === null) {
</span></span><span style=display:flex><span>                return
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            const width = canvasRef.current.clientWidth
</span></span><span style=display:flex><span>            const height = canvasRef.current.clientHeight
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            camera.aspect = width / height
</span></span><span style=display:flex><span>            camera.updateProjectionMatrix()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            renderer.setSize(width, height, false)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        handleResize()
</span></span><span style=display:flex><span>        window.addEventListener(&#39;resize&#39;, handleResize)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        return () =&gt; {
</span></span><span style=display:flex><span>            window.removeEventListener(&#39;resize&#39;, handleResize)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }, [canvasRef])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    return (
</span></span><span style=display:flex><span>        &lt;canvas ref={canvasRef} className=&#39;full-screen&#39; /&gt;
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>export default HelloShadow
</span></span></code></pre></div><p>ä»¥ä¸Šä»£ç æ­£å¸¸è¿è¡Œåï¼Œè¿™ä¼šåœ¨åœ°é¢ä¸Šæ˜¾ç¤ºå‡ºæ¯”è¾ƒæ¸…æ™°ã€æ¯”è¾ƒé»‘çš„ç‰©ä½“å½±å­ã€‚</p><h4 id=å›é¡¾ä¹‹å‰æå‡ºçš„é—®é¢˜ä¸ºä»€ä¹ˆé˜´å½±é•œå¤´çš„è§†æ¤æ—¢è¦è¦†ç›–ç‰©ä½“åˆè¦èŒƒå›´åˆé€‚ä¸è¦è¿‡å¤§>å›é¡¾ä¹‹å‰æå‡ºçš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆé˜´å½±é•œå¤´çš„è§†æ¤æ—¢è¦è¦†ç›–ç‰©ä½“ï¼Œåˆè¦èŒƒå›´åˆé€‚ï¼Œä¸è¦è¿‡å¤§ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#å›é¡¾ä¹‹å‰æå‡ºçš„é—®é¢˜ä¸ºä»€ä¹ˆé˜´å½±é•œå¤´çš„è§†æ¤æ—¢è¦è¦†ç›–ç‰©ä½“åˆè¦èŒƒå›´åˆé€‚ä¸è¦è¿‡å¤§>#</a></h4><p>å…ˆä¸è§£é‡Šä¸ºä»€ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°è¯•å°†é˜´å½±é•œå¤´çš„è§†æ¤ä¿®æ”¹å¾—æ¯”è¾ƒå¤§ï¼Œä¾‹å¦‚æ‰©å¤§ 10 å€ï¼Œç„¶åçœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- shadowCamera.left = -10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- shadowCamera.right = 10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- shadowCamera.top = 10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- shadowCamera.bottom = -10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006></span>
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ shadowCamera.left = -100
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ shadowCamera.right = 100
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ shadowCamera.top = 100
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ shadowCamera.bottom = -100
</span></span></span></code></pre></div><p>å½“é˜´å½±è§†æ¤å˜å¾—æ¯”è¾ƒå¤§ï¼Œæ­¤æ—¶è¿è¡Œï¼Œå®é™…æ¸²æŸ“ä¸­ä¼šå‘ç°â€”â€”ç‰©ä½“åœ¨åœ°é¢ä¸Šçš„é˜´å½±å˜å¾—ä¸å¤Ÿå¹³æ»‘ã€æœ‰ç±»ä¼¼é©¬èµ›å…‹çš„å—çŠ¶æ•ˆæœï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p><p>ç­”ï¼šé»˜è®¤é˜´å½±è´´å›¾å°ºå¯¸(shadow mapSize) ä¸º 512 x 512ï¼Œå½“ç¯å…‰ä¸­é˜´å½±é•œå¤´è§†æ¤èŒƒå›´è¶Šå¤§ï¼Œæ‰€éœ€è¦å¯¹åº”çš„é˜´å½±è´´å›¾å°ºå¯¸ä¹Ÿè¦è¶Šå¤§ã€‚å½“è§†æ¤ç‰¹åˆ«å¤§è€Œé˜´å½±è´´å›¾å°ºå¯¸å¹¶ä¸è¶³å¤Ÿå¤§æ—¶å°±ä¼šäº§ç”Ÿè¿™ç§å—çŠ¶é˜´å½±ã€‚</p><p>å½“ç„¶ä½ å¯ä»¥é€šè¿‡ä¿®æ”¹ <code>light.shadow.mapSize.widht</code> å’Œ <code>light.shadow.mapSize.height</code> çš„å€¼ï¼Œå°†å±æ€§å€¼è°ƒå¤§(é»˜è®¤æ˜¯512)ã€‚è¿™æ ·çœ‹ä¼¼å¯ä»¥è§£å†³é˜´å½±å—çŠ¶é—®é¢˜ï¼Œä½†æ˜¯å½“é˜´å½±è´´å›¾å°ºå¯¸è¶Šå¤§ï¼Œå¯¹åº”æ¸²æŸ“æ‰€éœ€çš„è®¡ç®—å’Œæ€§èƒ½ä¹Ÿå°±è¶Šå¤§ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›çš„æ•ˆæœã€‚</p><p>æ‰€ä»¥ï¼Œ<strong>æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ä¸è¦å°†è§†æ¤èŒƒå›´è°ƒæ•´å¾—è¿‡å¤§</strong>ï¼Œè®©è§†æ¤å¯è¦†ç›–ç‰©ä½“ä½†æœ‰ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œè¿™æ‰æ˜¯æˆ‘ä»¬åº”è¯¥åšçš„ã€‚</p><blockquote><p>äº‹å®ä¸Šæ˜¯è§†æ¤å’Œé˜´å½±è´´å›¾å°ºå¯¸ è¶Šåˆé€‚ã€è¶Šè´´è¿‘ï¼Œé˜´å½±æ¸²æŸ“çš„æ•ˆæœè¶Šå¥½ã€‚</p></blockquote><p><strong>è¡¥å……è¯´æ˜ï¼šé˜´å½±è´´å›¾å°ºå¯¸æœ€å¤§èƒ½è®¾ç½®ä¸ºå¤šå°‘ï¼Ÿ</strong></p><p>ç­”ï¼šæ¸²æŸ“å™¨ä¸­ <code>renderer.capabilities.maxTextureSize</code> çš„å€¼å°±æ˜¯æ¸²æŸ“å™¨å¯æ”¯æŒçš„è´´å›¾æœ€å¤§å°ºå¯¸ã€‚</p><h4 id=å¦‚ä½•è®©å½±å­ä¸é‚£ä¹ˆé»‘æ˜¾ç¤ºå¾—æ¯”è¾ƒæ·¡ä¸€äº›>å¦‚ä½•è®©å½±å­ä¸é‚£ä¹ˆé»‘ï¼Œæ˜¾ç¤ºå¾—æ¯”è¾ƒæ·¡ä¸€äº›ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#å¦‚ä½•è®©å½±å­ä¸é‚£ä¹ˆé»‘æ˜¾ç¤ºå¾—æ¯”è¾ƒæ·¡ä¸€äº›>#</a></h4><p>æˆ‘ä»¬æ˜¯æ— æ³•ç›´æ¥ä¿®æ”¹å½±å­çš„æ˜æš—åº¦ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç»™åœºæ™¯ä¸­æ·»åŠ ä¸€ä¸ªåŠçƒç¯å¢ƒå…‰ï¼Œè®©åœºæ™¯æ•´ä½“æ›´åŠ äº®ä¸€äº›ï¼Œä»è€Œå½±å­ä¹Ÿå°±å˜å¾—æ·¡äº†ä¸€äº›ã€‚</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>const renderer = new Three.WebGLRenderer({ canvas: canvasRef.current })
</span></span><span style=display:flex><span>renderer.shadowMap.enabled = true
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ renderer.physicallyCorrectLights = true
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e></span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>//æ·»åŠ åŠçƒç¯å¢ƒå…‰
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ const hemisphereLight = new Three.HemisphereLight(0xFFFFFF, 0x000000, 2)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ scene.add(hemisphereLight)
</span></span></span></code></pre></div><h2 id=èšå…‰ç¯é˜´å½±spotlightshadowç¤ºä¾‹>èšå…‰ç¯é˜´å½±(SpotLightShadow)ç¤ºä¾‹<a hidden class=anchor aria-hidden=true href=#èšå…‰ç¯é˜´å½±spotlightshadowç¤ºä¾‹>#</a></h2><p>æˆ‘ä»¬å°†åœ¨å¹³è¡Œå…‰é˜´å½±ç¤ºä¾‹çš„åŸºç¡€ä¸Šï¼Œä¿®æ”¹æˆ èšå…‰ç¯é˜´å½±ç¤ºä¾‹ã€‚</p><p>æ³¨æ„ï¼š</p><ol><li>ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬è§‚å¯Ÿèšå…‰ç¯é˜´å½±ï¼Œæˆ‘ä»¬å°†ä¸æ·»åŠ  åŠçƒç¯å¢ƒå…‰ã€‚</li><li>èšå…‰ç¯é˜´å½±å¯¹åº”çš„é•œå¤´ä¸º PerspectiveCameraï¼Œè¿™ç§é•œå¤´ä¸Šæˆ‘ä»¬æ²¡æœ‰å¿…è¦å†å»ä¿®æ”¹è§†æ¤èŒƒå›´</li></ol><p>ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>const renderer = new Three.WebGLRenderer({ canvas: canvasRef.current })
</span></span><span style=display:flex><span>renderer.shadowMap.enabled = true
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- renderer.physicallyCorrectLights = true
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006></span>
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- const hemisphereLight = new Three.HemisphereLight(0xFFFFFF, 0x000000, 2)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- scene.add(hemisphereLight)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006></span>
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- const light = new Three.DirectionalLight(0xFFFFFF, 1)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006></span><span style=color:#282828;background-color:#79740e>+ const light = new Three.SpotLight(0xFFFFFF, 1)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e></span>light.castShadow = true
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>const shadowCamera = light.shadow.camera
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>-  shadowCamera.left = -10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>-  shadowCamera.right = 10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>-  shadowCamera.top = 10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>-  shadowCamera.bottom = -10
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006></span>shadowCamera.updateProjectionMatrix()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>-  const lightHelper = new Three.DirectionalLightHelper(light)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006></span><span style=color:#282828;background-color:#79740e>+  const lightHelper = new Three.SpotLightHelper(light)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e></span>scene.add(lightHelper)
</span></span></code></pre></div><h2 id=ç‚¹å…‰æºé˜´å½±pointlightshadowç¤ºä¾‹>ç‚¹å…‰æºé˜´å½±(PointLightShadow)ç¤ºä¾‹<a hidden class=anchor aria-hidden=true href=#ç‚¹å…‰æºé˜´å½±pointlightshadowç¤ºä¾‹>#</a></h2><h4 id=ç‚¹å…‰æºpointlightçš„ç‰¹æ®Šä¹‹å¤„>ç‚¹å…‰æº(PointLight)çš„ç‰¹æ®Šä¹‹å¤„<a hidden class=anchor aria-hidden=true href=#ç‚¹å…‰æºpointlightçš„ç‰¹æ®Šä¹‹å¤„>#</a></h4><p>ç‚¹å…‰æºæ˜¯æœç€å››é¢å…«æ–¹å‘å°„å…‰çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸å½“äºæœç€ ä¸Šã€ä¸‹ã€å·¦ã€å³ã€å‰ã€å 6 ä¸ªé¢éƒ½å‘å…‰ï¼Œè¿™å°±æ„å‘³ç€å®ƒä¼šåœ¨è¿™ 6 ä¸ªé¢ä¸Šéƒ½äº§ç”Ÿé˜´å½±ã€‚</p><blockquote><p>å¹³è¡Œå…‰ã€èšå…‰ç¯ ä»–ä»¬ éƒ½åªä¼šæœç€ä¸€ä¸ªæ–¹å‘å‘å°„å…‰ï¼Œä¸”åªäº§ç”Ÿä¸€ä¸ªé¢ä¸Šçš„é˜´å½±ã€‚</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ ç‚¹å…‰æºé˜´å½± æ¸²æŸ“ä¸€æ¬¡(å®é™…æ˜¯æ¸²æŸ“ 6 ä¸ªé¢çš„é˜´å½±)è¦æ¯”åˆ«çš„é˜´å½±ç±»å‹è®¡ç®—é‡æ›´å¤§ã€æ¸²æŸ“æ‰€éœ€æ—¶é—´å¤šã€‚</p><h4 id=ç¤ºä¾‹çš„ç‰¹æ®Šæ”¹åŠ¨ä¹‹å¤„>ç¤ºä¾‹çš„ç‰¹æ®Šæ”¹åŠ¨ä¹‹å¤„<a hidden class=anchor aria-hidden=true href=#ç¤ºä¾‹çš„ç‰¹æ®Šæ”¹åŠ¨ä¹‹å¤„>#</a></h4><p>ç”±äºä¹‹å‰ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ª åœ°é¢ï¼Œè€Œ ç‚¹å…‰æºé˜´å½±ä¼šåœ¨ 6 ä¸ªé¢ä¸­éƒ½æŠ•å°„é˜´å½±ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ”¹é€ æˆ‘ä»¬çš„åœºæ™¯ã€‚</p><p>å‘åœºæ™¯ä¸­æ·»åŠ å…¶ä»–å‡ ä¸ªé¢ï¼Œä»¥ä¾¿æˆ‘ä»¬çœ‹åˆ°ä¸åŒé¢ä¸Šçš„é˜´å½±ã€‚</p><p><strong>å¦‚ä½•æ·»åŠ  6 ä¸ªé¢ï¼Ÿ</strong></p><p>ç­”ï¼šæˆ‘ä»¬åªéœ€åœ¨åœºæ™¯ä¸­æ·»åŠ ä¸€ä¸ªå°ºå¯¸æ›´å¤§ä¸€ç‚¹çš„ä¸€ä¸ªç«‹æ–¹ä½“ï¼Œä¸ºäº†æ–¹ä¾¿å’Œä¹‹å‰çš„ç«‹æ–¹ä½“åšåŒºåˆ†ï¼Œæˆ‘ä»¬æš‚ä¸”å°†è¿™ä¸ªç«‹æ–¹ä½“ç§°å‘¼ä¸º roomã€‚</p><p>æˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…æ˜¯ï¼š</p><ol><li><p>å°† room åµŒå¥—ä½åŸæœ¬çš„ç«‹æ–¹ä½“å’Œçƒä½“</p></li><li><p>å°† room çš„æè´¨çš„ side è®¾ç½®ä¸º Three.BackSideï¼Œè¿™æ ·æ¸²æŸ“å™¨å°±ä¼šæ¸²æŸ“è¯¥ç‰©ä½“çš„å†…éƒ¨ï¼Œè€Œä¸æ˜¯å¤–éƒ¨ã€‚</p><blockquote><p>ç”±äºåŸæœ¬çš„ç«‹æ–¹ä½“ã€çƒä½“ã€ç‚¹å…‰æº å‡è¢«åŒ…è£¹ åœ¨ room ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¼šçœ‹åˆ° ä»–ä»¬ åœ¨ room å†…éƒ¨å„ä¸ªé¢ä¸Šçš„æŠ•å½±ã€‚</p></blockquote><blockquote><p>è¿™é‡Œæ‰€è¯´çš„ â€œè¢«åŒ…è£¹â€ å…¶å®åªä¸æ˜¯ ä»–ä»¬(ç«‹æ–¹ä½“ã€çƒä½“)å°ºå¯¸æ¯”è¾ƒå°ï¼Œä¸”ä½ç½®(ç«‹æ–¹ä½“ã€çƒä½“ã€ç‚¹å…‰æº)åæ ‡åˆšå¥½ä½äº room å†…éƒ¨è€Œå·²ã€‚</p></blockquote></li></ol><h4 id=è¡¥å……è¯´æ˜>è¡¥å……è¯´æ˜<a hidden class=anchor aria-hidden=true href=#è¡¥å……è¯´æ˜>#</a></h4><p>å°½ç®¡ room æ˜¯ 6 ä¸ªé¢ï¼Œä½†æ˜¯å®é™…æ¸²æŸ“çš„ç»“æœï¼Œæ­£å¯¹ç€ä½ è§†è§‰çš„é‚£äº›é¢æ˜¯ä¸ä¼šè¢«æ¸²æŸ“å‡ºæ¥çš„ã€‚</p><blockquote><p>è§†è§‰æ­£å¯¹ç€çš„é¢ï¼Œæœ‰å¯èƒ½æ˜¯ 1 ä¸ªï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ 2 ä¸ªã€3 ä¸ªï¼Œè¿™å®Œå…¨å–å†³äºä½ è§‚å¯Ÿçš„è§†è§‰è§’åº¦ã€‚</p></blockquote><p>å› ä¸ºå¦‚æœè¿™ä¸ªé¢ä¹Ÿè¢«æ¸²æŸ“ï¼Œé‚£ä½ å®é™…ä¸Šæ˜¯çœ‹ä¸åˆ° room å†…éƒ¨çš„ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›çš„ã€‚</p><blockquote><p>å› ä¸ºæˆ‘ä»¬ room æè´¨é‡Œè®¾å®šçš„æ˜¯ side:Three.BackSide</p></blockquote><h4 id=å…·ä½“çš„ä»£ç >å…·ä½“çš„ä»£ç <a hidden class=anchor aria-hidden=true href=#å…·ä½“çš„ä»£ç >#</a></h4><p>æˆ‘ä»¬å°†ä»£ç æ”¾ç½®äº scr/components/hello-shadow/hello-point-light-shadow.tsx</p><p>è¿™æ¬¡æˆ‘ä»¬ä»¥ èšå…‰ç¯é˜´å½±(SpotLightShadow)ç¤ºä¾‹ æ¥åšä¿®æ”¹è¯´æ˜ï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- light = new Three.DirectionalLight(0xFFFFFF, 1)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006></span><span style=color:#282828;background-color:#79740e>+ const light = new Three.PointLight(0xFFFFFF, 1)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e></span>light.castShadow = true
</span></span><span style=display:flex><span>light.position.set(0, 10, 0)
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- light.target.position.set(-4, 0, -4)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006></span>scene.add(light)
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- scene.add(light.target)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006></span>
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006>- const lightHelper = new Three.SpotLightHelper(light)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#9d0006></span><span style=color:#282828;background-color:#79740e>+ const lightHelper = new Three.PointLightHelper(light)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e></span>
</span></span><span style=display:flex><span>//æ–°å¢ room ç«‹æ–¹ä½“
</span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ const roomMat = new Three.MeshPhongMaterial({
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+   color:0xCCCCCC,
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+   side:Three.BackSide //æ³¨æ„æ­¤å¤„çš„è®¾ç½®
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ })
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ const roomGeo = new Three.BoxBufferGeometry(30,30,30)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ const roomMesh = new Three.Mesh(roomGeo,roomMat)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ roomMesh.receiveShadow = true //ä½œä¸ºèƒŒæ™¯å¢™é¢ï¼Œåªéœ€æ¥æ”¶é˜´å½±ï¼Œæ— éœ€è®¾ç½® æŠ•å°„é˜´å½±(castShadow)
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ roomMesh.position.set(0,14.9,0) //è¿™ä¸ª y å€¼ 14.9 æ˜¯æœ‰ç„æœºçš„ï¼Œç¨åè§£é‡Š
</span></span></span><span style=display:flex><span><span style=color:#282828;background-color:#79740e>+ scene.add(roomMesh)
</span></span></span></code></pre></div><p>ç¼–è¯‘è¿è¡Œï¼Œå°±å¯ä»¥çœ‹åˆ° çƒä½“ åœ¨åœ°é¢å’ŒæŸä¸ªä¾§é¢ä¸Šçš„é˜´å½±ã€‚</p><h4 id=æ³¨æ„ä¸ºä»€ä¹ˆç‰©ä½“ä¸‹æ–¹æ˜¾ç¤ºçš„é˜´å½±-æ˜¯åœ¨åœ°é¢planemeshè€Œä¸æ˜¯-roommesh-çš„åº•é¢>æ³¨æ„ï¼šä¸ºä»€ä¹ˆç‰©ä½“ä¸‹æ–¹æ˜¾ç¤ºçš„é˜´å½± æ˜¯åœ¨åœ°é¢(planeMesh)è€Œä¸æ˜¯ roomMesh çš„åº•é¢ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#æ³¨æ„ä¸ºä»€ä¹ˆç‰©ä½“ä¸‹æ–¹æ˜¾ç¤ºçš„é˜´å½±-æ˜¯åœ¨åœ°é¢planemeshè€Œä¸æ˜¯-roommesh-çš„åº•é¢>#</a></h4><p>ç©¶ç«Ÿæ˜¾ç¤º åœ°é¢è¿˜æ˜¯ room çš„åº•é¢ï¼Œè¿™ä¸ªå®Œå…¨å–å†³äº åœ°é¢(planeMesh)ã€roomMesh çš„ç›¸å¯¹ä½ç½®ï¼Œè°ä½ç½®æ›´åŠ é ä¸Šå°±æ˜¾ç¤ºè°ã€‚</p><p>ç”±äº room çš„é«˜åº¦ä¸º 30ï¼Œé«˜åº¦çš„ä¸€åŠä¸º 15ï¼Œä¸ºäº†é¿å… åœ°é¢å’Œroom çš„åº•é¢ ä¸åˆ†é«˜ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬æ•…æ„å°† roomMesh çš„ position.y çš„å€¼è®¾ç½®ä¸º 14.9ã€‚</p><p>è¿™æ ·å¯ä»¥ååˆ†æ˜ç¡® åœ°é¢ é«˜äº roomMesh çš„åº•é¢ï¼Œæ‰€ä»¥æˆ‘ä»¬çœ‹åˆ°çš„å°±æ˜¯åœ°é¢ã€‚</p><p>è‹¥å°†ä¸Šé¢çš„ä»£ç ï¼Œä¿®æ”¹ä¸ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>roomMesh.position.set(0,15.1,0)
</span></span></code></pre></div><p>æ­¤æ—¶ roomMesh åº•é¢åœ¨ åœ°é¢ ä¹‹ä¸Šï¼Œæ‰€ä»¥æ¸²æŸ“ååªä¼šçœ‹åˆ° roomMesh çš„åº•é¢ï¼Œçœ‹ä¸è§åœ°é¢äº†ã€‚</p><p><strong>åœ¨å®é™…çš„åœºæ™¯ä¸­ï¼Œç¡®å®é¿å… 2 ä¸ªé¢æåº¦ç´§è´´ï¼Œæ˜¯ä¼šé€‰æ‹©å°†å…¶ä¸­ä¸€ä¸ªé¢çš„ä½ç½®æ•…æ„è®¾ç½®åä½ä¸€äº›ï¼Œä¿è¯ Three.js èƒ½å¤Ÿæ˜ç¡®åŒºåˆ†å‡º å“ªä¸ªé¢è°åœ¨ä¸Šè°åœ¨ä¸‹ã€‚</strong></p><p>è‡³æ­¤ï¼Œå…³äºé˜´å½±æˆ‘ä»¬å°±å­¦ä¹ åˆ°æ­¤ã€‚</p><p>ä¸‹ä¸€èŠ‚å­¦ä¹ ä¸€ä¸ªç‰¹æ®Šåœºæ™¯â€”â€”é›¾ï¼Œå……æ»¡é›¾æ°”çš„åœºæ™¯ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bablvsj.github.io/tags/three.js/>Three.js</a></li></ul><nav class=paginav><a class=prev href=https://bablvsj.github.io/posts/threejs/12-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%95%9C%E5%A4%B4/><span class=title>Â« Prev</span><br><span>12 Three.jsåŸºç¡€ä¹‹é•œå¤´</span></a>
<a class=next href=https://bablvsj.github.io/posts/threejs/14-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%9B%BE/><span class=title>Next Â»</span><br><span>14 Three.jsåŸºç¡€ä¹‹é›¾</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://bablvsj.github.io>Bablvsj's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div class=flex-c-d><a class=flex-d-c href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target=_blank><span>æœ¬ç«™ç”±</span><img width=60 src=/images/upyun.png>æä¾›CDNåŠ é€Ÿ/äº‘å­˜å‚¨æœåŠ¡</a></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>