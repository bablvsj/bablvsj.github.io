<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>16 Three.jsåŸºç¡€ä¹‹è‡ªå®šä¹‰å‡ ä½•ä½“ | Bablvsj's Blog</title><meta name=keywords content="Three.js"><meta name=description content="16 Three.jsåŸºç¡€ä¹‹è‡ªå®šä¹‰å‡ ä½•ä½“ - Bablvsj's Blog"><meta name=author content><link rel=canonical href=https://bablvsj.github.io/posts/threejs/16-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%A0%E4%BD%95%E4%BD%93/><link crossorigin=anonymous href=/assets/css/stylesheet.241265d51339977eb0f90d05780e286ec2789600ca4137f29552dec9dee06569.css integrity="sha256-JBJl1RM5l36w+Q0FeA4obsJ4lgDKQTfylVLeyd7gZWk=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://bablvsj.github.io/img/Q.gif><link rel=apple-touch-icon href=https://bablvsj.github.io/Q.gif><link rel=mask-icon href=https://bablvsj.github.io/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=/css/syntax.css><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="16 Three.jsåŸºç¡€ä¹‹è‡ªå®šä¹‰å‡ ä½•ä½“"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://bablvsj.github.io/posts/threejs/16-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%A0%E4%BD%95%E4%BD%93/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-19T17:11:35+08:00"><meta property="article:modified_time" content="2023-12-19T17:11:35+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="16 Three.jsåŸºç¡€ä¹‹è‡ªå®šä¹‰å‡ ä½•ä½“"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"æ–‡ç« ","item":"https://bablvsj.github.io/posts/"},{"@type":"ListItem","position":3,"name":"16 Three.jsåŸºç¡€ä¹‹è‡ªå®šä¹‰å‡ ä½•ä½“","item":"https://bablvsj.github.io/posts/threejs/16-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%A0%E4%BD%95%E4%BD%93/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"16 Three.jsåŸºç¡€ä¹‹è‡ªå®šä¹‰å‡ ä½•ä½“","name":"16 Three.jsåŸºç¡€ä¹‹è‡ªå®šä¹‰å‡ ä½•ä½“","description":"","keywords":["Three.js"],"articleBody":"é‡è¦è¯´æ˜ï¼šæœ¬æ–‡éƒ¨åˆ†å†…å®¹å·²ç»è¿‡æ—¶\n.ä»¥ä¸‹å†…å®¹æ›´æ–°äº2021å¹´4æœˆ15æ—¥\næœ¬æ–‡å†™çš„æ—¶å€™è¿˜ä½¿ç”¨çš„æ˜¯ 0.124.0ç‰ˆæœ¬ï¼Œä½†æ˜¯åœ¨ 0.125.2 ä»¥åï¼ˆç›®å‰æœ€æ–°çš„æ˜¯ 0.127.0 ï¼‰ï¼Œå…³äº å‡ ä½•ä½“ å®˜æ–¹åšäº†é‡å¤§è°ƒæ•´ï¼š\nå®˜æ–¹å·²ç»å°† Geometry ä»æ ¸å¿ƒåº“ä¸­ç§»é™¤ï¼Œæ–°çš„ä½ç½®æ”¹ä¸ºï¼š\nimport { Geometry } from 'three/examples/jsm/deprecated/Geometry' è¯·æ³¨æ„ ç›®å½•åä¸º deprecatedï¼Œè¿™ä¸ªå•è¯çš„æ„æ€å°±æ˜¯ï¼šå·²å¼ƒç”¨ã€ä¸å»ºè®®ä½¿ç”¨ã€‚\nä¹Ÿå°±æ˜¯è¯´å®˜æ–¹å·²ç»ä¸å†å»ºè®®ä½ ä½¿ç”¨ Geometry è¿™ä¸ªç±»äº†ï¼Œé‚£å®ƒçš„æ›¿ä»£è€…æ˜¯è°å‘¢ï¼Ÿ\nåœ¨ r124 ç‰ˆæœ¬çš„æ—¶å€™ï¼Œå‡ ä½•ä½“(ä¾‹å¦‚ BoxGeometry) ä»–ä»¬éƒ½ç»§æ‰¿çš„æ˜¯ Geometryï¼Œä½†æ˜¯åœ¨æ–°ç‰ˆæœ¬ä¸­å®ƒä»¬ç»§æ‰¿çš„æ˜¯ BufferGeometryã€‚\nä¹Ÿå°±æ˜¯è¯´å¦‚æœä½ æƒ³è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Œç°åœ¨åº”è¯¥ä½¿ç”¨çš„æ˜¯ BufferGeometry\nThree.BufferGeometry\næ¢å¥è¯è¯´ï¼Œå°±æ˜¯ BufferGeometry æ›¿ä»£äº† Geometry\nThree.Mesh() å‡½æ•°ä¸­çš„å‚æ•°ä¹Ÿå‘ç”Ÿäº†å˜åŒ–\næˆ–è®¸è¿˜æœ‰å…¶ä»–æ›´å¤šåœ°æ–¹å‘ç”Ÿäº†å˜åŒ–â€¦\næœ¬æ–‡åœ¨ç¼–å†™çš„æ—¶å€™ï¼Œè¿˜é‡‡ç”¨çš„æ˜¯ Geometryï¼Œæ‰€ä»¥æœ¬æ–‡å†…å®¹è¿‡æ—¶äº†ã€‚\nç›®å‰å…ˆæš‚ä¸”ä¸åšä¿®æ”¹ï¼Œç­‰åˆ°ä»¥åæœ‰æ—¶é—´äº†å†å°†æœ¬æ–‡ä¸­çš„ä»£ç  Geometry ä¿®æ”¹ä¸º BufferGeometryã€‚\nä½ å¯ä»¥å…ˆè·³è¿‡æœ¬ç« ï¼Œç»§ç»­åé¢ç« èŠ‚çš„å­¦ä¹ ã€‚\nä»¥ä¸‹å†…å®¹æ›´æ–°äº2021å¹´4æœˆ15æ—¥\næ¥ä¸‹æ¥å¼€å§‹æœ¬æ–‡(å·²è¿‡æ—¶)çš„å†…å®¹ã€‚\næœ¬æ–‡è¯´çš„ å‡ ä½•ä½“(geometry)ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰ â€œ05 Three.jsåŸºç¡€ä¹‹å›¾å…ƒ.mdâ€ ä¸­çš„ å›¾å…ƒ(primitives)ã€‚\nå›¾å…ƒå’Œå‡ ä½•ä½“åªæ˜¯åŒä¸€ä¸ªå¯¹è±¡(äº‹ç‰©)çš„ä¸åŒçš„å«æ³•è€Œå·²ã€‚\nè‡ªå®šä¹‰å‡ ä½•ä½“ä¹Ÿå°±ç›¸å½“äºè‡ªå®šä¹‰å›¾å…ƒã€‚\nè‡ªå®šä¹‰å‡ ä½•ä½“çš„è¿™ä¸ªè¿‡ç¨‹ï¼Œåœ¨ä¼ ç»Ÿ 3D è½¯ä»¶ä¸­è¢«ç§°ä¸º å»ºæ¨¡\nè‡ªå®šä¹‰å‡ ä½•ä½“(custom geometry)æ¦‚è¿° å…ˆæ¥ä¸€ä¸ªçµé­‚æ‹·é—®ã€‚\næœ‰å¿…è¦åœ¨ Three.js ä¸­è‡ªå®šä¹‰å‡ ä½•ä½“å—ï¼Ÿ ç­”ï¼šä¼¼ä¹æ²¡æœ‰å¿…è¦ï¼Œå› ä¸ºå®é™…é¡¹ç›®ä¸­ï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šé€šè¿‡ä¸“ä¸šçš„ 3D è½¯ä»¶ä¸­æ¥åˆ›å»ºç‰©ä½“æ¨¡å‹(å»ºæ¨¡)ï¼Œè€Œä¸æ˜¯é€šè¿‡ Three.js è‡ªå®šä¹‰å»ºæ¨¡ã€‚\nä¼ ç»Ÿä¸“ä¸šçš„ 3D è½¬ä»¶åŒ…æ‹¬ï¼š\nBlenderï¼šå¼€æºå…è´¹çš„ 3D è½¯ä»¶ Mayaï¼šä¾§é‡åŠ¨ç”»æ¸²æŸ“çš„ 3D è½¯ä»¶ Cinema4D(C4D)ï¼šè½»é‡çº§çš„ 3D è½¯ä»¶ 3D Sudio Max â€¦ ä»¥ä¸Šè½¯ä»¶ä¸­ï¼Œéƒ½æœ‰å­¦ä¹ æˆæœ¬ï¼Œç›¸å¯¹è€Œè¨€ C4D æ›´åŠ è½»é‡ã€æ›´åŠ ç®€å•ã€‚\nå½“ 3D æ¨¡å‹åˆ›å»ºå¥½åï¼Œæˆ‘ä»¬å°†æ¨¡å‹å¯¼å‡ºä¸º gLTF æˆ– .obj çš„æ–‡ä»¶ï¼Œç„¶ååœ¨ Three.js ä¸­åŠ è½½å¹¶ä½¿ç”¨å®ƒä»¬ã€‚\nå°½ç®¡å¦‚æ­¤ï¼Œä½† Three.js ä¾ç„¶æä¾›äº†è‡ªå®šä¹‰å‡ ä½•ä½“(è‡ªå®šä¹‰å»ºæ¨¡)çš„æ–¹æ³•ã€‚\nå¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸å¯¼å…¥ å»ºæ¨¡æ–‡ä»¶ çš„å‰æä¸‹ï¼Œé€šè¿‡ Three.js æ¥è‡ªå®šä¹‰å‡ ä½•ä½“ã€‚\næ‰€æœ‰çš„ä¼ ç»Ÿ 3D è½¯ä»¶å»ºæ¨¡è¿‡ç¨‹éƒ½æ˜¯å¯è§†åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¯ä»¥æ—¶æ—¶çœ‹åˆ°ç‰©ä½“ï¼Œå¹¶ä¸”è¿›è¡Œç»†å¾®è°ƒæ•´ã€‚è€Œ Three.js åˆ™æ˜¯é€šè¿‡ä»£ç æ¥å»ºæ¨¡çš„ï¼Œæ•´ä¸ªå»ºæ¨¡è¿‡ç¨‹æ˜¯ä¸å¯è§çš„ã€‚\nå°½ç®¡å®é™…ä¸­æˆ‘ä»¬å¯èƒ½ä¼šå¾ˆå°‘æœºä¼šåœ¨ Three.js ä¸­è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Œä½†æ˜¯å­¦ä¹ è¿™æ–¹é¢çš„çŸ¥è¯†è¿˜æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚\nThree.jsä¸­å¦‚ä½•è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Ÿ ç­”ï¼šåœ¨ Three.js ä¸­ï¼Œä¸€å…±å¯ä»¥æœ‰ 2 ç§æ–¹å¼è‡ªå®šä¹‰å‡ ä½•ä½“ã€‚\nç¬¬1ç§ï¼šç»§æ‰¿äº Geometry\nä¼˜ç‚¹ï¼šåˆ›å»ºå’Œä½¿ç”¨çš„éš¾åº¦å°\nç¼ºç‚¹ï¼šæ¸²æŸ“å¯åŠ¨é€Ÿåº¦æ…¢ã€å æ›´å¤šå†…å­˜\nç¬¬2ç§ï¼šç»§æ‰¿äº BufferGeometry\nä¼˜ç‚¹ï¼šæ¸²æŸ“å¯åŠ¨é€Ÿåº¦å¿«ã€å æ›´å°‘å†…å­˜\nç¼ºç‚¹ï¼šåˆ›å»ºå’Œä½¿ç”¨çš„éš¾åº¦å¤§\nè¡¥å……è¯´æ˜ï¼š\nä¸Šé¢è¯´çš„ æ¸²æŸ“å¯åŠ¨é€Ÿåº¦ æ…¢ï¼Œæ˜¯æŒ‡å½“åœºæ™¯ç¬¬ä¸€æ¬¡è¢«æ¸²æŸ“ã€åç»­ä¿®æ”¹åé‡æ–°æ¸²æŸ“çš„é€Ÿåº¦æ…¢ã€‚\nå¹¶ä¸æ˜¯è¯´ ç»˜åˆ¶é€Ÿåº¦æ…¢ã€‚\næ— è®ºé€‰æ‹© Geometry è¿˜æ˜¯ BufferGeometryï¼Œç»˜åˆ¶è¿‡ç¨‹é€Ÿåº¦æ˜¯ç›¸åŒçš„ï¼Œä»–ä»¬çš„ â€œå¿«æ…¢â€ ä¸»è¦ä½“ç°åœ¨ ç¬¬ä¸€æ¬¡æ¸²æŸ“å¯åŠ¨é€Ÿåº¦ è¿™æ–¹é¢ã€‚\nå½“ç„¶ï¼Œä½ ä¸éœ€èŠ±å¤ªå¤šç²¾åŠ›å»ç†è§£ æ…¢ çš„ç»†èŠ‚ï¼Œä½ åªéœ€çŸ¥é“ Geometry ç›¸å¯¹è€Œè¨€ æ¸²æŸ“é€Ÿåº¦æ›´æ…¢ä¸€äº›å³å¯ã€‚\nå¦‚ä½•é€‰æ‹©ï¼Ÿ\nç­”ï¼šå¯¹äºè¦åˆ›å»ºçš„è‡ªå®šä¹‰å‡ ä½•ä½“å„ä¸ªé¢çš„ä¸‰è§’å½¢æ€»å’Œå°äº 1000ï¼Œåˆ™ä¼˜å…ˆé€‰æ‹©ç»§æ‰¿äº Geometryã€‚ä¸‰è§’å½¢æ•°é‡è¶…è¿‡è¿™ä¸ªèŒƒå›´çš„åˆ™æ¨èç»§æ‰¿äº BufferGeometryã€‚\näº‹å®ä¸Šä»¥ä¸Šçš„é€‰æ‹©ä»…ä¾›å‚è€ƒï¼Œé‡ç‚¹æ˜¯ä½ å®é™…é¡¹ç›®ä¸­ æ˜¯å¦è§‰å¾—æ¸²æŸ“å¯åŠ¨é€Ÿåº¦ã€ä¿®æ”¹å“åº”é€Ÿåº¦æ…¢ï¼Œå¦‚æœæ…¢åˆ™å¯è¿›è¡Œä¼˜åŒ–æ”¹è¿›ã€‚\nå¦‚æœç”±äºå®¢æˆ·ç«¯ç¡¬ä»¶é…ç½®æ¯”è¾ƒé«˜ï¼Œæ„ŸçŸ¥ä¸åˆ°æ…¢æˆ–å¡é¡¿ï¼Œé‚£ä¹ˆå¯ä»¥è€Œç»§ç»­ä½¿ç”¨ Geometryã€‚\nè‡ªå®šä¹‰å‡ ä½•ä½“ç¤ºä¾‹ï¼šHelloCustomGeometry ç¤ºä¾‹ç›®æ ‡ é€šè¿‡è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Œæ¥å®ç°ä¸€ä¸ª ç«‹æ–¹ä½“ è‡ªå®šä¹‰ ç«‹æ–¹ä½“ 6 ä¸ªé¢çš„é¢œè‰² è‡ªå®šä¹‰ ç«‹æ–¹ä½“ 8 ä¸ªé¡¶ç‚¹çš„é¢œè‰² ç»™ ç«‹æ–¹ä½“ æ·»åŠ  å…‰ç…§æ³•çº¿ï¼Œè®©ç«‹æ–¹ä½“å¯ä»¥åå…‰ ä»£ç æ€è·¯ å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªç«‹æ–¹ä½“ï¼Ÿ\nç­”ï¼šä¸»è¦åˆ†ä¸º 3 æ­¥\nç¬¬1æ­¥ï¼šå®ä¾‹åŒ–ä¸€ä¸ª Three.Geometry\nconst geometry = new Three.Geometry() ç¬¬2æ­¥ï¼šæŒ‰ç…§ç«‹æ–¹ä½“ç›¸åº”çš„åæ ‡ï¼Œæ·»åŠ  8 ä¸ªé¡¶ç‚¹\ngeometry.vertices.push( new Three.Vector3(-1, -1, 1), // 1 new Three.Vector3(1, -1, 1), // 2 new Three.Vector3(-1, 1, 1), // 3 new Three.Vector3(1, 1, 1), // 4 new Three.Vector3(-1, -1, -1), // 5 new Three.Vector3(1, -1, -1), // 6 new Three.Vector3(-1, 1, -1), // 7 new Three.Vector3(1, 1, -1) // 8 ) ç¬¬3æ­¥ï¼šå°†ç›¸é‚»çš„ 3 ä¸ªé¡¶ç‚¹ï¼Œä¾æ¬¡æŒ‰ç…§é€†æ—¶é’ˆé¡ºåºï¼Œæ„å»ºæˆä¸€ä¸ªä¸ªä¸‰è§’å½¢ã€‚\nç«‹æ–¹ä½“ä¸€å…±æœ‰ 6 ä¸ªé¢ï¼Œæ¯ä¸ªé¢ç”± 2 ä¸ªä¸‰è§’å½¢æ„æˆï¼Œå› æ­¤ä¸€å…±éœ€è¦æ„å»º 12 ä¸ªä¸‰è§’å½¢\nä¸ºä»€ä¹ˆå¿…é¡»æ˜¯é€†æ—¶é’ˆï¼Ÿè¿™æ˜¯ Three.js è§„å®šçš„ã€‚\ngeometry.faces.push( //å‰é¢ new Three.Face3(0, 3, 2), new Three.Face3(0, 1, 3), //å³é¢ new Three.Face3(1, 7, 3), new Three.Face3(1, 5, 7), //åé¢ new Three.Face3(5, 6, 7), new Three.Face3(5, 4, 6), //å·¦é¢ new Three.Face3(4, 2, 6), new Three.Face3(4, 0, 2), //é¡¶é¢ new Three.Face3(2, 7, 6), new Three.Face3(2, 3, 7), //åº•é¢ new Three.Face3(4, 1, 0), new Three.Face3(4, 5, 1) ) è‡³æ­¤ï¼Œå°±ä»¥æˆåŠŸæ„å»ºå‡ºä¸€ä¸ªç«‹æ–¹ä½“çš„åŸºæœ¬éª¨æ¶ã€‚\nå¦‚ä½•è‡ªå®šä¹‰ 6 ä¸ªé¢çš„é¢œè‰²é¢ï¼Ÿ\ngeometry.faces[0].color = geometry.faces[1].color = new Three.Color('red') geometry.faces[2].color = geometry.faces[3].color = new Three.Color('yello') geometry.faces[4].color = geometry.faces[5].color = new Three.Color('green') geometry.faces[6].color = geometry.faces[7].color = new Three.Color('cyan') geometry.faces[8].color = geometry.faces[9].color = new Three.Color('blue') geometry.faces[10].color = geometry.faces[11].color = new Three.Color('magenta') å¦‚ä½•è‡ªå®šä¹‰ 8 ä¸ªé¡¶ç‚¹çš„é¢œè‰²ï¼Ÿ\ngeometry.faces.forEach((face, index) =\u003e { face.vertexColors = [ (new Three.Color()).setHSL(index / 12, 1, 0.5), (new Three.Color()).setHSL(index / 12 + 0.1, 1, 0.5), (new Three.Color()).setHSL(index / 12 + 0.2, 1, 0.5) ] }) å¦‚ä½•å¼€å¯é¡¶ç‚¹ç€è‰²ï¼Ÿ\nconst material = new THREE.MeshBasicMaterial({vertexColors: true}) const material = new Three.MeshPhongMaterial({ vertexColors: true }) vertexColors é»˜è®¤å€¼ä¸º falseï¼Œå³é»˜è®¤æ˜¾ç¤ºæè´¨ color çš„é¢œè‰²ã€‚\nå¦‚æœæ²¡æœ‰ç»™æè´¨è®¾ç½® color å€¼ï¼Œé‚£ä¹ˆé»˜è®¤é¢œè‰²å€¼ä¸º ç™½è‰²\nç‰¹åˆ«è¯´æ˜ï¼Œåœ¨ Three.js ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼ŒvertexColors çš„å€¼å¹¶ä¸æ˜¯ Booleanï¼Œè€Œæ˜¯è¿›è¡Œä»¥ä¸‹è®¾ç½®ï¼š\n//export enum Colors {} //export const NoColors: Colors; //export const FaceColors: Colors; //export const VertexColors: Colors; const material = new THREE.MeshBasicMaterial({vertexColors: THREE.FaceColors}); åœ¨ç›®å‰æ¯”è¾ƒæ–°çš„ç‰ˆæœ¬ä¸­ï¼ŒvertexColors çš„å€¼æ”¹ä¸º Boolean ç±»å‹ã€‚\nå¦‚ä½•æ·»åŠ å…‰ç…§æ³•çº¿ï¼Ÿ\nç­”ï¼šä¸€å…±æœ‰ 3 ç§æ–¹å¼\nç»™æ¯ä¸€ä¸ª face è®¾ç½® normal å±æ€§å€¼\nface.normal = new Three.Vector3(...) é€šè¿‡ vertexNormals å±æ€§æ¥è®¾ç½®\nface.vertexNormals = { new Three.Vector3(...), new Three.Vector3(...), ... new Three.Vector3(...) } é€šè¿‡ computeFaceNormals() å’Œ computeVertexNormals() è¿™ 2 ä¸ªæ–¹æ³•è‡ªåŠ¨å¸®æˆ‘ä»¬è®¡ç®—å‡ºå…‰ç…§æ³•çº¿ã€‚\nä½†æ˜¯å¯¹äºç«‹æ–¹ä½“è€Œè¨€ï¼Œåªæ‰§è¡Œ computeFaceNormals() æ–¹æ³•å³å¯ã€‚\ngeometry.computeFaceNormals() //geometry.computeVertexNormals() // è¿™ä¸ªæ–¹æ³•å¹¶ä¸é€‚ç”¨äºç«‹æ–¹ä½“ ç¬¬ 3 ç§ æ–¹æ³•æœ€ä¸ºç®€ä¾¿ï¼Œä¹Ÿæ¯”è¾ƒå¸¸ç”¨ã€‚\næœ¬ç¤ºä¾‹å°±é‡‡ç”¨ç¬¬ 3 ç§æ–¹å¼ã€‚\nè¡¥å……è¯´æ˜ï¼šcomputeVertexNormals() ä¸ºä»€ä¹ˆä¸é€‚ç”¨äºç«‹æ–¹ä½“ï¼Ÿ\nç­”ï¼šå› ä¸º computeVertexNormals() ä¼šä»æ¯ä¸ªé¡¶ç‚¹å…±äº«çš„æ‰€æœ‰é¢çš„æ³•çº¿ä¸­è®¡ç®—å¾—å‡ºæ³•çº¿ï¼Œè¿™æ ·çš„å‘ç°ä¼šè®©ç«‹æ–¹ä½“çš„é¡¶ç‚¹çœ‹ä¸Šå»æ›´åƒä¸€ä¸ªçƒä½“ã€‚\nå¦‚æœä½ æ‰§è¡Œäº† computeVertexNormals()ï¼Œå¹¶ä¸ä¼šæŠ¥é”™ï¼Œä»…ä»…æ˜¯ç«‹æ–¹ä½“é¡¶ç‚¹å¤„çœ‹ä¼¼æ›´åŠ åœ†æ¶¦ï¼Œåƒçƒä¸€æ ·ã€‚\nä»£ç ç¤ºä¾‹ import { useEffect, useRef } from 'react' import * as Three from 'three' import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls' import './index.scss' const HelloCustomGeometry = () =\u003e { const canvasRef = useRef(null) useEffect(() =\u003e { if (canvasRef.current === null) { return } const renderer = new Three.WebGLRenderer({ canvas: canvasRef.current }) const scene = new Three.Scene() const camera = new Three.PerspectiveCamera(45, 2, 0.1, 100) camera.position.z = 8 const light = new Three.DirectionalLight(0xFFFFFF, 1) light.position.set(2, 2, 4) scene.add(light) const helper = new Three.DirectionalLightHelper(light) scene.add(helper) const controls = new OrbitControls(camera, canvasRef.current) controls.update() //è‡ªå®šä¹‰ä¸€ä¸ªç«‹æ–¹ä½“å‡ ä½•ä½“ const geometry = new Three.Geometry() geometry.vertices.push( new Three.Vector3(-1, -1, 1), // 1 new Three.Vector3(1, -1, 1), // 2 new Three.Vector3(-1, 1, 1), // 3 new Three.Vector3(1, 1, 1), // 4 new Three.Vector3(-1, -1, -1), // 5 new Three.Vector3(1, -1, -1), // 6 new Three.Vector3(-1, 1, -1), // 7 new Three.Vector3(1, 1, -1) // 8 ) geometry.faces.push( //å‰é¢ new Three.Face3(0, 3, 2), new Three.Face3(0, 1, 3), //å³é¢ new Three.Face3(1, 7, 3), new Three.Face3(1, 5, 7), //åé¢ new Three.Face3(5, 6, 7), new Three.Face3(5, 4, 6), //å·¦é¢ new Three.Face3(4, 2, 6), new Three.Face3(4, 0, 2), //é¡¶é¢ new Three.Face3(2, 7, 6), new Three.Face3(2, 3, 7), //åº•é¢ new Three.Face3(4, 1, 0), new Three.Face3(4, 5, 1) ) geometry.faces[0].color = geometry.faces[1].color = new Three.Color('red') geometry.faces[2].color = geometry.faces[3].color = new Three.Color('yello') geometry.faces[4].color = geometry.faces[5].color = new Three.Color('green') geometry.faces[6].color = geometry.faces[7].color = new Three.Color('cyan') geometry.faces[8].color = geometry.faces[9].color = new Three.Color('blue') geometry.faces[10].color = geometry.faces[11].color = new Three.Color('magenta') geometry.faces.forEach((face, index) =\u003e { face.vertexColors = [ (new Three.Color()).setHSL(index / 12, 1, 0.5), (new Three.Color()).setHSL(index / 12 + 0.1, 1, 0.5), (new Three.Color()).setHSL(index / 12 + 0.2, 1, 0.5) ] }) geometry.computeFaceNormals() //geometry.computeVertexNormals() //å¯¹äºç«‹æ–¹ä½“è€Œè¨€ï¼Œæ— éœ€æ‰§è¡Œæ­¤æ–¹æ³• //const material = new Three.MeshBasicMaterial({ color: 'red' }) const material = new Three.MeshPhongMaterial({ vertexColors: true }) //const material = new Three.MeshPhongMaterial({ color: 'red' }) const cube = new Three.Mesh(geometry, material) scene.add(cube) const render = (time: number) =\u003e { cube.rotation.x = cube.rotation.y = time * 0.001 renderer.render(scene, camera) window.requestAnimationFrame(render) } window.requestAnimationFrame(render) const handleResize = () =\u003e { if (canvasRef.current === null) { return } const width = canvasRef.current.clientWidth const height = canvasRef.current.clientHeight camera.aspect = width / height camera.updateProjectionMatrix() renderer.setSize(width, height, false) } handleResize() window.addEventListener('resize', handleResize) return () =\u003e { window.removeEventListener('resize', handleResize) } }, [canvasRef]) return ( ) } export default HelloCustomGeometry å®é™…è¿è¡Œåï¼Œå°±ä¼šçœ‹åˆ°ä¸€ä¸ª ç‚«å½©çš„ç«‹æ–¹ä½“ã€‚\næœ¬æ–‡å°ç»“ é€šè¿‡è‡ªå®šä¹‰ä¸€ä¸ªç«‹æ–¹ä½“çš„ç¤ºä¾‹ï¼Œå¯ä»¥çœ‹å‡ºï¼Œå°½ç®¡æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç«‹æ–¹ä½“ï¼Œå¯æˆ‘ä»¬éƒ½éœ€è¦éå¸¸å¤æ‚çš„ç©ºé—´åæ ‡è®¡ç®—é…ç½®ï¼Œå› æ­¤è¿˜æ˜¯æœ¬æ–‡å¼€å¤´é‚£æ®µè¯ï¼š\nå¦‚éå¿…è¦ï¼Œä¸è¦åœ¨ Three.js ä¸­è‡ªå®šä¹‰å‡ ä½•ä½“ã€‚ ä½¿ç”¨ä¼ ç»Ÿçš„ 3D è½¯ä»¶å»ºæ¨¡ï¼Œæ›´é¦™ã€‚ è¡¥å……è¯´æ˜ æœ¬ç³»åˆ—æ•™ç¨‹ï¼Œå®é™…ä¸Šæ˜¯æˆ‘ä¸€è¾¹å­¦ä¹  https://threejsfundamentals.org/threejs/lessons/ ï¼Œä¸€è¾¹ä½¿ç”¨ React + TypeScript + è‡ªå·±çš„è¯­è¨€å’Œç†è§£ é‡å†™ä¸€éçš„ã€‚\næœ¬æ–‡å¯¹åº”çš„è‹±æ–‡æ•™ç¨‹ä¸ºï¼šhttps://threejsfundamentals.org/threejs/lessons/threejs-custom-geometry.html\nåœ¨åŸç‰ˆçš„è‹±æ–‡æ•™ç¨‹ä¸­ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ª é€šè¿‡ä¸€å¼ å›¾ç‰‡æ¥è·å¾— çº¹ç†åæ ‡(UV)ï¼Œè¿›è€Œç”Ÿæˆä¸€å¼ åœ°å›¾çš„ä¾‹å­ã€‚\næˆ‘ä¸ªäººæ„Ÿè§‰æ²¡æœ‰å¿…è¦å»è¿™ä¹ˆæ·±å…¥å­¦ä¹ è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Œæ‰€ä»¥æœ¬æ–‡ç•¥è¿‡è¿™ä¸ªç¤ºä¾‹ã€‚\né™¤æ­¤ä¹‹å¤–ï¼Œå®˜æ–¹è¿˜æœ‰å•ç‹¬ä¸€ç¯‡ï¼Œä½¿ç”¨ BufferGeometry æ¥è‡ªå®šä¹‰å‡ ä½•ä½“çš„æ•™ç¨‹ï¼š\nhttps://threejsfundamentals.org/threejs/lessons/threejs-custom-buffergeometry.html\næˆ‘è®¤ä¸ºç°é˜¶æ®µï¼Œæ²¡æœ‰å¿…è¦å¦‚æ­¤è¿™èˆ¬çš„æ·±å…¥å»å­¦ä¹ è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Œå› ä¸ºæš‚åœè¿™éƒ¨åˆ†çš„å­¦ä¹ ã€‚\nå¦‚æœä½ è¿˜æœ‰ç²¾åŠ›ï¼Œå¯ä»¥å»å­¦ä¹ ä¸€ä¸‹ã€‚\nThree.jsåŸºç¡€çŸ¥è¯†æ€»ç»“ é€šè¿‡å‰é¢ä¸€ç³»åˆ—çš„å­¦ä¹ ï¼Œæˆ‘ä»¬ç»ˆäºå°† Three.js åŸºç¡€çŸ¥è¯†å­¦ä¹ å®Œæˆã€‚\nå›é¡¾ä¸€ä¸‹æˆ‘ä»¬éƒ½å­¦ä¹ äº†å“ªäº›çŸ¥è¯†ç‚¹ï¼š\nThree.js ç®€ä»‹ã€é¡¹ç›®åˆå§‹åŒ–ã€å…¥é—¨ç¤ºä¾‹ å›¾å…ƒã€3Dæ–‡å­—ã€åœºæ™¯ã€æè´¨ã€çº¹ç†ã€ç¯å…‰ã€é•œå¤´ã€é˜´å½±ã€é›¾ã€ç¦»å±æ¸²æŸ“ã€è‡ªå®šä¹‰å‡ ä½•ä½“ è¾…åŠ©å¯¹è±¡(ç¯å…‰è¾…åŠ©å¯¹è±¡ LightHelper ã€é•œå¤´è¾…åŠ©å¯¹è±¡ XxxxCameraHelperã€åæ ‡è½´è¾…åŠ©å¯¹è±¡ AxesHelper)ã€é•œå¤´è½¨é“æ§åˆ¶ç±»(OrbitControls) çœŸå¿ƒä¸å®¹æ˜“ï¼Œç»™è‡ªå·±ä¸€æœµå°çº¢èŠ±ï¼\nâ€¦\næˆ‘ä»¬æœ¬ç³»åˆ—æ•™ç¨‹æ•´ä½“çš„è§„åˆ’æ˜¯ï¼š\nåŸºç¡€ç¯‡ (âœ“) æŠ€å·§ç¯‡ (x) ä¼˜åŒ–ç¯‡ (x) è§£å†³æ–¹æ¡ˆ (x) WebVR (x) å®ä¾‹ç¯‡ (x) ç›®å‰æˆ‘ä»¬å·²ç»å­¦ä¹ äº†åŸºç¡€ç¯‡ï¼Œå¯¹ Three.js å·²ç»æœ‰äº†è¶³å¤Ÿçš„åŸºç¡€çŸ¥è¯†æŒæ¡ï¼Œåé¢çš„å­¦ä¹ éƒ½æ˜¯å»ºç«‹åœ¨è¿™äº›åŸºç¡€çŸ¥è¯†ä¹‹ä¸Šçš„ã€‚\næ¥ä¸‹æ¥ï¼Œè¿›å…¥æŠ€å·§ç¯‡â€”â€”æŒ‰éœ€æ¸²æŸ“ã€‚\nç¨ç­‰ï¼Œå†å•°å—¦å‡ å¥ æˆ‘ä»¬åç»­çš„è®²è§£æ–‡ç« ä¸­ï¼Œå°†åŠ å¿«è¿›åº¦ï¼Œä¸å†åƒ åŸºç¡€ç¯‡ è¿™æ ·å¦‚æ­¤ç»†è‡´ï¼Œç”šè‡³æ˜¯å•°å—¦ã€‚\nå› æ­¤ï¼Œæˆ‘å¸Œæœ›ä½ ä¸çœ‹æ•™ç¨‹ç¤ºä¾‹ä»£ç ï¼Œè€Œæ˜¯è‡ªå·±ç‹¬ç«‹æ•²å‡ºç¤ºä¾‹ä»£ç ã€‚å¦‚æœåšä¸åˆ°ï¼Œé‚£ä¹ˆä½ å…ˆä¸è¦ç€æ€¥è¿›å…¥ä¸‹ä¸€ç¯‡ï¼Œè€Œæ˜¯åº”è¯¥å†å›è¿‡å¤´ï¼Œåå¤é˜…è¯»ï¼Œåå¤æ•²å‡ éä»£ç ã€‚\nåœ¨åš(åŠ¨æ‰‹æ•²ä»£ç )çš„è¿‡ç¨‹ä¸­å­¦ä¹ ï¼Œè€Œä¸æ˜¯åªçœ‹ä¸åŠ¨æ‰‹ã€‚\n","wordCount":"3629","inLanguage":"en","datePublished":"2023-12-19T17:11:35+08:00","dateModified":"2023-12-19T17:11:35+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://bablvsj.github.io/posts/threejs/16-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%A0%E4%BD%95%E4%BD%93/"},"publisher":{"@type":"Organization","name":"Bablvsj's Blog","logo":{"@type":"ImageObject","url":"https://bablvsj.github.io/img/Q.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bablvsj.github.io accesskey=h title="Bablvsj's Blog (Alt + H)">Bablvsj's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bablvsj.github.io/ title=ä¸»é¡µ><span>ä¸»é¡µ</span></a></li><li><a href=https://bablvsj.github.io/archives/ title=æ—¶é—´è½´><span>æ—¶é—´è½´</span></a></li><li><a href=https://bablvsj.github.io/tags title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://bablvsj.github.io/about title=å…³äº><span>å…³äº</span></a></li><li><a href=https://bablvsj.github.io/search title="ğŸ” (Alt + /)" accesskey=/><span>ğŸ”</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>16 Three.jsåŸºç¡€ä¹‹è‡ªå®šä¹‰å‡ ä½•ä½“</h1><div class=post-meta><div class=post-tags-meta><a href=https://bablvsj.github.io/tags/three.js/>Three.js</a></div>8 min&nbsp;Â·&nbsp;<span title='2023-12-19 17:11:35 +0800 +0800'>2023/12/19</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><div class=inner><ul><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%87%a0%e4%bd%95%e4%bd%93custom-geometry%e6%a6%82%e8%bf%b0 aria-label="è‡ªå®šä¹‰å‡ ä½•ä½“(custom geometry)æ¦‚è¿°">è‡ªå®šä¹‰å‡ ä½•ä½“(custom geometry)æ¦‚è¿°</a><ul><li><a href=#%e6%9c%89%e5%bf%85%e8%a6%81%e5%9c%a8-threejs-%e4%b8%ad%e8%87%aa%e5%ae%9a%e4%b9%89%e5%87%a0%e4%bd%95%e4%bd%93%e5%90%97 aria-label="æœ‰å¿…è¦åœ¨ Three.js ä¸­è‡ªå®šä¹‰å‡ ä½•ä½“å—ï¼Ÿ">æœ‰å¿…è¦åœ¨ Three.js ä¸­è‡ªå®šä¹‰å‡ ä½•ä½“å—ï¼Ÿ</a></li><li><a href=#threejs%e4%b8%ad%e5%a6%82%e4%bd%95%e8%87%aa%e5%ae%9a%e4%b9%89%e5%87%a0%e4%bd%95%e4%bd%93 aria-label=Three.jsä¸­å¦‚ä½•è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Ÿ>Three.jsä¸­å¦‚ä½•è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Ÿ</a></li></ul></li><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%87%a0%e4%bd%95%e4%bd%93%e7%a4%ba%e4%be%8bhellocustomgeometry aria-label=è‡ªå®šä¹‰å‡ ä½•ä½“ç¤ºä¾‹ï¼šHelloCustomGeometry>è‡ªå®šä¹‰å‡ ä½•ä½“ç¤ºä¾‹ï¼šHelloCustomGeometry</a><ul><ul><li><a href=#%e7%a4%ba%e4%be%8b%e7%9b%ae%e6%a0%87 aria-label=ç¤ºä¾‹ç›®æ ‡>ç¤ºä¾‹ç›®æ ‡</a></li><li><a href=#%e4%bb%a3%e7%a0%81%e6%80%9d%e8%b7%af aria-label=ä»£ç æ€è·¯>ä»£ç æ€è·¯</a></li><li><a href=#%e4%bb%a3%e7%a0%81%e7%a4%ba%e4%be%8b aria-label=ä»£ç ç¤ºä¾‹>ä»£ç ç¤ºä¾‹</a></li><li><a href=#%e6%9c%ac%e6%96%87%e5%b0%8f%e7%bb%93 aria-label=æœ¬æ–‡å°ç»“>æœ¬æ–‡å°ç»“</a></li><li><a href=#%e8%a1%a5%e5%85%85%e8%af%b4%e6%98%8e aria-label=è¡¥å……è¯´æ˜>è¡¥å……è¯´æ˜</a></li></ul></ul></li><li><a href=#threejs%e5%9f%ba%e7%a1%80%e7%9f%a5%e8%af%86%e6%80%bb%e7%bb%93 aria-label=Three.jsåŸºç¡€çŸ¥è¯†æ€»ç»“>Three.jsåŸºç¡€çŸ¥è¯†æ€»ç»“</a><ul><ul><li><a href=#%e7%a8%8d%e7%ad%89%e5%86%8d%e5%95%b0%e5%97%a6%e5%87%a0%e5%8f%a5 aria-label=ç¨ç­‰ï¼Œå†å•°å—¦å‡ å¥>ç¨ç­‰ï¼Œå†å•°å—¦å‡ å¥</a></li></ul></ul></li></ul></div></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p><strong>é‡è¦è¯´æ˜ï¼šæœ¬æ–‡éƒ¨åˆ†å†…å®¹å·²ç»è¿‡æ—¶</strong></p><blockquote><p>.ä»¥ä¸‹å†…å®¹æ›´æ–°äº2021å¹´4æœˆ15æ—¥</p></blockquote><p>æœ¬æ–‡å†™çš„æ—¶å€™è¿˜ä½¿ç”¨çš„æ˜¯ 0.124.0ç‰ˆæœ¬ï¼Œä½†æ˜¯åœ¨ 0.125.2 ä»¥åï¼ˆç›®å‰æœ€æ–°çš„æ˜¯ 0.127.0 ï¼‰ï¼Œå…³äº å‡ ä½•ä½“ å®˜æ–¹åšäº†é‡å¤§è°ƒæ•´ï¼š</p><ol><li><p>å®˜æ–¹å·²ç»å°† Geometry ä»æ ¸å¿ƒåº“ä¸­ç§»é™¤ï¼Œæ–°çš„ä½ç½®æ”¹ä¸ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>import { Geometry } from &#39;three/examples/jsm/deprecated/Geometry&#39;
</span></span></code></pre></div><p>è¯·æ³¨æ„ ç›®å½•åä¸º deprecatedï¼Œè¿™ä¸ªå•è¯çš„æ„æ€å°±æ˜¯ï¼šå·²å¼ƒç”¨ã€ä¸å»ºè®®ä½¿ç”¨ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´å®˜æ–¹å·²ç»ä¸å†å»ºè®®ä½ ä½¿ç”¨ Geometry è¿™ä¸ªç±»äº†ï¼Œé‚£å®ƒçš„æ›¿ä»£è€…æ˜¯è°å‘¢ï¼Ÿ</p></li><li><p>åœ¨ r124 ç‰ˆæœ¬çš„æ—¶å€™ï¼Œå‡ ä½•ä½“(ä¾‹å¦‚ BoxGeometry) ä»–ä»¬éƒ½ç»§æ‰¿çš„æ˜¯ Geometryï¼Œä½†æ˜¯åœ¨æ–°ç‰ˆæœ¬ä¸­å®ƒä»¬ç»§æ‰¿çš„æ˜¯ BufferGeometryã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœä½ æƒ³è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Œç°åœ¨åº”è¯¥ä½¿ç”¨çš„æ˜¯ BufferGeometry</p><blockquote><p>Three.BufferGeometry</p></blockquote><blockquote><p>æ¢å¥è¯è¯´ï¼Œå°±æ˜¯ BufferGeometry æ›¿ä»£äº† Geometry</p></blockquote></li><li><p>Three.Mesh() å‡½æ•°ä¸­çš„å‚æ•°ä¹Ÿå‘ç”Ÿäº†å˜åŒ–</p></li><li><p>æˆ–è®¸è¿˜æœ‰å…¶ä»–æ›´å¤šåœ°æ–¹å‘ç”Ÿäº†å˜åŒ–&mldr;</p></li></ol><br><p>æœ¬æ–‡åœ¨ç¼–å†™çš„æ—¶å€™ï¼Œè¿˜é‡‡ç”¨çš„æ˜¯ Geometryï¼Œæ‰€ä»¥æœ¬æ–‡å†…å®¹è¿‡æ—¶äº†ã€‚</p><p>ç›®å‰å…ˆæš‚ä¸”ä¸åšä¿®æ”¹ï¼Œç­‰åˆ°ä»¥åæœ‰æ—¶é—´äº†å†å°†æœ¬æ–‡ä¸­çš„ä»£ç  Geometry ä¿®æ”¹ä¸º BufferGeometryã€‚</p><br><p>ä½ å¯ä»¥å…ˆè·³è¿‡æœ¬ç« ï¼Œç»§ç»­åé¢ç« èŠ‚çš„å­¦ä¹ ã€‚</p><blockquote><p>ä»¥ä¸‹å†…å®¹æ›´æ–°äº2021å¹´4æœˆ15æ—¥</p></blockquote><br><p>æ¥ä¸‹æ¥å¼€å§‹æœ¬æ–‡(å·²è¿‡æ—¶)çš„å†…å®¹ã€‚</p><hr><br><p>æœ¬æ–‡è¯´çš„ å‡ ä½•ä½“(geometry)ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰ â€œ05 Three.jsåŸºç¡€ä¹‹å›¾å…ƒ.mdâ€ ä¸­çš„ å›¾å…ƒ(primitives)ã€‚</p><blockquote><p>å›¾å…ƒå’Œå‡ ä½•ä½“åªæ˜¯åŒä¸€ä¸ªå¯¹è±¡(äº‹ç‰©)çš„ä¸åŒçš„å«æ³•è€Œå·²ã€‚</p></blockquote><p>è‡ªå®šä¹‰å‡ ä½•ä½“ä¹Ÿå°±ç›¸å½“äºè‡ªå®šä¹‰å›¾å…ƒã€‚</p><blockquote><p>è‡ªå®šä¹‰å‡ ä½•ä½“çš„è¿™ä¸ªè¿‡ç¨‹ï¼Œåœ¨ä¼ ç»Ÿ 3D è½¯ä»¶ä¸­è¢«ç§°ä¸º å»ºæ¨¡</p></blockquote><h2 id=è‡ªå®šä¹‰å‡ ä½•ä½“custom-geometryæ¦‚è¿°>è‡ªå®šä¹‰å‡ ä½•ä½“(custom geometry)æ¦‚è¿°<a hidden class=anchor aria-hidden=true href=#è‡ªå®šä¹‰å‡ ä½•ä½“custom-geometryæ¦‚è¿°>#</a></h2><p>å…ˆæ¥ä¸€ä¸ªçµé­‚æ‹·é—®ã€‚</p><h3 id=æœ‰å¿…è¦åœ¨-threejs-ä¸­è‡ªå®šä¹‰å‡ ä½•ä½“å—>æœ‰å¿…è¦åœ¨ Three.js ä¸­è‡ªå®šä¹‰å‡ ä½•ä½“å—ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#æœ‰å¿…è¦åœ¨-threejs-ä¸­è‡ªå®šä¹‰å‡ ä½•ä½“å—>#</a></h3><p><strong>ç­”ï¼šä¼¼ä¹æ²¡æœ‰å¿…è¦ï¼Œå› ä¸ºå®é™…é¡¹ç›®ä¸­ï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šé€šè¿‡ä¸“ä¸šçš„ 3D è½¯ä»¶ä¸­æ¥åˆ›å»ºç‰©ä½“æ¨¡å‹(å»ºæ¨¡)ï¼Œè€Œä¸æ˜¯é€šè¿‡ Three.js è‡ªå®šä¹‰å»ºæ¨¡ã€‚</strong></p><p>ä¼ ç»Ÿä¸“ä¸šçš„ 3D è½¬ä»¶åŒ…æ‹¬ï¼š</p><ol><li>Blenderï¼šå¼€æºå…è´¹çš„ 3D è½¯ä»¶</li><li>Mayaï¼šä¾§é‡åŠ¨ç”»æ¸²æŸ“çš„ 3D è½¯ä»¶</li><li>Cinema4D(C4D)ï¼šè½»é‡çº§çš„ 3D è½¯ä»¶</li><li>3D Sudio Max</li><li>&mldr;</li></ol><blockquote><p>ä»¥ä¸Šè½¯ä»¶ä¸­ï¼Œéƒ½æœ‰å­¦ä¹ æˆæœ¬ï¼Œç›¸å¯¹è€Œè¨€ C4D æ›´åŠ è½»é‡ã€æ›´åŠ ç®€å•ã€‚</p></blockquote><p>å½“ 3D æ¨¡å‹åˆ›å»ºå¥½åï¼Œæˆ‘ä»¬å°†æ¨¡å‹å¯¼å‡ºä¸º gLTF æˆ– .obj çš„æ–‡ä»¶ï¼Œç„¶ååœ¨ Three.js ä¸­åŠ è½½å¹¶ä½¿ç”¨å®ƒä»¬ã€‚</p><p>å°½ç®¡å¦‚æ­¤ï¼Œä½† Three.js ä¾ç„¶æä¾›äº†è‡ªå®šä¹‰å‡ ä½•ä½“(è‡ªå®šä¹‰å»ºæ¨¡)çš„æ–¹æ³•ã€‚</p><blockquote><p>å¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸å¯¼å…¥ å»ºæ¨¡æ–‡ä»¶ çš„å‰æä¸‹ï¼Œé€šè¿‡ Three.js æ¥è‡ªå®šä¹‰å‡ ä½•ä½“ã€‚</p></blockquote><blockquote><p>æ‰€æœ‰çš„ä¼ ç»Ÿ 3D è½¯ä»¶å»ºæ¨¡è¿‡ç¨‹éƒ½æ˜¯å¯è§†åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¯ä»¥æ—¶æ—¶çœ‹åˆ°ç‰©ä½“ï¼Œå¹¶ä¸”è¿›è¡Œç»†å¾®è°ƒæ•´ã€‚è€Œ Three.js åˆ™æ˜¯é€šè¿‡ä»£ç æ¥å»ºæ¨¡çš„ï¼Œæ•´ä¸ªå»ºæ¨¡è¿‡ç¨‹æ˜¯ä¸å¯è§çš„ã€‚</p></blockquote><p>å°½ç®¡å®é™…ä¸­æˆ‘ä»¬å¯èƒ½ä¼šå¾ˆå°‘æœºä¼šåœ¨ Three.js ä¸­è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Œä½†æ˜¯å­¦ä¹ è¿™æ–¹é¢çš„çŸ¥è¯†è¿˜æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚</p><h3 id=threejsä¸­å¦‚ä½•è‡ªå®šä¹‰å‡ ä½•ä½“>Three.jsä¸­å¦‚ä½•è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#threejsä¸­å¦‚ä½•è‡ªå®šä¹‰å‡ ä½•ä½“>#</a></h3><p>ç­”ï¼šåœ¨ Three.js ä¸­ï¼Œä¸€å…±å¯ä»¥æœ‰ 2 ç§æ–¹å¼è‡ªå®šä¹‰å‡ ä½•ä½“ã€‚</p><p><strong>ç¬¬1ç§ï¼šç»§æ‰¿äº Geometry</strong></p><p>ä¼˜ç‚¹ï¼šåˆ›å»ºå’Œä½¿ç”¨çš„éš¾åº¦å°</p><p>ç¼ºç‚¹ï¼šæ¸²æŸ“å¯åŠ¨é€Ÿåº¦æ…¢ã€å æ›´å¤šå†…å­˜</p><p><strong>ç¬¬2ç§ï¼šç»§æ‰¿äº BufferGeometry</strong></p><p>ä¼˜ç‚¹ï¼šæ¸²æŸ“å¯åŠ¨é€Ÿåº¦å¿«ã€å æ›´å°‘å†…å­˜</p><p>ç¼ºç‚¹ï¼šåˆ›å»ºå’Œä½¿ç”¨çš„éš¾åº¦å¤§</p><p><strong>è¡¥å……è¯´æ˜ï¼š</strong></p><p>ä¸Šé¢è¯´çš„ æ¸²æŸ“å¯åŠ¨é€Ÿåº¦ æ…¢ï¼Œæ˜¯æŒ‡å½“åœºæ™¯ç¬¬ä¸€æ¬¡è¢«æ¸²æŸ“ã€åç»­ä¿®æ”¹åé‡æ–°æ¸²æŸ“çš„é€Ÿåº¦æ…¢ã€‚</p><p>å¹¶ä¸æ˜¯è¯´ ç»˜åˆ¶é€Ÿåº¦æ…¢ã€‚</p><blockquote><p>æ— è®ºé€‰æ‹© Geometry è¿˜æ˜¯ BufferGeometryï¼Œç»˜åˆ¶è¿‡ç¨‹é€Ÿåº¦æ˜¯ç›¸åŒçš„ï¼Œä»–ä»¬çš„ â€œå¿«æ…¢â€ ä¸»è¦ä½“ç°åœ¨ ç¬¬ä¸€æ¬¡æ¸²æŸ“å¯åŠ¨é€Ÿåº¦ è¿™æ–¹é¢ã€‚</p></blockquote><p>å½“ç„¶ï¼Œä½ ä¸éœ€èŠ±å¤ªå¤šç²¾åŠ›å»ç†è§£ æ…¢ çš„ç»†èŠ‚ï¼Œä½ åªéœ€çŸ¥é“ Geometry ç›¸å¯¹è€Œè¨€ æ¸²æŸ“é€Ÿåº¦æ›´æ…¢ä¸€äº›å³å¯ã€‚</p><p><strong>å¦‚ä½•é€‰æ‹©ï¼Ÿ</strong></p><p>ç­”ï¼šå¯¹äºè¦åˆ›å»ºçš„è‡ªå®šä¹‰å‡ ä½•ä½“å„ä¸ªé¢çš„ä¸‰è§’å½¢æ€»å’Œå°äº 1000ï¼Œåˆ™ä¼˜å…ˆé€‰æ‹©ç»§æ‰¿äº Geometryã€‚ä¸‰è§’å½¢æ•°é‡è¶…è¿‡è¿™ä¸ªèŒƒå›´çš„åˆ™æ¨èç»§æ‰¿äº BufferGeometryã€‚</p><p>äº‹å®ä¸Šä»¥ä¸Šçš„é€‰æ‹©ä»…ä¾›å‚è€ƒï¼Œé‡ç‚¹æ˜¯ä½ å®é™…é¡¹ç›®ä¸­ æ˜¯å¦è§‰å¾—æ¸²æŸ“å¯åŠ¨é€Ÿåº¦ã€ä¿®æ”¹å“åº”é€Ÿåº¦æ…¢ï¼Œå¦‚æœæ…¢åˆ™å¯è¿›è¡Œä¼˜åŒ–æ”¹è¿›ã€‚</p><blockquote><p>å¦‚æœç”±äºå®¢æˆ·ç«¯ç¡¬ä»¶é…ç½®æ¯”è¾ƒé«˜ï¼Œæ„ŸçŸ¥ä¸åˆ°æ…¢æˆ–å¡é¡¿ï¼Œé‚£ä¹ˆå¯ä»¥è€Œç»§ç»­ä½¿ç”¨ Geometryã€‚</p></blockquote><h2 id=è‡ªå®šä¹‰å‡ ä½•ä½“ç¤ºä¾‹hellocustomgeometry>è‡ªå®šä¹‰å‡ ä½•ä½“ç¤ºä¾‹ï¼šHelloCustomGeometry<a hidden class=anchor aria-hidden=true href=#è‡ªå®šä¹‰å‡ ä½•ä½“ç¤ºä¾‹hellocustomgeometry>#</a></h2><h4 id=ç¤ºä¾‹ç›®æ ‡>ç¤ºä¾‹ç›®æ ‡<a hidden class=anchor aria-hidden=true href=#ç¤ºä¾‹ç›®æ ‡>#</a></h4><ol><li>é€šè¿‡è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Œæ¥å®ç°ä¸€ä¸ª ç«‹æ–¹ä½“</li><li>è‡ªå®šä¹‰ ç«‹æ–¹ä½“ 6 ä¸ªé¢çš„é¢œè‰²</li><li>è‡ªå®šä¹‰ ç«‹æ–¹ä½“ 8 ä¸ªé¡¶ç‚¹çš„é¢œè‰²</li><li>ç»™ ç«‹æ–¹ä½“ æ·»åŠ  å…‰ç…§æ³•çº¿ï¼Œè®©ç«‹æ–¹ä½“å¯ä»¥åå…‰</li></ol><h4 id=ä»£ç æ€è·¯>ä»£ç æ€è·¯<a hidden class=anchor aria-hidden=true href=#ä»£ç æ€è·¯>#</a></h4><p><strong>å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªç«‹æ–¹ä½“ï¼Ÿ</strong></p><p>ç­”ï¼šä¸»è¦åˆ†ä¸º 3 æ­¥</p><ol><li><p>ç¬¬1æ­¥ï¼šå®ä¾‹åŒ–ä¸€ä¸ª Three.Geometry</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>const geometry = new Three.Geometry()
</span></span></code></pre></div></li><li><p>ç¬¬2æ­¥ï¼šæŒ‰ç…§ç«‹æ–¹ä½“ç›¸åº”çš„åæ ‡ï¼Œæ·»åŠ  8 ä¸ªé¡¶ç‚¹</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>geometry.vertices.push(
</span></span><span style=display:flex><span>    new Three.Vector3(-1, -1, 1), // 1
</span></span><span style=display:flex><span>    new Three.Vector3(1, -1, 1), // 2
</span></span><span style=display:flex><span>    new Three.Vector3(-1, 1, 1), // 3
</span></span><span style=display:flex><span>    new Three.Vector3(1, 1, 1), // 4
</span></span><span style=display:flex><span>    new Three.Vector3(-1, -1, -1), // 5
</span></span><span style=display:flex><span>    new Three.Vector3(1, -1, -1), // 6
</span></span><span style=display:flex><span>    new Three.Vector3(-1, 1, -1), // 7
</span></span><span style=display:flex><span>    new Three.Vector3(1, 1, -1) // 8
</span></span><span style=display:flex><span>)
</span></span></code></pre></div></li><li><p>ç¬¬3æ­¥ï¼šå°†ç›¸é‚»çš„ 3 ä¸ªé¡¶ç‚¹ï¼Œä¾æ¬¡æŒ‰ç…§é€†æ—¶é’ˆé¡ºåºï¼Œæ„å»ºæˆä¸€ä¸ªä¸ªä¸‰è§’å½¢ã€‚</p><blockquote><p>ç«‹æ–¹ä½“ä¸€å…±æœ‰ 6 ä¸ªé¢ï¼Œæ¯ä¸ªé¢ç”± 2 ä¸ªä¸‰è§’å½¢æ„æˆï¼Œå› æ­¤ä¸€å…±éœ€è¦æ„å»º 12 ä¸ªä¸‰è§’å½¢</p></blockquote><blockquote><p>ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯é€†æ—¶é’ˆï¼Ÿè¿™æ˜¯ Three.js è§„å®šçš„ã€‚</p></blockquote><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>geometry.faces.push(
</span></span><span style=display:flex><span>    //å‰é¢
</span></span><span style=display:flex><span>    new Three.Face3(0, 3, 2),
</span></span><span style=display:flex><span>    new Three.Face3(0, 1, 3),
</span></span><span style=display:flex><span>    //å³é¢
</span></span><span style=display:flex><span>    new Three.Face3(1, 7, 3),
</span></span><span style=display:flex><span>    new Three.Face3(1, 5, 7),
</span></span><span style=display:flex><span>    //åé¢
</span></span><span style=display:flex><span>    new Three.Face3(5, 6, 7),
</span></span><span style=display:flex><span>    new Three.Face3(5, 4, 6),
</span></span><span style=display:flex><span>    //å·¦é¢
</span></span><span style=display:flex><span>    new Three.Face3(4, 2, 6),
</span></span><span style=display:flex><span>    new Three.Face3(4, 0, 2),
</span></span><span style=display:flex><span>    //é¡¶é¢
</span></span><span style=display:flex><span>    new Three.Face3(2, 7, 6),
</span></span><span style=display:flex><span>    new Three.Face3(2, 3, 7),
</span></span><span style=display:flex><span>    //åº•é¢
</span></span><span style=display:flex><span>    new Three.Face3(4, 1, 0),
</span></span><span style=display:flex><span>    new Three.Face3(4, 5, 1)
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>è‡³æ­¤ï¼Œå°±ä»¥æˆåŠŸæ„å»ºå‡ºä¸€ä¸ªç«‹æ–¹ä½“çš„åŸºæœ¬éª¨æ¶ã€‚</p></li></ol><p><strong>å¦‚ä½•è‡ªå®šä¹‰ 6 ä¸ªé¢çš„é¢œè‰²é¢ï¼Ÿ</strong></p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>geometry.faces[0].color = geometry.faces[1].color = new Three.Color(&#39;red&#39;)
</span></span><span style=display:flex><span>geometry.faces[2].color = geometry.faces[3].color = new Three.Color(&#39;yello&#39;)
</span></span><span style=display:flex><span>geometry.faces[4].color = geometry.faces[5].color = new Three.Color(&#39;green&#39;)
</span></span><span style=display:flex><span>geometry.faces[6].color = geometry.faces[7].color = new Three.Color(&#39;cyan&#39;)
</span></span><span style=display:flex><span>geometry.faces[8].color = geometry.faces[9].color = new Three.Color(&#39;blue&#39;)
</span></span><span style=display:flex><span>geometry.faces[10].color = geometry.faces[11].color = new Three.Color(&#39;magenta&#39;)
</span></span></code></pre></div><p><strong>å¦‚ä½•è‡ªå®šä¹‰ 8 ä¸ªé¡¶ç‚¹çš„é¢œè‰²ï¼Ÿ</strong></p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>geometry.faces.forEach((face, index) =&gt; {
</span></span><span style=display:flex><span>    face.vertexColors = [
</span></span><span style=display:flex><span>        (new Three.Color()).setHSL(index / 12, 1, 0.5),
</span></span><span style=display:flex><span>        (new Three.Color()).setHSL(index / 12 + 0.1, 1, 0.5),
</span></span><span style=display:flex><span>        (new Three.Color()).setHSL(index / 12 + 0.2, 1, 0.5)
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p><strong>å¦‚ä½•å¼€å¯é¡¶ç‚¹ç€è‰²ï¼Ÿ</strong></p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>const material = new THREE.MeshBasicMaterial({vertexColors: true})
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>const material = new Three.MeshPhongMaterial({ vertexColors: true })
</span></span></code></pre></div><blockquote><p>vertexColors é»˜è®¤å€¼ä¸º falseï¼Œå³é»˜è®¤æ˜¾ç¤ºæè´¨ color çš„é¢œè‰²ã€‚</p><p>å¦‚æœæ²¡æœ‰ç»™æè´¨è®¾ç½® color å€¼ï¼Œé‚£ä¹ˆé»˜è®¤é¢œè‰²å€¼ä¸º ç™½è‰²</p></blockquote><p>ç‰¹åˆ«è¯´æ˜ï¼Œåœ¨ Three.js ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼ŒvertexColors çš„å€¼å¹¶ä¸æ˜¯ Booleanï¼Œè€Œæ˜¯è¿›è¡Œä»¥ä¸‹è®¾ç½®ï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>//export enum Colors {}
</span></span><span style=display:flex><span>//export const NoColors: Colors;
</span></span><span style=display:flex><span>//export const FaceColors: Colors;
</span></span><span style=display:flex><span>//export const VertexColors: Colors;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>const material = new THREE.MeshBasicMaterial({vertexColors: THREE.FaceColors});
</span></span></code></pre></div><p>åœ¨ç›®å‰æ¯”è¾ƒæ–°çš„ç‰ˆæœ¬ä¸­ï¼ŒvertexColors çš„å€¼æ”¹ä¸º Boolean ç±»å‹ã€‚</p><p><strong>å¦‚ä½•æ·»åŠ å…‰ç…§æ³•çº¿ï¼Ÿ</strong></p><p>ç­”ï¼šä¸€å…±æœ‰ 3 ç§æ–¹å¼</p><ol><li><p>ç»™æ¯ä¸€ä¸ª face è®¾ç½® normal å±æ€§å€¼</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>face.normal = new Three.Vector3(...)
</span></span></code></pre></div></li><li><p>é€šè¿‡ vertexNormals å±æ€§æ¥è®¾ç½®</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>face.vertexNormals = {
</span></span><span style=display:flex><span>  new Three.Vector3(...),
</span></span><span style=display:flex><span>  new Three.Vector3(...),
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  new Three.Vector3(...)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p>é€šè¿‡ computeFaceNormals() å’Œ computeVertexNormals() è¿™ 2 ä¸ªæ–¹æ³•è‡ªåŠ¨å¸®æˆ‘ä»¬è®¡ç®—å‡ºå…‰ç…§æ³•çº¿ã€‚</p><p>ä½†æ˜¯å¯¹äºç«‹æ–¹ä½“è€Œè¨€ï¼Œåªæ‰§è¡Œ computeFaceNormals() æ–¹æ³•å³å¯ã€‚</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>geometry.computeFaceNormals()
</span></span><span style=display:flex><span>//geometry.computeVertexNormals() // è¿™ä¸ªæ–¹æ³•å¹¶ä¸é€‚ç”¨äºç«‹æ–¹ä½“
</span></span></code></pre></div></li></ol><blockquote><p>ç¬¬ 3 ç§ æ–¹æ³•æœ€ä¸ºç®€ä¾¿ï¼Œä¹Ÿæ¯”è¾ƒå¸¸ç”¨ã€‚</p><p>æœ¬ç¤ºä¾‹å°±é‡‡ç”¨ç¬¬ 3 ç§æ–¹å¼ã€‚</p></blockquote><p><strong>è¡¥å……è¯´æ˜ï¼šcomputeVertexNormals() ä¸ºä»€ä¹ˆä¸é€‚ç”¨äºç«‹æ–¹ä½“ï¼Ÿ</strong></p><p>ç­”ï¼šå› ä¸º computeVertexNormals() ä¼šä»æ¯ä¸ªé¡¶ç‚¹å…±äº«çš„æ‰€æœ‰é¢çš„æ³•çº¿ä¸­è®¡ç®—å¾—å‡ºæ³•çº¿ï¼Œè¿™æ ·çš„å‘ç°ä¼šè®©ç«‹æ–¹ä½“çš„é¡¶ç‚¹çœ‹ä¸Šå»æ›´åƒä¸€ä¸ªçƒä½“ã€‚</p><blockquote><p>å¦‚æœä½ æ‰§è¡Œäº† computeVertexNormals()ï¼Œå¹¶ä¸ä¼šæŠ¥é”™ï¼Œä»…ä»…æ˜¯ç«‹æ–¹ä½“é¡¶ç‚¹å¤„çœ‹ä¼¼æ›´åŠ åœ†æ¶¦ï¼Œåƒçƒä¸€æ ·ã€‚</p></blockquote><h4 id=ä»£ç ç¤ºä¾‹>ä»£ç ç¤ºä¾‹<a hidden class=anchor aria-hidden=true href=#ä»£ç ç¤ºä¾‹>#</a></h4><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>import { useEffect, useRef } from &#39;react&#39;
</span></span><span style=display:flex><span>import * as Three from &#39;three&#39;
</span></span><span style=display:flex><span>import { OrbitControls } from &#39;three/examples/jsm/controls/OrbitControls&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>import &#39;./index.scss&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>const HelloCustomGeometry = () =&gt; {
</span></span><span style=display:flex><span>    const canvasRef = useRef&lt;HTMLCanvasElement&gt;(null)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    useEffect(() =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        if (canvasRef.current === null) {
</span></span><span style=display:flex><span>            return
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const renderer = new Three.WebGLRenderer({ canvas: canvasRef.current })
</span></span><span style=display:flex><span>        const scene = new Three.Scene()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const camera = new Three.PerspectiveCamera(45, 2, 0.1, 100)
</span></span><span style=display:flex><span>        camera.position.z = 8
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const light = new Three.DirectionalLight(0xFFFFFF, 1)
</span></span><span style=display:flex><span>        light.position.set(2, 2, 4)
</span></span><span style=display:flex><span>        scene.add(light)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const helper = new Three.DirectionalLightHelper(light)
</span></span><span style=display:flex><span>        scene.add(helper)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const controls = new OrbitControls(camera, canvasRef.current)
</span></span><span style=display:flex><span>        controls.update()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        //è‡ªå®šä¹‰ä¸€ä¸ªç«‹æ–¹ä½“å‡ ä½•ä½“
</span></span><span style=display:flex><span>        const geometry = new Three.Geometry()
</span></span><span style=display:flex><span>        geometry.vertices.push(
</span></span><span style=display:flex><span>            new Three.Vector3(-1, -1, 1), // 1
</span></span><span style=display:flex><span>            new Three.Vector3(1, -1, 1), // 2
</span></span><span style=display:flex><span>            new Three.Vector3(-1, 1, 1), // 3
</span></span><span style=display:flex><span>            new Three.Vector3(1, 1, 1), // 4
</span></span><span style=display:flex><span>            new Three.Vector3(-1, -1, -1), // 5
</span></span><span style=display:flex><span>            new Three.Vector3(1, -1, -1), // 6
</span></span><span style=display:flex><span>            new Three.Vector3(-1, 1, -1), // 7
</span></span><span style=display:flex><span>            new Three.Vector3(1, 1, -1) // 8
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        geometry.faces.push(
</span></span><span style=display:flex><span>            //å‰é¢
</span></span><span style=display:flex><span>            new Three.Face3(0, 3, 2),
</span></span><span style=display:flex><span>            new Three.Face3(0, 1, 3),
</span></span><span style=display:flex><span>            //å³é¢
</span></span><span style=display:flex><span>            new Three.Face3(1, 7, 3),
</span></span><span style=display:flex><span>            new Three.Face3(1, 5, 7),
</span></span><span style=display:flex><span>            //åé¢
</span></span><span style=display:flex><span>            new Three.Face3(5, 6, 7),
</span></span><span style=display:flex><span>            new Three.Face3(5, 4, 6),
</span></span><span style=display:flex><span>            //å·¦é¢
</span></span><span style=display:flex><span>            new Three.Face3(4, 2, 6),
</span></span><span style=display:flex><span>            new Three.Face3(4, 0, 2),
</span></span><span style=display:flex><span>            //é¡¶é¢
</span></span><span style=display:flex><span>            new Three.Face3(2, 7, 6),
</span></span><span style=display:flex><span>            new Three.Face3(2, 3, 7),
</span></span><span style=display:flex><span>            //åº•é¢
</span></span><span style=display:flex><span>            new Three.Face3(4, 1, 0),
</span></span><span style=display:flex><span>            new Three.Face3(4, 5, 1)
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        geometry.faces[0].color = geometry.faces[1].color = new Three.Color(&#39;red&#39;)
</span></span><span style=display:flex><span>        geometry.faces[2].color = geometry.faces[3].color = new Three.Color(&#39;yello&#39;)
</span></span><span style=display:flex><span>        geometry.faces[4].color = geometry.faces[5].color = new Three.Color(&#39;green&#39;)
</span></span><span style=display:flex><span>        geometry.faces[6].color = geometry.faces[7].color = new Three.Color(&#39;cyan&#39;)
</span></span><span style=display:flex><span>        geometry.faces[8].color = geometry.faces[9].color = new Three.Color(&#39;blue&#39;)
</span></span><span style=display:flex><span>        geometry.faces[10].color = geometry.faces[11].color = new Three.Color(&#39;magenta&#39;)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        geometry.faces.forEach((face, index) =&gt; {
</span></span><span style=display:flex><span>            face.vertexColors = [
</span></span><span style=display:flex><span>                (new Three.Color()).setHSL(index / 12, 1, 0.5),
</span></span><span style=display:flex><span>                (new Three.Color()).setHSL(index / 12 + 0.1, 1, 0.5),
</span></span><span style=display:flex><span>                (new Three.Color()).setHSL(index / 12 + 0.2, 1, 0.5)
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        geometry.computeFaceNormals()
</span></span><span style=display:flex><span>        //geometry.computeVertexNormals() //å¯¹äºç«‹æ–¹ä½“è€Œè¨€ï¼Œæ— éœ€æ‰§è¡Œæ­¤æ–¹æ³•
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        //const material = new Three.MeshBasicMaterial({ color: &#39;red&#39; })
</span></span><span style=display:flex><span>        const material = new Three.MeshPhongMaterial({ vertexColors: true })
</span></span><span style=display:flex><span>        //const material = new Three.MeshPhongMaterial({ color: &#39;red&#39; })
</span></span><span style=display:flex><span>        const cube = new Three.Mesh(geometry, material)
</span></span><span style=display:flex><span>        scene.add(cube)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const render = (time: number) =&gt; {
</span></span><span style=display:flex><span>            cube.rotation.x = cube.rotation.y = time * 0.001
</span></span><span style=display:flex><span>            renderer.render(scene, camera)
</span></span><span style=display:flex><span>            window.requestAnimationFrame(render)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        window.requestAnimationFrame(render)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const handleResize = () =&gt; {
</span></span><span style=display:flex><span>            if (canvasRef.current === null) {
</span></span><span style=display:flex><span>                return
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            const width = canvasRef.current.clientWidth
</span></span><span style=display:flex><span>            const height = canvasRef.current.clientHeight
</span></span><span style=display:flex><span>            camera.aspect = width / height
</span></span><span style=display:flex><span>            camera.updateProjectionMatrix()
</span></span><span style=display:flex><span>            renderer.setSize(width, height, false)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        handleResize()
</span></span><span style=display:flex><span>        window.addEventListener(&#39;resize&#39;, handleResize)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        return () =&gt; {
</span></span><span style=display:flex><span>            window.removeEventListener(&#39;resize&#39;, handleResize)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }, [canvasRef])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    return (
</span></span><span style=display:flex><span>        &lt;canvas ref={canvasRef} className=&#39;full-screen&#39; /&gt;
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>export default HelloCustomGeometry
</span></span></code></pre></div><p>å®é™…è¿è¡Œåï¼Œå°±ä¼šçœ‹åˆ°ä¸€ä¸ª ç‚«å½©çš„ç«‹æ–¹ä½“ã€‚</p><h4 id=æœ¬æ–‡å°ç»“>æœ¬æ–‡å°ç»“<a hidden class=anchor aria-hidden=true href=#æœ¬æ–‡å°ç»“>#</a></h4><p>é€šè¿‡è‡ªå®šä¹‰ä¸€ä¸ªç«‹æ–¹ä½“çš„ç¤ºä¾‹ï¼Œå¯ä»¥çœ‹å‡ºï¼Œå°½ç®¡æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç«‹æ–¹ä½“ï¼Œå¯æˆ‘ä»¬éƒ½éœ€è¦éå¸¸å¤æ‚çš„ç©ºé—´åæ ‡è®¡ç®—é…ç½®ï¼Œå› æ­¤è¿˜æ˜¯æœ¬æ–‡å¼€å¤´é‚£æ®µè¯ï¼š</p><ol><li>å¦‚éå¿…è¦ï¼Œä¸è¦åœ¨ Three.js ä¸­è‡ªå®šä¹‰å‡ ä½•ä½“ã€‚</li><li>ä½¿ç”¨ä¼ ç»Ÿçš„ 3D è½¯ä»¶å»ºæ¨¡ï¼Œæ›´é¦™ã€‚</li></ol><h4 id=è¡¥å……è¯´æ˜>è¡¥å……è¯´æ˜<a hidden class=anchor aria-hidden=true href=#è¡¥å……è¯´æ˜>#</a></h4><p>æœ¬ç³»åˆ—æ•™ç¨‹ï¼Œå®é™…ä¸Šæ˜¯æˆ‘ä¸€è¾¹å­¦ä¹  <a href=https://threejsfundamentals.org/threejs/lessons/>https://threejsfundamentals.org/threejs/lessons/</a> ï¼Œä¸€è¾¹ä½¿ç”¨ React + TypeScript + è‡ªå·±çš„è¯­è¨€å’Œç†è§£ é‡å†™ä¸€éçš„ã€‚</p><p>æœ¬æ–‡å¯¹åº”çš„è‹±æ–‡æ•™ç¨‹ä¸ºï¼š<a href=https://threejsfundamentals.org/threejs/lessons/threejs-custom-geometry.html>https://threejsfundamentals.org/threejs/lessons/threejs-custom-geometry.html</a></p><p>åœ¨åŸç‰ˆçš„è‹±æ–‡æ•™ç¨‹ä¸­ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ª é€šè¿‡ä¸€å¼ å›¾ç‰‡æ¥è·å¾— çº¹ç†åæ ‡(UV)ï¼Œè¿›è€Œç”Ÿæˆä¸€å¼ åœ°å›¾çš„ä¾‹å­ã€‚</p><p>æˆ‘ä¸ªäººæ„Ÿè§‰æ²¡æœ‰å¿…è¦å»è¿™ä¹ˆæ·±å…¥å­¦ä¹ è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Œæ‰€ä»¥æœ¬æ–‡ç•¥è¿‡è¿™ä¸ªç¤ºä¾‹ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå®˜æ–¹è¿˜æœ‰å•ç‹¬ä¸€ç¯‡ï¼Œä½¿ç”¨ BufferGeometry æ¥è‡ªå®šä¹‰å‡ ä½•ä½“çš„æ•™ç¨‹ï¼š</p><p><a href=https://threejsfundamentals.org/threejs/lessons/threejs-custom-buffergeometry.html>https://threejsfundamentals.org/threejs/lessons/threejs-custom-buffergeometry.html</a></p><p>æˆ‘è®¤ä¸ºç°é˜¶æ®µï¼Œæ²¡æœ‰å¿…è¦å¦‚æ­¤è¿™èˆ¬çš„æ·±å…¥å»å­¦ä¹ è‡ªå®šä¹‰å‡ ä½•ä½“ï¼Œå› ä¸ºæš‚åœè¿™éƒ¨åˆ†çš„å­¦ä¹ ã€‚</p><blockquote><p>å¦‚æœä½ è¿˜æœ‰ç²¾åŠ›ï¼Œå¯ä»¥å»å­¦ä¹ ä¸€ä¸‹ã€‚</p></blockquote><h2 id=threejsåŸºç¡€çŸ¥è¯†æ€»ç»“>Three.jsåŸºç¡€çŸ¥è¯†æ€»ç»“<a hidden class=anchor aria-hidden=true href=#threejsåŸºç¡€çŸ¥è¯†æ€»ç»“>#</a></h2><p>é€šè¿‡å‰é¢ä¸€ç³»åˆ—çš„å­¦ä¹ ï¼Œæˆ‘ä»¬ç»ˆäºå°† Three.js åŸºç¡€çŸ¥è¯†å­¦ä¹ å®Œæˆã€‚</p><p>å›é¡¾ä¸€ä¸‹æˆ‘ä»¬éƒ½å­¦ä¹ äº†å“ªäº›çŸ¥è¯†ç‚¹ï¼š</p><ol><li>Three.js ç®€ä»‹ã€é¡¹ç›®åˆå§‹åŒ–ã€å…¥é—¨ç¤ºä¾‹</li><li>å›¾å…ƒã€3Dæ–‡å­—ã€åœºæ™¯ã€æè´¨ã€çº¹ç†ã€ç¯å…‰ã€é•œå¤´ã€é˜´å½±ã€é›¾ã€ç¦»å±æ¸²æŸ“ã€è‡ªå®šä¹‰å‡ ä½•ä½“</li><li>è¾…åŠ©å¯¹è±¡(ç¯å…‰è¾…åŠ©å¯¹è±¡ LightHelper ã€é•œå¤´è¾…åŠ©å¯¹è±¡ XxxxCameraHelperã€åæ ‡è½´è¾…åŠ©å¯¹è±¡ AxesHelper)ã€é•œå¤´è½¨é“æ§åˆ¶ç±»(OrbitControls)</li></ol><p>çœŸå¿ƒä¸å®¹æ˜“ï¼Œç»™è‡ªå·±ä¸€æœµå°çº¢èŠ±ï¼</p><p>&mldr;</p><p>æˆ‘ä»¬æœ¬ç³»åˆ—æ•™ç¨‹æ•´ä½“çš„è§„åˆ’æ˜¯ï¼š</p><ol><li>åŸºç¡€ç¯‡ (âœ“)</li><li>æŠ€å·§ç¯‡ (x)</li><li>ä¼˜åŒ–ç¯‡ (x)</li><li>è§£å†³æ–¹æ¡ˆ (x)</li><li>WebVR (x)</li><li>å®ä¾‹ç¯‡ (x)</li></ol><p>ç›®å‰æˆ‘ä»¬å·²ç»å­¦ä¹ äº†åŸºç¡€ç¯‡ï¼Œå¯¹ Three.js å·²ç»æœ‰äº†è¶³å¤Ÿçš„åŸºç¡€çŸ¥è¯†æŒæ¡ï¼Œåé¢çš„å­¦ä¹ éƒ½æ˜¯å»ºç«‹åœ¨è¿™äº›åŸºç¡€çŸ¥è¯†ä¹‹ä¸Šçš„ã€‚</p><p><strong>æ¥ä¸‹æ¥ï¼Œè¿›å…¥æŠ€å·§ç¯‡â€”â€”æŒ‰éœ€æ¸²æŸ“ã€‚</strong></p><h4 id=ç¨ç­‰å†å•°å—¦å‡ å¥>ç¨ç­‰ï¼Œå†å•°å—¦å‡ å¥<a hidden class=anchor aria-hidden=true href=#ç¨ç­‰å†å•°å—¦å‡ å¥>#</a></h4><p>æˆ‘ä»¬åç»­çš„è®²è§£æ–‡ç« ä¸­ï¼Œå°†åŠ å¿«è¿›åº¦ï¼Œä¸å†åƒ åŸºç¡€ç¯‡ è¿™æ ·å¦‚æ­¤ç»†è‡´ï¼Œç”šè‡³æ˜¯å•°å—¦ã€‚</p><p>å› æ­¤ï¼Œæˆ‘å¸Œæœ›ä½ ä¸çœ‹æ•™ç¨‹ç¤ºä¾‹ä»£ç ï¼Œè€Œæ˜¯è‡ªå·±ç‹¬ç«‹æ•²å‡ºç¤ºä¾‹ä»£ç ã€‚å¦‚æœåšä¸åˆ°ï¼Œé‚£ä¹ˆä½ å…ˆä¸è¦ç€æ€¥è¿›å…¥ä¸‹ä¸€ç¯‡ï¼Œè€Œæ˜¯åº”è¯¥å†å›è¿‡å¤´ï¼Œåå¤é˜…è¯»ï¼Œåå¤æ•²å‡ éä»£ç ã€‚</p><blockquote><p>åœ¨åš(åŠ¨æ‰‹æ•²ä»£ç )çš„è¿‡ç¨‹ä¸­å­¦ä¹ ï¼Œè€Œä¸æ˜¯åªçœ‹ä¸åŠ¨æ‰‹ã€‚</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://bablvsj.github.io/tags/three.js/>Three.js</a></li></ul><nav class=paginav><a class=prev href=https://bablvsj.github.io/posts/threejs/15-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%A6%BB%E5%B1%8F%E6%B8%B2%E6%9F%93/><span class=title>Â« Prev</span><br><span>15 Three.jsåŸºç¡€ä¹‹ç¦»å±æ¸²æŸ“</span></a>
<a class=next href=https://bablvsj.github.io/posts/threejs/17-three.js%E6%8A%80%E5%B7%A7%E4%B9%8B%E6%8C%89%E9%9C%80%E6%B8%B2%E6%9F%93/><span class=title>Next Â»</span><br><span>17 Three.jsæŠ€å·§ä¹‹æŒ‰éœ€æ¸²æŸ“</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://bablvsj.github.io>Bablvsj's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div class=flex-c-d><a class=flex-d-c href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target=_blank><span>æœ¬ç«™ç”±</span><img width=60 src=/images/upyun.png>æä¾›CDNåŠ é€Ÿ/äº‘å­˜å‚¨æœåŠ¡</a></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>