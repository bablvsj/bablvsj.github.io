<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>15 Three.jsåŸºç¡€ä¹‹ç¦»å±æ¸²æŸ“ | Bablvsj's Blog</title><meta name=keywords content="Three.js"><meta name=description content="15 Three.jsåŸºç¡€ä¹‹ç¦»å±æ¸²æŸ“ - Bablvsj's Blog"><meta name=author content><link rel=canonical href=https://bablvsj.github.io/posts/threejs/15-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%A6%BB%E5%B1%8F%E6%B8%B2%E6%9F%93/><link crossorigin=anonymous href=/assets/css/stylesheet.241265d51339977eb0f90d05780e286ec2789600ca4137f29552dec9dee06569.css integrity="sha256-JBJl1RM5l36w+Q0FeA4obsJ4lgDKQTfylVLeyd7gZWk=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://bablvsj.github.io/img/Q.gif><link rel=apple-touch-icon href=https://bablvsj.github.io/Q.gif><link rel=mask-icon href=https://bablvsj.github.io/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=/css/syntax.css><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="15 Three.jsåŸºç¡€ä¹‹ç¦»å±æ¸²æŸ“"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://bablvsj.github.io/posts/threejs/15-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%A6%BB%E5%B1%8F%E6%B8%B2%E6%9F%93/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-19T17:11:35+08:00"><meta property="article:modified_time" content="2023-12-19T17:11:35+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="15 Three.jsåŸºç¡€ä¹‹ç¦»å±æ¸²æŸ“"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"æ–‡ç« ","item":"https://bablvsj.github.io/posts/"},{"@type":"ListItem","position":3,"name":"15 Three.jsåŸºç¡€ä¹‹ç¦»å±æ¸²æŸ“","item":"https://bablvsj.github.io/posts/threejs/15-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%A6%BB%E5%B1%8F%E6%B8%B2%E6%9F%93/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"15 Three.jsåŸºç¡€ä¹‹ç¦»å±æ¸²æŸ“","name":"15 Three.jsåŸºç¡€ä¹‹ç¦»å±æ¸²æŸ“","description":"","keywords":["Three.js"],"articleBody":"Render Targets(ç¦»å±æ¸²æŸ“)ç®€ä»‹ åè¯è§£é‡Šï¼šRender Targets ä»å­—é¢ä¸Šç›´æ¥ç¿»è¯‘ï¼Œâ€œRender Targetsâ€ åº”è¯¥ç¿»è¯‘ä¸º â€œæ¸²æŸ“ç›®æ ‡â€ã€‚\nä»å®é™…ä½œç”¨ä¸Šç¿»è¯‘ï¼Œâ€Render Targetsâ€œ åº”è¯¥ç¿»è¯‘ä¸º â€ç¦»å±æ¸²æŸ“ç›®æ ‡ æˆ– ç¦»å±æ¸²æŸ“å¯¹è±¡â€œã€‚\nå›½å†…ç»å¤§å¤šæ•° Three.js æ•™ç¨‹éƒ½æŠŠ Render Targets ç¿»è¯‘ä¸º ç¦»å±æ¸²æŸ“ã€‚\næˆ‘ä¸ªäººè®¤ä¸ºç¿»è¯‘æˆï¼šç¦»å±æ¸²æŸ“ç›®æ ‡ æ›´ä¸ºåˆé€‚ï¼Œä½†æœ‰æ—¶æˆ‘ä¼šä¸è‡ªè§‰ä½¿ç”¨ ç¦»çº¿æ¸²æŸ“å¯¹è±¡ è¿™ä¸ªè¯ï¼Œæ‰€ä»¥ä½ åªéœ€è¦æ˜ç™½ è™½ç„¶ç§°å‘¼ä¸åŒï¼Œä½†æŒ‡å‘çš„éƒ½æ˜¯åŒä¸€ä¸ªä¸œè¥¿ã€‚\nç¦»å±æ¸²æŸ“æ¦‚å¿µè§£é‡Š é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆè¯´ä¸€ä¸‹ æ™®é€šçš„â€œæ¸²æŸ“â€ã€‚\nä¹‹å‰ç¤ºä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨çš„æ¸²æŸ“å™¨éƒ½æ˜¯ WebGLRendererã€‚æˆ‘ä»¬åˆ›å»ºçš„æ¸²æŸ“å™¨å®ä¾‹ renderer ä¼šæ ¹æ® åœºæ™¯(å«åœºæ™¯ä¸­çš„ç‰©ä½“)ã€ç¯å…‰ æ¥å°†è§†è§‰ç»“æœæ¸²æŸ“åˆ°ç½‘é¡µä¸­ã€‚\næ­¤æ—¶çš„ æ¸²æŸ“ å°±æ˜¯æ™®é€šçš„æ¸²æŸ“ï¼Œæ¸²æŸ“ç»“æœç›´æ¥å‡ºç°åœ¨ç½‘é¡µä¸­ã€‚\né‚£ä»€ä¹ˆåˆæ˜¯ç¦»å±æ¸²æŸ“ï¼Ÿ\nç­”ï¼šæ¸²æŸ“å™¨ä¼šæ¸²æŸ“åœºæ™¯ï¼Œä½†æ˜¯ä¸ä¼šå§æ¸²æŸ“ç»“æœç›´æ¥å‘ˆç°åœ¨ç½‘é¡µä¸­ï¼Œè€Œæ˜¯æŠŠæ¸²æŸ“ç»“æœä¿å­˜åˆ° GPU å†…éƒ¨ä¸­ã€‚\næ­¤æ—¶ æš‚å­˜åˆ° GPU ä¸­çš„æ¸²æŸ“ç»“æœ(å›¾ç‰‡)ï¼Œå¯ä»¥è¢«å½“åšä¸€ç§çº¹ç†(texture)ï¼Œä½¿ç”¨åˆ°å…¶ä»–ç‰©ä½“ä¸­ã€‚\nç¦»å±æ¸²æŸ“ å’Œ æ­£å¸¸æ¸²æŸ“ æ•´ä¸ªè®¡ç®—è¿‡ç¨‹å®Œå…¨ç›¸åŒï¼Œä¸åŒçš„åœ°æ–¹åœ¨äº ç¦»å±æ¸²æŸ“ çš„ç»“æœæ˜¯ä¿å­˜åœ¨ GPU å†…å­˜ä¸­ï¼Œè€Œéç›´æ¥æ˜¾ç¤ºåœ¨ç½‘é¡µä¸­ã€‚\nç¦»å±æ¸²æŸ“çš„ç§ç±» åœ¨ Three.js ä¸­ï¼Œä¸€å…±æœ‰ 3 ç§ç¦»å±æ¸²æŸ“ç±»å‹ã€‚\nç¦»å±æ¸²æŸ“ç±»å‹ åç§°åŠè§£é‡Š WebGLMultisampleRenderTarget WebGL 2 å¯¹åº”çš„ç¦»å±æ¸²æŸ“ WebGLRenderTarget WebGLRender å¯¹åº”çš„ç¦»å±æ¸²æŸ“ WebGLCubeRenderTarget CubeCamera å¯¹åº”çš„ç¦»å±æ¸²æŸ“ ç¦»å±æ¸²æŸ“çš„ç”¨é€” å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šåœºæ™¯ä¸­æœ‰ 3 ä¸ªä¸åŒé¢œè‰²ã€ä¸åœè½¬åŠ¨çš„ç«‹æ–¹ä½“ã€‚\næˆ‘ä»¬ä¹‹å‰ç¤ºä¾‹ä¸­ä¼šä½¿ç”¨ WebGLRenderer ï¼ŒæŠŠè¿™ä¸ªåœºæ™¯ç”»é¢å†…å®¹æ¸²æŸ“åˆ°ç½‘é¡µä¸­ï¼Œè¿™å±äºæ­£å¸¸çš„æ¸²æŸ“ã€‚\nè‹¥æˆ‘ä»¬ç°åœ¨æ”¹å˜éœ€æ±‚ï¼Œæˆ‘ä»¬å¸Œæœ›ä¿®æ”¹æˆï¼š\nåœºæ™¯ä¸­æœ‰ä¸€é¢é•œå­ åœ¨é•œå­ä¸­æ˜¾ç¤ºå‡º 3 ä¸ªä¸åŒé¢œè‰²ã€ä¸åŒæ—‹è½¬çš„ç«‹æ–¹ä½“ åœºæ™¯æœ¬èº«å½“ä¸­ï¼Œæ˜¯çœ‹ä¸è§è¿™ 3 ä¸ªç«‹æ–¹ä½“çš„ ä¸ºäº†å®ç°è¿™ä¸ªéœ€æ±‚ï¼Œæˆ‘ä»¬æ­¤æ—¶å°±éœ€è¦ç”¨åˆ° ç¦»å±æ¸²æŸ“ã€‚\nå…·ä½“åšæ³•æ˜¯ï¼š\nåˆ›å»ºä¸€ä¸ªå­åœºæ™¯ï¼Œè¯¥å­åœºæ™¯ä¸­ æœ‰ 3 ä¸ªä¸åŒé¢œè‰²ã€ä¸åœæ—‹è½¬çš„ç«‹æ–¹ä½“\nåˆ›å»ºä¸€ä¸ªæ€»åœºæ™¯ã€ä¸€ä¸ªæ¸²æŸ“å™¨ï¼Œä¸€é¢é•œå­\nä½¿ç”¨æ€»åœºæ™¯çš„æ¸²æŸ“å™¨ï¼Œå¯¹å­åœºæ™¯è¿›è¡Œæ¸²æŸ“ï¼Œå¾—åˆ°ä¸€ä¸ªç¦»å±æ¸²æŸ“ç»“æœ(å›¾åƒçº¹ç†)\næ³¨æ„ï¼šç”±äºæ˜¯ç¦»å±æ¸²æŸ“ï¼Œåªæ˜¯å°† 3 ä¸ªç«‹æ–¹ä½“æ¸²æŸ“å‡ºçš„è§†è§‰æ•ˆæœä¿å­˜åˆ° GPU å†…å­˜ä¸­ï¼Œç½‘é¡µä¸­å¹¶ä¸ä¼šæ˜¾ç¤ºå‡ºç¦»å±æ¸²æŸ“ç»“æœ\nå°†ç¦»å±æ¸²æŸ“ç»“æœä½œä¸ºä¸€ä¸ªçº¹ç†ï¼Œä½œç”¨åœ¨é•œå­é¢ä¸Š\nä½¿ç”¨æ€»åœºæ™¯çš„æ¸²æŸ“å™¨ï¼Œå°†é•œå­æ¸²æŸ“åˆ°ç½‘é¡µä¸­\nè‡³æ­¤ï¼Œå®Œæˆæˆ‘ä»¬çš„ç›®æ ‡ã€‚\nå†è¯•æƒ³å¦å¤–ä¸€ä¸ªåº”ç”¨åœºæ™¯ï¼š\nä¸€è¾†æ±½è½¦ï¼Œæ±½è½¦çš„å€’è½¦é•œä¸­å¯ä»¥æ˜¾ç¤ºå‡ºæ±½è½¦åé¢çš„åœºæ™¯ï¼Œè¿™ä¹Ÿéœ€è¦ç”¨åˆ° ç¦»çº¿æ¸²æŸ“ã€‚\nç¦»å±æ¸²æŸ“ç¤ºä¾‹ï¼šHelloRenderTarget ç¤ºä¾‹ç›®æ ‡ åˆ›å»ºä¸€ä¸ª â€œå­åœºæ™¯â€ï¼Œå­åœºæ™¯ä¸­æœ‰ å…‰ã€é•œå¤´ã€3 ä¸ªä¸åŒé¢œè‰²çš„ç«‹æ–¹ä½“ åˆ›å»ºä¸€ä¸ª â€œæ€»åœºæ™¯â€ï¼Œæ€»åœºæ™¯ä¸­æœ‰ å…‰ã€é•œå¤´ã€1 ä¸ªå¹³é¢åœ†(é•œå­)ã€1ä¸ªç«‹æ–¹ä½“ åœ¨ æ€»åœºæ™¯ä¸­ï¼Œæ§åˆ¶å­åœºæ™¯ä¸­çš„ 3 ä¸ªç«‹æ–¹ä½“ï¼Œè®©ä»–ä»¬ä¸åœæ—‹è½¬ é€šè¿‡ç¦»å±æ¸²æŸ“ï¼Œå°†å­åœºæ™¯ä¸­çš„ â€œæ™¯è±¡â€ ä½œä¸ºå›¾ç‰‡çº¹ç†ï¼Œä½œç”¨åœ¨é•œå­å’Œç«‹æ–¹ä½“çš„6ä¸ªé¢ä¸Š ä»£ç æ€è·¯ åœºæ™¯æ­å»ºï¼š\nå­åœºæ™¯å’Œæ€»åœºæ™¯çš„åˆ›å»ºè¿‡ç¨‹ï¼Œæ¯”è¾ƒç®€å•ï¼Œä¸å†è¿‡å¤šè®²è¿°ã€‚\nç”±äºå­åœºæ™¯å’Œæ€»åœºæ™¯ä¸­éƒ½æœ‰ é•œå¤´ã€å…‰ã€ç«‹æ–¹ä½“è¿™äº›ï¼Œä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬åŒºåˆ†ï¼Œä¹Ÿä¸ºäº†è®©æˆ‘ä»¬ä»£ç æ›´åŠ ç®€å•æ¸…æ™°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå•ç‹¬åˆ›å»ºä¸€ä¸ª scr/components/hello-render-target/render-target-scene.ts çš„æ–‡ä»¶ï¼Œç”¨æ¥åˆ›å»ºå­åœºæ™¯ã€‚\næ³¨æ„ï¼šå­åœºæ™¯ä¸­ä¸éœ€è¦åˆ›å»ºæ¸²æŸ“å™¨\næˆ‘ä»¬è¯´çš„ æ€»åœºæ™¯ï¼Œå…¶å®å°±æ˜¯ HelloRenderTarget ç»„ä»¶æœ¬èº«\nå­åœºæ™¯éœ€è¦å¯¹å¤–æš´éœ²å‡º åœºæ™¯ã€ç«‹æ–¹ä½“ã€é•œå¤´ï¼š\nexport default { scene, boxs, camera } æ€»åœºæ™¯è·å–å­åœºæ™¯ä¸­çš„å…³é”®å…ƒç´ ï¼š\nimport * as RTScene from './render-target-scene' ... const rtScene = RTScene.default.scene const rtBoxs = RTScene.default.boxs const rtCamera = RTScene.default.camera åˆ›å»ºç¦»å±æ¸²æŸ“å¯¹è±¡\nconst rendererTarget = new Three.WebGLRenderTarget(512, 512) è¯·æ³¨æ„ï¼Œä¸Šé¢ä»£ç ä¸­è®¾ç½® ç¦»å±æ¸²æŸ“å¯¹è±¡çš„å°ºå¯¸ä¸º å®½ 512 åƒç´ ã€é«˜ 512 åƒç´ \nåˆ›å»ºæè´¨ï¼Œå¹¶å°†æè´¨çº¹ç†ä¸ç¦»å±æ¸²æŸ“å¯¹è±¡çš„æ¸²æŸ“ç»“æœçº¹ç†è¿›è¡Œç»‘å®š\nconst material = new Three.MeshPhongMaterial({ map: rendererTarget.texture }) ç”±äºç¦»å±æ¸²æŸ“å¯¹è±¡çš„æ¸²æŸ“å‡ºçš„çº¹ç†å°ºå¯¸ä¸º 512 X 512ï¼Œè¿™æ ·æ„å‘³ç€æˆ‘ä»¬åº”è¯¥å°†å­åœºæ™¯ä¸­çš„é•œå¤´å®½é«˜æ¯”(aspect) è®¾ç½®ä¸º 1\nåŒæ ·ï¼Œä¹Ÿæ„å‘³ç€æˆ‘ä»¬å°†æ¥ æ€»åœºæ™¯ä¸­çš„ ç‰©ä½“(é•œå­å’Œç«‹æ–¹ä½“) æ¸²æŸ“çš„é¢ å®½é«˜æ¯” ä¹Ÿåº”è¯¥æ˜¯ 1:1ã€‚\nè‹¥ç‰©ä½“æ¸²æŸ“çš„é¢ å®½é«˜æ¯”ä¸æ˜¯ 1:1ï¼Œé‚£ä¹ˆæœ€ç»ˆæ¸²æŸ“å‡ºçš„é¢ä¸Šçš„å›¾ç‰‡ä¼šå˜å½¢ã€‚\nä¿®æ”¹æ¸²æŸ“å™¨çš„æ¸²æŸ“ç›®æ ‡ï¼Œè®©æ¸²æŸ“å™¨å»æ¸²æŸ“ç¦»å±æ¸²æŸ“å¯¹è±¡ï¼Œå½“æ¸²æŸ“å®Œæˆåå†æ¸…é™¤(æ¢å¤)æ¸²æŸ“å™¨çš„æ¸²æŸ“ç›®æ ‡\nrenderer.setRenderTarget(rendererTarget) renderer.render(rtScene, rtCamera) renderer.setRenderTarget(null) è™½ç„¶æ¸²æŸ“å™¨çš„æ¸²æŸ“ç›®æ ‡æœ€ç»ˆåˆè¢«è®¾ç½®ä¸º nullï¼Œä½†æ˜¯ ç¦»å±æ¸²æŸ“çš„ç”»é¢æˆ‘ä»¬å·²ç»è·å¾—å¹¶ä¿å­˜åœ¨ rendererTarget ä¸­ã€‚\næœ€ç»ˆï¼Œåœ¨ä½¿ç”¨æ¸²æŸ“å™¨æŠŠé•œå­å’Œç«‹æ–¹ä½“è¿›è¡Œæ¸²æŸ“è¾“å‡º\nrenderer.render(scene, camera) è‡³æ­¤ï¼Œæ•´ä¸ªä»£ç å®Œæˆ\nç¤ºä¾‹ä»£ç  å­åœºæ™¯ï¼š\næ–‡ä»¶ä½äº scr/components/hello-render-target/render-target-scene.ts\nimport * as Three from 'three' const scene = new Three.Scene() scene.background = new Three.Color(0x00FFFF) const camera = new Three.PerspectiveCamera(45, 1, 0.1, 10) camera.position.z = 10 const light = new Three.DirectionalLight(0xFFFFFF, 1) light.position.set(0, 10, 10) scene.add(light) const colors = ['blue', 'red', 'green'] const boxs: Three.Mesh[] = [] colors.forEach((color, index) =\u003e { const mat = new Three.MeshPhongMaterial({ color }) const geo = new Three.BoxBufferGeometry(2, 2, 2) const mesh = new Three.Mesh(geo, mat) mesh.position.x = (index - 1) * 3 scene.add(mesh) boxs.push(mesh) }) export default { scene, boxs, camera } æ€»åœºæ™¯(HelloRenderTarget)ï¼š\næ–‡ä»¶ä½äº scr/components/hello-render-target/index.tsx\nimport { useEffect, useRef } from 'react' import * as Three from 'three' import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls' import * as RTScene from './render-target-scene' import './index.scss' const HelloRenderTarget = () =\u003e { const canvasRef = useRef(null) useEffect(() =\u003e { if (canvasRef.current === null) { return } const rtScene = RTScene.default.scene const rtBoxs = RTScene.default.boxs const rtCamera = RTScene.default.camera const renderer = new Three.WebGLRenderer({ canvas: canvasRef.current }) const rendererTarget = new Three.WebGLRenderTarget(512, 512) const scene = new Three.Scene() scene.background = new Three.Color(0x333333) const light = new Three.DirectionalLight(0xFFFFFF, 1) light.position.set(0, 10, 10) light.target.position.set(-2, 2, 2) scene.add(light) scene.add(light.target) const camera = new Three.PerspectiveCamera(45, 2, 0.1, 100) camera.position.z = 15 const controls = new OrbitControls(camera, canvasRef.current) controls.update() const material = new Three.MeshPhongMaterial({ map: rendererTarget.texture }) const cubeGeo = new Three.BoxBufferGeometry(4, 4, 4) const cubeMesh = new Three.Mesh(cubeGeo, material) cubeMesh.position.x = 4 scene.add(cubeMesh) const circleGeo = new Three.CircleBufferGeometry(2.8, 36) const circleMesh = new Three.Mesh(circleGeo, material) circleMesh.position.x = -4 scene.add(circleMesh) const render = (time: number) =\u003e { time *= 0.001 rtBoxs.forEach((item) =\u003e { item.rotation.set(time, time, 0) }) renderer.setRenderTarget(rendererTarget) renderer.render(rtScene, rtCamera) renderer.setRenderTarget(null) cubeMesh.rotation.set(time, time, 0) renderer.render(scene, camera) window.requestAnimationFrame(render) } window.requestAnimationFrame(render) const handleResize = () =\u003e { if (canvasRef.current === null) { return } const width = canvasRef.current.clientWidth const height = canvasRef.current.clientHeight camera.aspect = width / height camera.updateProjectionMatrix() renderer.setSize(width, height, false) } handleResize() window.addEventListener('resize', handleResize) return () =\u003e { window.removeEventListener('resize', handleResize) } }, [canvasRef]) return ( ) } export default HelloRenderTarget è¡¥å……ä¸€ä¸‹ï¼šä¸Šé¢ä»£ç ä¸­å…³äºç¯å…‰çš„ä½ç½®ã€ç¯å…‰ç›®æ ‡çš„ä½ç½®ã€é•œå¤´çš„ä½ç½®ã€ç«‹æ–¹ä½“çš„ä½ç½® éƒ½æ˜¯æˆ‘éšæ‰‹ å¡«ä¸Šçš„ï¼Œå¹¶æ²¡æœ‰ç‰¹åˆ«çš„å«ä¹‰ï¼Œä½ å®Œå…¨å¯ä»¥é€‚å½“ä¿®æ”¹ä¸€ä¸‹ã€‚\nå‘å¸ƒè¿è¡Œï¼Œå°±ä¼šåœ¨ç½‘é¡µä¸­çœ‹åˆ° é•œå­çš„ 1 ä¸ªé¢ã€ç«‹æ–¹ä½“çš„ 6 ä¸ªé¢ ä¸Š æ˜¾ç¤ºç€ 3 ä¸ªä¸åœæ—‹è½¬çš„ç«‹æ–¹ä½“ã€‚\nè¡¥å……è¯´æ˜1 åœ¨ä¸Šè¿°ç¤ºä¾‹ä»£ç ä¸­ï¼Œç¦»çº¿æ¸²æŸ“ç›®æ ‡çš„å°ºå¯¸æˆ‘è®¾ç½®çš„å®½é«˜å‡ä¸º 512ï¼Œä½ å®Œå…¨å¯ä»¥è®¾ç½®æˆå…¶ä»–æ¯”ä¾‹çš„å€¼ã€‚\nä½†æ˜¯ä¸ºäº†ç”»é¢ä¸å‡ºç°å˜å½¢å†…å®¹ï¼Œæ‰€ä»¥è¦éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š\nç¦»çº¿æ¸²æŸ“ç›®æ ‡çš„å®½é«˜æ¯”ã€å­åœºæ™¯ä¸­é•œå¤´çš„å®½é«˜æ¯”ã€æ€»åœºæ™¯ä¸­ç‰©ä½“è¢«æ¸²æŸ“çš„é¢çš„å®½é«˜æ¯”ï¼Œè¿™ 3 è€…è¦ä¿æŒä¸€è‡´ï¼Œè¿™æ ·å°±ä¸ä¼šå˜å½¢ã€‚\nå‡è®¾ä½ æƒ³åœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¿®æ”¹ ç¦»çº¿æ¸²æŸ“ç›®æ ‡çš„å®½é«˜ã€ä»¥åŠå­åœºæ™¯ä¸­é•œå¤´çš„å®½é«˜æ¯”ï¼Œå…¶æ“ä½œæ–¹å¼å’Œä¿®æ”¹æ™®é€šçš„æ¸²æŸ“å™¨æˆ–é•œå¤´æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ä¾‹å¦‚ï¼š\nrenderTarget.setSize(newWidth,newHeight) rtCamera.aspect = newWidth/newHeight rtCamera.updateProjectionMatrix() è¡¥å……è¯´æ˜2ï¼š3Dç»˜åˆ¶ä¸­çš„ 4 å¤§æ•°æ®ç¼“å†² é¢œè‰²ç¼“å†²ï¼š åƒç´ ç¼“å†²ï¼š æ·±åº¦ç¼“å†²ï¼šdepth buffer æ¨¡æ¿ç¼“å†²ï¼šstencil buffer stencilBuffer åˆè¢«ç§°ä¸º å°æ¨¡ç¼“å†²\næ¨¡æ¿(stencil)ä¸æ¨¡æ¿(template)çš„å·®å¼‚ä¹‹å¤„ï¼š\nå•è¯ stencil å’Œ template éƒ½å¯ä»¥è¢«ç¿»è¯‘ä¸º æ¨¡æ¿ï¼Œä½†æ˜¯ä»–ä»¬ 2 è€…å«ä¹‰æ˜¯æœ‰åŒºåˆ«çš„ã€‚\né¦–å…ˆè¿™ 2 ä¸ªå•è¯éƒ½æ˜¯æ¥æºä»¥ å°åˆ·ã€‚\næ¨¡æ¿(template)ï¼šå½¢æ¨¡ï¼Œä¾‹å¦‚é€šè¿‡ä¿®å‰ª æœ¨æ¿æˆ–é’¢æ¿ çš„å¤–å½¢ï¼Œä»¥æ­¤å¤–å½¢æ¥è¿›è¡Œå°åˆ·\næ¨¡æ¿(stencil)ï¼šå°æ¨¡ï¼Œå¦å¤–ä¸€ç§å°åˆ·æŠ€æœ¯ï¼Œä¾‹å¦‚é€šè¿‡èœ¡çº¸æ¥å°åˆ·\nä½ æŠŠ å°æ¨¡ ä¸ å½¢æ¨¡ ç†è§£æˆ 2 ç§ ä¸åŒçš„å°åˆ·æ–¹å¼å³å¯\nä¿å­˜ æ¸²æŸ“ç›®æ ‡å¯¹åº”çš„ å›¾ç‰‡çº¹ç†ä¹‹å¤–ï¼Œè¿˜ä¼šé¢å¤–åˆ›å»º é¢œè‰²çº¹ç† å’Œ æ·±åº¦æ¨¡æ¿çº¹ç† ç¦»å±æ¸²æŸ“ç›®æ ‡ é™¤äº†å¾—åˆ°å¹¶ä¿å­˜ æ¸²æŸ“ç›®æ ‡å¯¹åº”çš„ å›¾ç‰‡çº¹ç†ä¹‹å¤–ï¼Œè¿˜ä¼šé¢å¤–åˆ›å»º é¢œè‰²çº¹ç† å’Œ æ·±åº¦æ¨¡æ¿çº¹ç†ã€‚\nå›¾ç‰‡çº¹ç†ä¸­ï¼Œå°±ä½¿ç”¨åˆ°äº† åƒç´ ç¼“å†²\nåƒæˆ‘ä»¬ä¸Šé¢ç¤ºä¾‹ä¸­æ ¹æœ¬å°±ç”¨ä¸åˆ° æ·±åº¦ç¼“å†²ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ ç¦»å±æ¸²æŸ“ç›®æ ‡åˆå§‹åŒ–çš„æ—¶å€™ï¼Œç›´æ¥è®¾ç½® ä¸éœ€è¦åˆ›å»º æ·±åº¦ç¼“å†² å’Œ æ¨¡æ¿ç¼“å†²ï¼Œä»¥èŠ‚çœæ€§èƒ½ã€‚\nconst rendererTarget = new Three.WebGLRenderTarget(512, 512,{ depthBuffer:false, stencilBuffer:false }) è¡¥å……è¯´æ˜ï¼š\ndepthBufferï¼šæ·±åº¦ç¼“å­˜ã€é»˜è®¤å€¼ä¸º true stencilBufferï¼šæ¨¡æ¿ç¼“å†²ï¼Œé»˜è®¤å€¼ä¸º false å…³äºä¸Šè¿° è¡¥å……è¯´æ˜2 ã€è¡¥å……è¯´æ˜3 ä¸­çš„å‡ ä¸ªç¼“å†²ï¼Œæˆ‘ä¸ªäººç†è§£ä¹Ÿä¸å¤Ÿæ·±ï¼Œä¸å¤Ÿé€å½»ï¼Œè§‚ç‚¹ä»…ä¾›å‚è€ƒã€‚\nè‡³æ­¤ï¼Œç¦»çº¿æ¸²æŸ“ è®²è§£å®Œæ¯•ã€‚\nä»Šå¤©æ˜¯ 2020å¹´æœ€åä¸€å¤©ï¼Œå¤§å®¶å…ƒæ—¦å¿«ä¹ã€‚\nå…ƒæ—¦è¿‡åï¼Œæˆ‘ä»¬å°†å¼€å§‹å­¦ä¹  Three.js åŸºç¡€ä¸­æœ€å 2 ä¸ªçŸ¥è¯†ï¼šè‡ªå®šä¹‰å‡ ä½•ä½“(current Geometry)ã€è‡ªå®šä¹‰ç¼“å†²å‡ ä½•ä½“(current buffer geometry)\n","wordCount":"2888","inLanguage":"en","datePublished":"2023-12-19T17:11:35+08:00","dateModified":"2023-12-19T17:11:35+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://bablvsj.github.io/posts/threejs/15-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%A6%BB%E5%B1%8F%E6%B8%B2%E6%9F%93/"},"publisher":{"@type":"Organization","name":"Bablvsj's Blog","logo":{"@type":"ImageObject","url":"https://bablvsj.github.io/img/Q.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bablvsj.github.io accesskey=h title="Bablvsj's Blog (Alt + H)">Bablvsj's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bablvsj.github.io/ title=ä¸»é¡µ><span>ä¸»é¡µ</span></a></li><li><a href=https://bablvsj.github.io/archives/ title=æ—¶é—´è½´><span>æ—¶é—´è½´</span></a></li><li><a href=https://bablvsj.github.io/tags title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://bablvsj.github.io/about title=å…³äº><span>å…³äº</span></a></li><li><a href=https://bablvsj.github.io/search title="ğŸ” (Alt + /)" accesskey=/><span>ğŸ”</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>15 Three.jsåŸºç¡€ä¹‹ç¦»å±æ¸²æŸ“</h1><div class=post-meta><div class=post-tags-meta><a href=https://bablvsj.github.io/tags/three.js/>Three.js</a></div>6 min&nbsp;Â·&nbsp;<span title='2023-12-19 17:11:35 +0800 +0800'>2023/12/19</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><div class=inner><ul><li><a href=#render-targets%e7%a6%bb%e5%b1%8f%e6%b8%b2%e6%9f%93%e7%ae%80%e4%bb%8b aria-label="Render Targets(ç¦»å±æ¸²æŸ“)ç®€ä»‹">Render Targets(ç¦»å±æ¸²æŸ“)ç®€ä»‹</a><ul><ul><li><a href=#%e5%90%8d%e8%af%8d%e8%a7%a3%e9%87%8arender-targets aria-label="åè¯è§£é‡Šï¼šRender Targets">åè¯è§£é‡Šï¼šRender Targets</a></li><li><a href=#%e7%a6%bb%e5%b1%8f%e6%b8%b2%e6%9f%93%e6%a6%82%e5%bf%b5%e8%a7%a3%e9%87%8a aria-label=ç¦»å±æ¸²æŸ“æ¦‚å¿µè§£é‡Š>ç¦»å±æ¸²æŸ“æ¦‚å¿µè§£é‡Š</a></li><li><a href=#%e7%a6%bb%e5%b1%8f%e6%b8%b2%e6%9f%93%e7%9a%84%e7%a7%8d%e7%b1%bb aria-label=ç¦»å±æ¸²æŸ“çš„ç§ç±»>ç¦»å±æ¸²æŸ“çš„ç§ç±»</a></li><li><a href=#%e7%a6%bb%e5%b1%8f%e6%b8%b2%e6%9f%93%e7%9a%84%e7%94%a8%e9%80%94 aria-label=ç¦»å±æ¸²æŸ“çš„ç”¨é€”>ç¦»å±æ¸²æŸ“çš„ç”¨é€”</a></li></ul></ul></li><li><a href=#%e7%a6%bb%e5%b1%8f%e6%b8%b2%e6%9f%93%e7%a4%ba%e4%be%8bhellorendertarget aria-label=ç¦»å±æ¸²æŸ“ç¤ºä¾‹ï¼šHelloRenderTarget>ç¦»å±æ¸²æŸ“ç¤ºä¾‹ï¼šHelloRenderTarget</a><ul><ul><li><a href=#%e7%a4%ba%e4%be%8b%e7%9b%ae%e6%a0%87 aria-label=ç¤ºä¾‹ç›®æ ‡>ç¤ºä¾‹ç›®æ ‡</a></li><li><a href=#%e4%bb%a3%e7%a0%81%e6%80%9d%e8%b7%af aria-label=ä»£ç æ€è·¯>ä»£ç æ€è·¯</a></li><li><a href=#%e7%a4%ba%e4%be%8b%e4%bb%a3%e7%a0%81 aria-label=ç¤ºä¾‹ä»£ç >ç¤ºä¾‹ä»£ç </a></li><li><a href=#%e8%a1%a5%e5%85%85%e8%af%b4%e6%98%8e1 aria-label=è¡¥å……è¯´æ˜1>è¡¥å……è¯´æ˜1</a></li><li><a href=#%e8%a1%a5%e5%85%85%e8%af%b4%e6%98%8e23d%e7%bb%98%e5%88%b6%e4%b8%ad%e7%9a%84-4-%e5%a4%a7%e6%95%b0%e6%8d%ae%e7%bc%93%e5%86%b2 aria-label="è¡¥å……è¯´æ˜2ï¼š3Dç»˜åˆ¶ä¸­çš„ 4 å¤§æ•°æ®ç¼“å†²">è¡¥å……è¯´æ˜2ï¼š3Dç»˜åˆ¶ä¸­çš„ 4 å¤§æ•°æ®ç¼“å†²</a></li><li><a href=#%e4%bf%9d%e5%ad%98-%e6%b8%b2%e6%9f%93%e7%9b%ae%e6%a0%87%e5%af%b9%e5%ba%94%e7%9a%84-%e5%9b%be%e7%89%87%e7%ba%b9%e7%90%86%e4%b9%8b%e5%a4%96%e8%bf%98%e4%bc%9a%e9%a2%9d%e5%a4%96%e5%88%9b%e5%bb%ba-%e9%a2%9c%e8%89%b2%e7%ba%b9%e7%90%86-%e5%92%8c-%e6%b7%b1%e5%ba%a6%e6%a8%a1%e6%9d%bf%e7%ba%b9%e7%90%86 aria-label="ä¿å­˜ æ¸²æŸ“ç›®æ ‡å¯¹åº”çš„ å›¾ç‰‡çº¹ç†ä¹‹å¤–ï¼Œè¿˜ä¼šé¢å¤–åˆ›å»º é¢œè‰²çº¹ç† å’Œ æ·±åº¦æ¨¡æ¿çº¹ç†">ä¿å­˜ æ¸²æŸ“ç›®æ ‡å¯¹åº”çš„ å›¾ç‰‡çº¹ç†ä¹‹å¤–ï¼Œè¿˜ä¼šé¢å¤–åˆ›å»º é¢œè‰²çº¹ç† å’Œ æ·±åº¦æ¨¡æ¿çº¹ç†</a></li></ul></ul></li></ul></div></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=render-targetsç¦»å±æ¸²æŸ“ç®€ä»‹>Render Targets(ç¦»å±æ¸²æŸ“)ç®€ä»‹<a hidden class=anchor aria-hidden=true href=#render-targetsç¦»å±æ¸²æŸ“ç®€ä»‹>#</a></h2><h4 id=åè¯è§£é‡Šrender-targets>åè¯è§£é‡Šï¼šRender Targets<a hidden class=anchor aria-hidden=true href=#åè¯è§£é‡Šrender-targets>#</a></h4><p><strong>ä»å­—é¢ä¸Šç›´æ¥ç¿»è¯‘ï¼Œâ€œRender Targetsâ€ åº”è¯¥ç¿»è¯‘ä¸º â€œæ¸²æŸ“ç›®æ ‡â€ã€‚</strong></p><p><strong>ä»å®é™…ä½œç”¨ä¸Šç¿»è¯‘ï¼Œâ€Render Targetsâ€œ åº”è¯¥ç¿»è¯‘ä¸º â€ç¦»å±æ¸²æŸ“ç›®æ ‡ æˆ– ç¦»å±æ¸²æŸ“å¯¹è±¡â€œã€‚</strong></p><blockquote><p>å›½å†…ç»å¤§å¤šæ•° Three.js æ•™ç¨‹éƒ½æŠŠ Render Targets ç¿»è¯‘ä¸º ç¦»å±æ¸²æŸ“ã€‚</p><p>æˆ‘ä¸ªäººè®¤ä¸ºç¿»è¯‘æˆï¼šç¦»å±æ¸²æŸ“ç›®æ ‡ æ›´ä¸ºåˆé€‚ï¼Œä½†æœ‰æ—¶æˆ‘ä¼šä¸è‡ªè§‰ä½¿ç”¨ ç¦»çº¿æ¸²æŸ“å¯¹è±¡ è¿™ä¸ªè¯ï¼Œæ‰€ä»¥ä½ åªéœ€è¦æ˜ç™½ è™½ç„¶ç§°å‘¼ä¸åŒï¼Œä½†æŒ‡å‘çš„éƒ½æ˜¯åŒä¸€ä¸ªä¸œè¥¿ã€‚</p></blockquote><h4 id=ç¦»å±æ¸²æŸ“æ¦‚å¿µè§£é‡Š>ç¦»å±æ¸²æŸ“æ¦‚å¿µè§£é‡Š<a hidden class=anchor aria-hidden=true href=#ç¦»å±æ¸²æŸ“æ¦‚å¿µè§£é‡Š>#</a></h4><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆè¯´ä¸€ä¸‹ æ™®é€šçš„â€œæ¸²æŸ“â€ã€‚</p><p>ä¹‹å‰ç¤ºä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨çš„æ¸²æŸ“å™¨éƒ½æ˜¯ WebGLRendererã€‚æˆ‘ä»¬åˆ›å»ºçš„æ¸²æŸ“å™¨å®ä¾‹ renderer ä¼šæ ¹æ® åœºæ™¯(å«åœºæ™¯ä¸­çš„ç‰©ä½“)ã€ç¯å…‰ æ¥å°†è§†è§‰ç»“æœæ¸²æŸ“åˆ°ç½‘é¡µä¸­ã€‚</p><p>æ­¤æ—¶çš„ æ¸²æŸ“ å°±æ˜¯æ™®é€šçš„æ¸²æŸ“ï¼Œæ¸²æŸ“ç»“æœç›´æ¥å‡ºç°åœ¨ç½‘é¡µä¸­ã€‚</p><p><strong>é‚£ä»€ä¹ˆåˆæ˜¯ç¦»å±æ¸²æŸ“ï¼Ÿ</strong></p><p>ç­”ï¼šæ¸²æŸ“å™¨ä¼šæ¸²æŸ“åœºæ™¯ï¼Œä½†æ˜¯ä¸ä¼šå§æ¸²æŸ“ç»“æœç›´æ¥å‘ˆç°åœ¨ç½‘é¡µä¸­ï¼Œè€Œæ˜¯æŠŠæ¸²æŸ“ç»“æœä¿å­˜åˆ° GPU å†…éƒ¨ä¸­ã€‚</p><p>æ­¤æ—¶ æš‚å­˜åˆ° GPU ä¸­çš„æ¸²æŸ“ç»“æœ(å›¾ç‰‡)ï¼Œå¯ä»¥è¢«å½“åšä¸€ç§çº¹ç†(texture)ï¼Œä½¿ç”¨åˆ°å…¶ä»–ç‰©ä½“ä¸­ã€‚</p><p>ç¦»å±æ¸²æŸ“ å’Œ æ­£å¸¸æ¸²æŸ“ æ•´ä¸ªè®¡ç®—è¿‡ç¨‹å®Œå…¨ç›¸åŒï¼Œä¸åŒçš„åœ°æ–¹åœ¨äº ç¦»å±æ¸²æŸ“ çš„ç»“æœæ˜¯ä¿å­˜åœ¨ GPU å†…å­˜ä¸­ï¼Œè€Œéç›´æ¥æ˜¾ç¤ºåœ¨ç½‘é¡µä¸­ã€‚</p><h4 id=ç¦»å±æ¸²æŸ“çš„ç§ç±»>ç¦»å±æ¸²æŸ“çš„ç§ç±»<a hidden class=anchor aria-hidden=true href=#ç¦»å±æ¸²æŸ“çš„ç§ç±»>#</a></h4><p>åœ¨ Three.js ä¸­ï¼Œä¸€å…±æœ‰ 3 ç§ç¦»å±æ¸²æŸ“ç±»å‹ã€‚</p><table><thead><tr><th>ç¦»å±æ¸²æŸ“ç±»å‹</th><th>åç§°åŠè§£é‡Š</th></tr></thead><tbody><tr><td>WebGLMultisampleRenderTarget</td><td>WebGL 2 å¯¹åº”çš„ç¦»å±æ¸²æŸ“</td></tr><tr><td>WebGLRenderTarget</td><td>WebGLRender å¯¹åº”çš„ç¦»å±æ¸²æŸ“</td></tr><tr><td>WebGLCubeRenderTarget</td><td>CubeCamera å¯¹åº”çš„ç¦»å±æ¸²æŸ“</td></tr></tbody></table><h4 id=ç¦»å±æ¸²æŸ“çš„ç”¨é€”>ç¦»å±æ¸²æŸ“çš„ç”¨é€”<a hidden class=anchor aria-hidden=true href=#ç¦»å±æ¸²æŸ“çš„ç”¨é€”>#</a></h4><p>å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šåœºæ™¯ä¸­æœ‰ 3 ä¸ªä¸åŒé¢œè‰²ã€ä¸åœè½¬åŠ¨çš„ç«‹æ–¹ä½“ã€‚</p><p>æˆ‘ä»¬ä¹‹å‰ç¤ºä¾‹ä¸­ä¼šä½¿ç”¨ WebGLRenderer ï¼ŒæŠŠè¿™ä¸ªåœºæ™¯ç”»é¢å†…å®¹æ¸²æŸ“åˆ°ç½‘é¡µä¸­ï¼Œè¿™å±äºæ­£å¸¸çš„æ¸²æŸ“ã€‚</p><p>è‹¥æˆ‘ä»¬ç°åœ¨æ”¹å˜éœ€æ±‚ï¼Œæˆ‘ä»¬å¸Œæœ›ä¿®æ”¹æˆï¼š</p><ol><li>åœºæ™¯ä¸­æœ‰ä¸€é¢é•œå­</li><li>åœ¨é•œå­ä¸­æ˜¾ç¤ºå‡º 3 ä¸ªä¸åŒé¢œè‰²ã€ä¸åŒæ—‹è½¬çš„ç«‹æ–¹ä½“</li><li>åœºæ™¯æœ¬èº«å½“ä¸­ï¼Œæ˜¯çœ‹ä¸è§è¿™ 3 ä¸ªç«‹æ–¹ä½“çš„</li></ol><p>ä¸ºäº†å®ç°è¿™ä¸ªéœ€æ±‚ï¼Œæˆ‘ä»¬æ­¤æ—¶å°±éœ€è¦ç”¨åˆ° ç¦»å±æ¸²æŸ“ã€‚</p><p>å…·ä½“åšæ³•æ˜¯ï¼š</p><ol><li><p>åˆ›å»ºä¸€ä¸ªå­åœºæ™¯ï¼Œè¯¥å­åœºæ™¯ä¸­ æœ‰ 3 ä¸ªä¸åŒé¢œè‰²ã€ä¸åœæ—‹è½¬çš„ç«‹æ–¹ä½“</p></li><li><p>åˆ›å»ºä¸€ä¸ªæ€»åœºæ™¯ã€ä¸€ä¸ªæ¸²æŸ“å™¨ï¼Œä¸€é¢é•œå­</p></li><li><p>ä½¿ç”¨æ€»åœºæ™¯çš„æ¸²æŸ“å™¨ï¼Œå¯¹å­åœºæ™¯è¿›è¡Œæ¸²æŸ“ï¼Œå¾—åˆ°ä¸€ä¸ªç¦»å±æ¸²æŸ“ç»“æœ(å›¾åƒçº¹ç†)</p><blockquote><p>æ³¨æ„ï¼šç”±äºæ˜¯ç¦»å±æ¸²æŸ“ï¼Œåªæ˜¯å°† 3 ä¸ªç«‹æ–¹ä½“æ¸²æŸ“å‡ºçš„è§†è§‰æ•ˆæœä¿å­˜åˆ° GPU å†…å­˜ä¸­ï¼Œç½‘é¡µä¸­å¹¶ä¸ä¼šæ˜¾ç¤ºå‡ºç¦»å±æ¸²æŸ“ç»“æœ</p></blockquote></li><li><p>å°†ç¦»å±æ¸²æŸ“ç»“æœä½œä¸ºä¸€ä¸ªçº¹ç†ï¼Œä½œç”¨åœ¨é•œå­é¢ä¸Š</p></li><li><p>ä½¿ç”¨æ€»åœºæ™¯çš„æ¸²æŸ“å™¨ï¼Œå°†é•œå­æ¸²æŸ“åˆ°ç½‘é¡µä¸­</p><blockquote><p>è‡³æ­¤ï¼Œå®Œæˆæˆ‘ä»¬çš„ç›®æ ‡ã€‚</p></blockquote></li></ol><p><strong>å†è¯•æƒ³å¦å¤–ä¸€ä¸ªåº”ç”¨åœºæ™¯ï¼š</strong></p><p>ä¸€è¾†æ±½è½¦ï¼Œæ±½è½¦çš„å€’è½¦é•œä¸­å¯ä»¥æ˜¾ç¤ºå‡ºæ±½è½¦åé¢çš„åœºæ™¯ï¼Œè¿™ä¹Ÿéœ€è¦ç”¨åˆ° ç¦»çº¿æ¸²æŸ“ã€‚</p><h2 id=ç¦»å±æ¸²æŸ“ç¤ºä¾‹hellorendertarget>ç¦»å±æ¸²æŸ“ç¤ºä¾‹ï¼šHelloRenderTarget<a hidden class=anchor aria-hidden=true href=#ç¦»å±æ¸²æŸ“ç¤ºä¾‹hellorendertarget>#</a></h2><h4 id=ç¤ºä¾‹ç›®æ ‡>ç¤ºä¾‹ç›®æ ‡<a hidden class=anchor aria-hidden=true href=#ç¤ºä¾‹ç›®æ ‡>#</a></h4><ol><li>åˆ›å»ºä¸€ä¸ª â€œå­åœºæ™¯â€ï¼Œå­åœºæ™¯ä¸­æœ‰ å…‰ã€é•œå¤´ã€3 ä¸ªä¸åŒé¢œè‰²çš„ç«‹æ–¹ä½“</li><li>åˆ›å»ºä¸€ä¸ª â€œæ€»åœºæ™¯â€ï¼Œæ€»åœºæ™¯ä¸­æœ‰ å…‰ã€é•œå¤´ã€1 ä¸ªå¹³é¢åœ†(é•œå­)ã€1ä¸ªç«‹æ–¹ä½“</li><li>åœ¨ æ€»åœºæ™¯ä¸­ï¼Œæ§åˆ¶å­åœºæ™¯ä¸­çš„ 3 ä¸ªç«‹æ–¹ä½“ï¼Œè®©ä»–ä»¬ä¸åœæ—‹è½¬</li><li>é€šè¿‡ç¦»å±æ¸²æŸ“ï¼Œå°†å­åœºæ™¯ä¸­çš„ â€œæ™¯è±¡â€ ä½œä¸ºå›¾ç‰‡çº¹ç†ï¼Œä½œç”¨åœ¨é•œå­å’Œç«‹æ–¹ä½“çš„6ä¸ªé¢ä¸Š</li></ol><h4 id=ä»£ç æ€è·¯>ä»£ç æ€è·¯<a hidden class=anchor aria-hidden=true href=#ä»£ç æ€è·¯>#</a></h4><p><strong>åœºæ™¯æ­å»ºï¼š</strong></p><p>å­åœºæ™¯å’Œæ€»åœºæ™¯çš„åˆ›å»ºè¿‡ç¨‹ï¼Œæ¯”è¾ƒç®€å•ï¼Œä¸å†è¿‡å¤šè®²è¿°ã€‚</p><p>ç”±äºå­åœºæ™¯å’Œæ€»åœºæ™¯ä¸­éƒ½æœ‰ é•œå¤´ã€å…‰ã€ç«‹æ–¹ä½“è¿™äº›ï¼Œä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬åŒºåˆ†ï¼Œä¹Ÿä¸ºäº†è®©æˆ‘ä»¬ä»£ç æ›´åŠ ç®€å•æ¸…æ™°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå•ç‹¬åˆ›å»ºä¸€ä¸ª scr/components/hello-render-target/render-target-scene.ts çš„æ–‡ä»¶ï¼Œç”¨æ¥åˆ›å»ºå­åœºæ™¯ã€‚</p><blockquote><p>æ³¨æ„ï¼šå­åœºæ™¯ä¸­ä¸éœ€è¦åˆ›å»ºæ¸²æŸ“å™¨</p></blockquote><blockquote><p>æˆ‘ä»¬è¯´çš„ æ€»åœºæ™¯ï¼Œå…¶å®å°±æ˜¯ HelloRenderTarget ç»„ä»¶æœ¬èº«</p></blockquote><p>å­åœºæ™¯éœ€è¦å¯¹å¤–æš´éœ²å‡º åœºæ™¯ã€ç«‹æ–¹ä½“ã€é•œå¤´ï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>export default {
</span></span><span style=display:flex><span>    scene,
</span></span><span style=display:flex><span>    boxs,
</span></span><span style=display:flex><span>    camera
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æ€»åœºæ™¯è·å–å­åœºæ™¯ä¸­çš„å…³é”®å…ƒç´ ï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>import * as RTScene from &#39;./render-target-scene&#39;
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>const rtScene = RTScene.default.scene
</span></span><span style=display:flex><span>const rtBoxs = RTScene.default.boxs
</span></span><span style=display:flex><span>const rtCamera = RTScene.default.camera
</span></span></code></pre></div><p><strong>åˆ›å»ºç¦»å±æ¸²æŸ“å¯¹è±¡</strong></p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>const rendererTarget = new Three.WebGLRenderTarget(512, 512)
</span></span></code></pre></div><blockquote><p>è¯·æ³¨æ„ï¼Œä¸Šé¢ä»£ç ä¸­è®¾ç½® ç¦»å±æ¸²æŸ“å¯¹è±¡çš„å°ºå¯¸ä¸º å®½ 512 åƒç´ ã€é«˜ 512 åƒç´ </p></blockquote><p><strong>åˆ›å»ºæè´¨ï¼Œå¹¶å°†æè´¨çº¹ç†ä¸ç¦»å±æ¸²æŸ“å¯¹è±¡çš„æ¸²æŸ“ç»“æœçº¹ç†è¿›è¡Œç»‘å®š</strong></p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>const material = new Three.MeshPhongMaterial({
</span></span><span style=display:flex><span>    map: rendererTarget.texture
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><blockquote><p>ç”±äºç¦»å±æ¸²æŸ“å¯¹è±¡çš„æ¸²æŸ“å‡ºçš„çº¹ç†å°ºå¯¸ä¸º 512 X 512ï¼Œè¿™æ ·æ„å‘³ç€æˆ‘ä»¬åº”è¯¥å°†å­åœºæ™¯ä¸­çš„é•œå¤´å®½é«˜æ¯”(aspect) è®¾ç½®ä¸º 1</p></blockquote><blockquote><p>åŒæ ·ï¼Œä¹Ÿæ„å‘³ç€æˆ‘ä»¬å°†æ¥ æ€»åœºæ™¯ä¸­çš„ ç‰©ä½“(é•œå­å’Œç«‹æ–¹ä½“) æ¸²æŸ“çš„é¢ å®½é«˜æ¯” ä¹Ÿåº”è¯¥æ˜¯ 1:1ã€‚</p><p>è‹¥ç‰©ä½“æ¸²æŸ“çš„é¢ å®½é«˜æ¯”ä¸æ˜¯ 1:1ï¼Œé‚£ä¹ˆæœ€ç»ˆæ¸²æŸ“å‡ºçš„é¢ä¸Šçš„å›¾ç‰‡ä¼šå˜å½¢ã€‚</p></blockquote><p><strong>ä¿®æ”¹æ¸²æŸ“å™¨çš„æ¸²æŸ“ç›®æ ‡ï¼Œè®©æ¸²æŸ“å™¨å»æ¸²æŸ“ç¦»å±æ¸²æŸ“å¯¹è±¡ï¼Œå½“æ¸²æŸ“å®Œæˆåå†æ¸…é™¤(æ¢å¤)æ¸²æŸ“å™¨çš„æ¸²æŸ“ç›®æ ‡</strong></p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>renderer.setRenderTarget(rendererTarget)
</span></span><span style=display:flex><span>renderer.render(rtScene, rtCamera)
</span></span><span style=display:flex><span>renderer.setRenderTarget(null)
</span></span></code></pre></div><blockquote><p>è™½ç„¶æ¸²æŸ“å™¨çš„æ¸²æŸ“ç›®æ ‡æœ€ç»ˆåˆè¢«è®¾ç½®ä¸º nullï¼Œä½†æ˜¯ ç¦»å±æ¸²æŸ“çš„ç”»é¢æˆ‘ä»¬å·²ç»è·å¾—å¹¶ä¿å­˜åœ¨ rendererTarget ä¸­ã€‚</p></blockquote><p><strong>æœ€ç»ˆï¼Œåœ¨ä½¿ç”¨æ¸²æŸ“å™¨æŠŠé•œå­å’Œç«‹æ–¹ä½“è¿›è¡Œæ¸²æŸ“è¾“å‡º</strong></p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>renderer.render(scene, camera)
</span></span></code></pre></div><blockquote><p>è‡³æ­¤ï¼Œæ•´ä¸ªä»£ç å®Œæˆ</p></blockquote><h4 id=ç¤ºä¾‹ä»£ç >ç¤ºä¾‹ä»£ç <a hidden class=anchor aria-hidden=true href=#ç¤ºä¾‹ä»£ç >#</a></h4><p><strong>å­åœºæ™¯ï¼š</strong></p><p>æ–‡ä»¶ä½äº scr/components/hello-render-target/render-target-scene.ts</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>import * as Three from &#39;three&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>const scene = new Three.Scene()
</span></span><span style=display:flex><span>scene.background = new Three.Color(0x00FFFF)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>const camera = new Three.PerspectiveCamera(45, 1, 0.1, 10)
</span></span><span style=display:flex><span>camera.position.z = 10
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>const light = new Three.DirectionalLight(0xFFFFFF, 1)
</span></span><span style=display:flex><span>light.position.set(0, 10, 10)
</span></span><span style=display:flex><span>scene.add(light)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>const colors = [&#39;blue&#39;, &#39;red&#39;, &#39;green&#39;]
</span></span><span style=display:flex><span>const boxs: Three.Mesh[] = []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>colors.forEach((color, index) =&gt; {
</span></span><span style=display:flex><span>    const mat = new Three.MeshPhongMaterial({ color })
</span></span><span style=display:flex><span>    const geo = new Three.BoxBufferGeometry(2, 2, 2)
</span></span><span style=display:flex><span>    const mesh = new Three.Mesh(geo, mat)
</span></span><span style=display:flex><span>    mesh.position.x = (index - 1) * 3
</span></span><span style=display:flex><span>    scene.add(mesh)
</span></span><span style=display:flex><span>    boxs.push(mesh)
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>export default {
</span></span><span style=display:flex><span>    scene,
</span></span><span style=display:flex><span>    boxs,
</span></span><span style=display:flex><span>    camera
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>æ€»åœºæ™¯(HelloRenderTarget)ï¼š</strong></p><p>æ–‡ä»¶ä½äº scr/components/hello-render-target/index.tsx</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>import { useEffect, useRef } from &#39;react&#39;
</span></span><span style=display:flex><span>import * as Three from &#39;three&#39;
</span></span><span style=display:flex><span>import { OrbitControls } from &#39;three/examples/jsm/controls/OrbitControls&#39;
</span></span><span style=display:flex><span>import * as RTScene from &#39;./render-target-scene&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>import &#39;./index.scss&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>const HelloRenderTarget = () =&gt; {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    const canvasRef = useRef&lt;HTMLCanvasElement&gt;(null)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    useEffect(() =&gt; {
</span></span><span style=display:flex><span>        if (canvasRef.current === null) {
</span></span><span style=display:flex><span>            return
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const rtScene = RTScene.default.scene
</span></span><span style=display:flex><span>        const rtBoxs = RTScene.default.boxs
</span></span><span style=display:flex><span>        const rtCamera = RTScene.default.camera
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const renderer = new Three.WebGLRenderer({ canvas: canvasRef.current })
</span></span><span style=display:flex><span>        const rendererTarget = new Three.WebGLRenderTarget(512, 512)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const scene = new Three.Scene()
</span></span><span style=display:flex><span>        scene.background = new Three.Color(0x333333)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const light = new Three.DirectionalLight(0xFFFFFF, 1)
</span></span><span style=display:flex><span>        light.position.set(0, 10, 10)
</span></span><span style=display:flex><span>        light.target.position.set(-2, 2, 2)
</span></span><span style=display:flex><span>        scene.add(light)
</span></span><span style=display:flex><span>        scene.add(light.target)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const camera = new Three.PerspectiveCamera(45, 2, 0.1, 100)
</span></span><span style=display:flex><span>        camera.position.z = 15
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const controls = new OrbitControls(camera, canvasRef.current)
</span></span><span style=display:flex><span>        controls.update()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const material = new Three.MeshPhongMaterial({
</span></span><span style=display:flex><span>            map: rendererTarget.texture
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const cubeGeo = new Three.BoxBufferGeometry(4, 4, 4)
</span></span><span style=display:flex><span>        const cubeMesh = new Three.Mesh(cubeGeo, material)
</span></span><span style=display:flex><span>        cubeMesh.position.x = 4
</span></span><span style=display:flex><span>        scene.add(cubeMesh)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const circleGeo = new Three.CircleBufferGeometry(2.8, 36)
</span></span><span style=display:flex><span>        const circleMesh = new Three.Mesh(circleGeo, material)
</span></span><span style=display:flex><span>        circleMesh.position.x = -4
</span></span><span style=display:flex><span>        scene.add(circleMesh)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const render = (time: number) =&gt; {
</span></span><span style=display:flex><span>            time *= 0.001
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            rtBoxs.forEach((item) =&gt; {
</span></span><span style=display:flex><span>                item.rotation.set(time, time, 0)
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>            renderer.setRenderTarget(rendererTarget)
</span></span><span style=display:flex><span>            renderer.render(rtScene, rtCamera)
</span></span><span style=display:flex><span>            renderer.setRenderTarget(null)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            cubeMesh.rotation.set(time, time, 0)
</span></span><span style=display:flex><span>            renderer.render(scene, camera)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            window.requestAnimationFrame(render)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        window.requestAnimationFrame(render)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        const handleResize = () =&gt; {
</span></span><span style=display:flex><span>            if (canvasRef.current === null) {
</span></span><span style=display:flex><span>                return
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            const width = canvasRef.current.clientWidth
</span></span><span style=display:flex><span>            const height = canvasRef.current.clientHeight
</span></span><span style=display:flex><span>            camera.aspect = width / height
</span></span><span style=display:flex><span>            camera.updateProjectionMatrix()
</span></span><span style=display:flex><span>            renderer.setSize(width, height, false)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        handleResize()
</span></span><span style=display:flex><span>        window.addEventListener(&#39;resize&#39;, handleResize)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        return () =&gt; {
</span></span><span style=display:flex><span>            window.removeEventListener(&#39;resize&#39;, handleResize)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }, [canvasRef])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    return (
</span></span><span style=display:flex><span>        &lt;canvas ref={canvasRef} className=&#39;full-screen&#39; /&gt;
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>export default HelloRenderTarget
</span></span></code></pre></div><blockquote><p>è¡¥å……ä¸€ä¸‹ï¼šä¸Šé¢ä»£ç ä¸­å…³äºç¯å…‰çš„ä½ç½®ã€ç¯å…‰ç›®æ ‡çš„ä½ç½®ã€é•œå¤´çš„ä½ç½®ã€ç«‹æ–¹ä½“çš„ä½ç½® éƒ½æ˜¯æˆ‘éšæ‰‹ å¡«ä¸Šçš„ï¼Œå¹¶æ²¡æœ‰ç‰¹åˆ«çš„å«ä¹‰ï¼Œä½ å®Œå…¨å¯ä»¥é€‚å½“ä¿®æ”¹ä¸€ä¸‹ã€‚</p></blockquote><p>å‘å¸ƒè¿è¡Œï¼Œå°±ä¼šåœ¨ç½‘é¡µä¸­çœ‹åˆ° é•œå­çš„ 1 ä¸ªé¢ã€ç«‹æ–¹ä½“çš„ 6 ä¸ªé¢ ä¸Š æ˜¾ç¤ºç€ 3 ä¸ªä¸åœæ—‹è½¬çš„ç«‹æ–¹ä½“ã€‚</p><h4 id=è¡¥å……è¯´æ˜1>è¡¥å……è¯´æ˜1<a hidden class=anchor aria-hidden=true href=#è¡¥å……è¯´æ˜1>#</a></h4><p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä»£ç ä¸­ï¼Œç¦»çº¿æ¸²æŸ“ç›®æ ‡çš„å°ºå¯¸æˆ‘è®¾ç½®çš„å®½é«˜å‡ä¸º 512ï¼Œä½ å®Œå…¨å¯ä»¥è®¾ç½®æˆå…¶ä»–æ¯”ä¾‹çš„å€¼ã€‚</p><p>ä½†æ˜¯ä¸ºäº†ç”»é¢ä¸å‡ºç°å˜å½¢å†…å®¹ï¼Œæ‰€ä»¥è¦éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p><p><strong>ç¦»çº¿æ¸²æŸ“ç›®æ ‡çš„å®½é«˜æ¯”ã€å­åœºæ™¯ä¸­é•œå¤´çš„å®½é«˜æ¯”ã€æ€»åœºæ™¯ä¸­ç‰©ä½“è¢«æ¸²æŸ“çš„é¢çš„å®½é«˜æ¯”ï¼Œè¿™ 3 è€…è¦ä¿æŒä¸€è‡´ï¼Œè¿™æ ·å°±ä¸ä¼šå˜å½¢ã€‚</strong></p><p>å‡è®¾ä½ æƒ³åœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¿®æ”¹ ç¦»çº¿æ¸²æŸ“ç›®æ ‡çš„å®½é«˜ã€ä»¥åŠå­åœºæ™¯ä¸­é•œå¤´çš„å®½é«˜æ¯”ï¼Œå…¶æ“ä½œæ–¹å¼å’Œä¿®æ”¹æ™®é€šçš„æ¸²æŸ“å™¨æˆ–é•œå¤´æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ä¾‹å¦‚ï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>renderTarget.setSize(newWidth,newHeight)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rtCamera.aspect = newWidth/newHeight
</span></span><span style=display:flex><span>rtCamera.updateProjectionMatrix()
</span></span></code></pre></div><h4 id=è¡¥å……è¯´æ˜23dç»˜åˆ¶ä¸­çš„-4-å¤§æ•°æ®ç¼“å†²>è¡¥å……è¯´æ˜2ï¼š3Dç»˜åˆ¶ä¸­çš„ 4 å¤§æ•°æ®ç¼“å†²<a hidden class=anchor aria-hidden=true href=#è¡¥å……è¯´æ˜23dç»˜åˆ¶ä¸­çš„-4-å¤§æ•°æ®ç¼“å†²>#</a></h4><ol><li>é¢œè‰²ç¼“å†²ï¼š</li><li>åƒç´ ç¼“å†²ï¼š</li><li>æ·±åº¦ç¼“å†²ï¼šdepth buffer</li><li>æ¨¡æ¿ç¼“å†²ï¼šstencil buffer</li></ol><blockquote><p>stencilBuffer åˆè¢«ç§°ä¸º å°æ¨¡ç¼“å†²</p></blockquote><p><strong>æ¨¡æ¿(stencil)ä¸æ¨¡æ¿(template)çš„å·®å¼‚ä¹‹å¤„ï¼š</strong></p><p>å•è¯ stencil å’Œ template éƒ½å¯ä»¥è¢«ç¿»è¯‘ä¸º æ¨¡æ¿ï¼Œä½†æ˜¯ä»–ä»¬ 2 è€…å«ä¹‰æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p><p>é¦–å…ˆè¿™ 2 ä¸ªå•è¯éƒ½æ˜¯æ¥æºä»¥ å°åˆ·ã€‚</p><ol><li><p>æ¨¡æ¿(template)ï¼šå½¢æ¨¡ï¼Œä¾‹å¦‚é€šè¿‡ä¿®å‰ª æœ¨æ¿æˆ–é’¢æ¿ çš„å¤–å½¢ï¼Œä»¥æ­¤å¤–å½¢æ¥è¿›è¡Œå°åˆ·</p></li><li><p>æ¨¡æ¿(stencil)ï¼šå°æ¨¡ï¼Œå¦å¤–ä¸€ç§å°åˆ·æŠ€æœ¯ï¼Œä¾‹å¦‚é€šè¿‡èœ¡çº¸æ¥å°åˆ·</p><blockquote><p>ä½ æŠŠ å°æ¨¡ ä¸ å½¢æ¨¡ ç†è§£æˆ 2 ç§ ä¸åŒçš„å°åˆ·æ–¹å¼å³å¯</p></blockquote></li></ol><h4 id=ä¿å­˜-æ¸²æŸ“ç›®æ ‡å¯¹åº”çš„-å›¾ç‰‡çº¹ç†ä¹‹å¤–è¿˜ä¼šé¢å¤–åˆ›å»º-é¢œè‰²çº¹ç†-å’Œ-æ·±åº¦æ¨¡æ¿çº¹ç†>ä¿å­˜ æ¸²æŸ“ç›®æ ‡å¯¹åº”çš„ å›¾ç‰‡çº¹ç†ä¹‹å¤–ï¼Œè¿˜ä¼šé¢å¤–åˆ›å»º é¢œè‰²çº¹ç† å’Œ æ·±åº¦æ¨¡æ¿çº¹ç†<a hidden class=anchor aria-hidden=true href=#ä¿å­˜-æ¸²æŸ“ç›®æ ‡å¯¹åº”çš„-å›¾ç‰‡çº¹ç†ä¹‹å¤–è¿˜ä¼šé¢å¤–åˆ›å»º-é¢œè‰²çº¹ç†-å’Œ-æ·±åº¦æ¨¡æ¿çº¹ç†>#</a></h4><p>ç¦»å±æ¸²æŸ“ç›®æ ‡ é™¤äº†å¾—åˆ°å¹¶ä¿å­˜ æ¸²æŸ“ç›®æ ‡å¯¹åº”çš„ å›¾ç‰‡çº¹ç†ä¹‹å¤–ï¼Œè¿˜ä¼šé¢å¤–åˆ›å»º é¢œè‰²çº¹ç† å’Œ æ·±åº¦æ¨¡æ¿çº¹ç†ã€‚</p><blockquote><p>å›¾ç‰‡çº¹ç†ä¸­ï¼Œå°±ä½¿ç”¨åˆ°äº† åƒç´ ç¼“å†²</p></blockquote><p>åƒæˆ‘ä»¬ä¸Šé¢ç¤ºä¾‹ä¸­æ ¹æœ¬å°±ç”¨ä¸åˆ° æ·±åº¦ç¼“å†²ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ ç¦»å±æ¸²æŸ“ç›®æ ‡åˆå§‹åŒ–çš„æ—¶å€™ï¼Œç›´æ¥è®¾ç½® ä¸éœ€è¦åˆ›å»º æ·±åº¦ç¼“å†² å’Œ æ¨¡æ¿ç¼“å†²ï¼Œä»¥èŠ‚çœæ€§èƒ½ã€‚</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>const rendererTarget = new Three.WebGLRenderTarget(512, 512,{
</span></span><span style=display:flex><span>    depthBuffer:false,
</span></span><span style=display:flex><span>    stencilBuffer:false
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p><strong>è¡¥å……è¯´æ˜ï¼š</strong></p><ol><li>depthBufferï¼šæ·±åº¦ç¼“å­˜ã€é»˜è®¤å€¼ä¸º true</li><li>stencilBufferï¼šæ¨¡æ¿ç¼“å†²ï¼Œé»˜è®¤å€¼ä¸º false</li></ol><blockquote><p>å…³äºä¸Šè¿° è¡¥å……è¯´æ˜2 ã€è¡¥å……è¯´æ˜3 ä¸­çš„å‡ ä¸ªç¼“å†²ï¼Œæˆ‘ä¸ªäººç†è§£ä¹Ÿä¸å¤Ÿæ·±ï¼Œä¸å¤Ÿé€å½»ï¼Œè§‚ç‚¹ä»…ä¾›å‚è€ƒã€‚</p></blockquote><p>è‡³æ­¤ï¼Œç¦»çº¿æ¸²æŸ“ è®²è§£å®Œæ¯•ã€‚</p><p>ä»Šå¤©æ˜¯ 2020å¹´æœ€åä¸€å¤©ï¼Œå¤§å®¶å…ƒæ—¦å¿«ä¹ã€‚</p><p>å…ƒæ—¦è¿‡åï¼Œæˆ‘ä»¬å°†å¼€å§‹å­¦ä¹  Three.js åŸºç¡€ä¸­æœ€å 2 ä¸ªçŸ¥è¯†ï¼šè‡ªå®šä¹‰å‡ ä½•ä½“(current Geometry)ã€è‡ªå®šä¹‰ç¼“å†²å‡ ä½•ä½“(current buffer geometry)</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bablvsj.github.io/tags/three.js/>Three.js</a></li></ul><nav class=paginav><a class=prev href=https://bablvsj.github.io/posts/threejs/14-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E9%9B%BE/><span class=title>Â« Prev</span><br><span>14 Three.jsåŸºç¡€ä¹‹é›¾</span></a>
<a class=next href=https://bablvsj.github.io/posts/threejs/16-three.js%E5%9F%BA%E7%A1%80%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%A0%E4%BD%95%E4%BD%93/><span class=title>Next Â»</span><br><span>16 Three.jsåŸºç¡€ä¹‹è‡ªå®šä¹‰å‡ ä½•ä½“</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://bablvsj.github.io>Bablvsj's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div class=flex-c-d><a class=flex-d-c href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target=_blank><span>æœ¬ç«™ç”±</span><img width=60 src=/images/upyun.png>æä¾›CDNåŠ é€Ÿ/äº‘å­˜å‚¨æœåŠ¡</a></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>