<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>å‰ç«¯è·¨åŸŸNginxã€CORS | Bablvsj's Blog</title><meta name=keywords content="å‰ç«¯ç–‘éš¾æ‚ç—‡"><meta name=description content="å‰ç«¯è·¨åŸŸNginxã€CORS - Bablvsj's Blog"><meta name=author content><link rel=canonical href=https://bablvsj.github.io/posts/tech/frontend/01-%E5%89%8D%E7%AB%AF%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/2-%E5%89%8D%E7%AB%AF%E8%B7%A8%E5%9F%9Fnginxcors/><link crossorigin=anonymous href=/assets/css/stylesheet.241265d51339977eb0f90d05780e286ec2789600ca4137f29552dec9dee06569.css integrity="sha256-JBJl1RM5l36w+Q0FeA4obsJ4lgDKQTfylVLeyd7gZWk=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://bablvsj.github.io/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://bablvsj.github.io/img/Q.gif><link rel=apple-touch-icon href=https://bablvsj.github.io/Q.gif><link rel=mask-icon href=https://bablvsj.github.io/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=stylesheet href=/css/syntax.css><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="å‰ç«¯è·¨åŸŸNginxã€CORS"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://bablvsj.github.io/posts/tech/frontend/01-%E5%89%8D%E7%AB%AF%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/2-%E5%89%8D%E7%AB%AF%E8%B7%A8%E5%9F%9Fnginxcors/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-01T17:11:35+08:00"><meta property="article:modified_time" content="2020-02-01T17:11:35+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="å‰ç«¯è·¨åŸŸNginxã€CORS"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"æ–‡ç« ","item":"https://bablvsj.github.io/posts/"},{"@type":"ListItem","position":3,"name":"å‰ç«¯è·¨åŸŸNginxã€CORS","item":"https://bablvsj.github.io/posts/tech/frontend/01-%E5%89%8D%E7%AB%AF%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/2-%E5%89%8D%E7%AB%AF%E8%B7%A8%E5%9F%9Fnginxcors/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"å‰ç«¯è·¨åŸŸNginxã€CORS","name":"å‰ç«¯è·¨åŸŸNginxã€CORS","description":"","keywords":["å‰ç«¯ç–‘éš¾æ‚ç—‡"],"articleBody":"ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿ è·¨åŸŸæ˜¯æŒ‡ä¸€ä¸ªåŸŸä¸‹çš„æ–‡æ¡£æˆ–è„šæœ¬è¯•å›¾å»è¯·æ±‚å¦ä¸€ä¸ªåŸŸä¸‹çš„èµ„æºï¼Œè¿™é‡Œè·¨åŸŸæ˜¯å¹¿ä¹‰çš„ã€‚\nå¹¿ä¹‰çš„è·¨åŸŸï¼š\n1.) èµ„æºè·³è½¬ï¼š Aé“¾æ¥ã€é‡å®šå‘ã€è¡¨å•æäº¤ 2.) èµ„æºåµŒå…¥ï¼š ã€","wordCount":"3757","inLanguage":"en","datePublished":"2020-02-01T17:11:35+08:00","dateModified":"2020-02-01T17:11:35+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://bablvsj.github.io/posts/tech/frontend/01-%E5%89%8D%E7%AB%AF%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/2-%E5%89%8D%E7%AB%AF%E8%B7%A8%E5%9F%9Fnginxcors/"},"publisher":{"@type":"Organization","name":"Bablvsj's Blog","logo":{"@type":"ImageObject","url":"https://bablvsj.github.io/img/Q.gif"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bablvsj.github.io accesskey=h title="Bablvsj's Blog (Alt + H)">Bablvsj's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bablvsj.github.io/ title=ä¸»é¡µ><span>ä¸»é¡µ</span></a></li><li><a href=https://bablvsj.github.io/archives/ title=æ—¶é—´è½´><span>æ—¶é—´è½´</span></a></li><li><a href=https://bablvsj.github.io/tags title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://bablvsj.github.io/about title=å…³äº><span>å…³äº</span></a></li><li><a href=https://bablvsj.github.io/search title="ğŸ” (Alt + /)" accesskey=/><span>ğŸ”</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>å‰ç«¯è·¨åŸŸNginxã€CORS</h1><div class=post-meta><div class=post-tags-meta><a href=https://bablvsj.github.io/tags/%E5%89%8D%E7%AB%AF%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/>å‰ç«¯ç–‘éš¾æ‚ç—‡</a></div>8 min&nbsp;Â·&nbsp;<span title='2020-02-01 17:11:35 +0800 +0800'>2020/02/01</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><div class=inner><ul><li><a href=#%e4%bb%80%e4%b9%88%e6%98%af%e8%b7%a8%e5%9f%9f aria-label=ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿ><strong>ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿ</strong></a></li><li><a href=#%e4%bb%80%e4%b9%88%e6%98%af%e5%90%8c%e6%ba%90%e7%ad%96%e7%95%a5 aria-label=ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥ï¼Ÿ>ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥ï¼Ÿ</a></li><li><a href=#%e5%b8%b8%e8%a7%81%e8%b7%a8%e5%9f%9f%e5%9c%ba%e6%99%af aria-label=å¸¸è§è·¨åŸŸåœºæ™¯><strong>å¸¸è§è·¨åŸŸåœºæ™¯</strong></a><ul><li><a href=#%e5%90%84%e8%b7%a8%e5%9f%9f%e6%96%b9%e6%a1%88%e5%8c%ba%e5%88%ab aria-label=å„è·¨åŸŸæ–¹æ¡ˆåŒºåˆ«>å„è·¨åŸŸæ–¹æ¡ˆåŒºåˆ«</a></li><li><a href=#1jsonp----%e7%bc%ba%e7%82%b9%e5%8f%aa%e8%83%bd%e5%ae%9e%e7%8e%b0get%e4%b8%80%e7%a7%8d%e8%af%b7%e6%b1%82 aria-label="1ã€jsonp   ï¼ˆ ç¼ºç‚¹ï¼šåªèƒ½å®ç°getä¸€ç§è¯·æ±‚ï¼‰">1ã€jsonp ï¼ˆ ç¼ºç‚¹ï¼šåªèƒ½å®ç°getä¸€ç§è¯·æ±‚ï¼‰</a></li><li><a href=#2%e8%b7%a8%e5%9f%9f%e8%b5%84%e6%ba%90%e5%85%b1%e4%ba%abcors-%e8%ae%be%e7%bd%aeaccess-control-allow-origin aria-label="2ã€è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰ è®¾ç½®Access-Control-Allow-Origin">2ã€è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰ è®¾ç½®Access-Control-Allow-Origin</a><ul><li><a href=#1-%e5%89%8d%e7%ab%af%e8%ae%be%e7%bd%ae aria-label="1ï¼‰ã€ å‰ç«¯è®¾ç½®ï¼š"><strong>1ï¼‰ã€ å‰ç«¯è®¾ç½®ï¼š</strong></a></li><li><a href=#2-%e6%9c%8d%e5%8a%a1%e7%ab%af%e8%ae%be%e7%bd%ae aria-label="2ï¼‰ã€ æœåŠ¡ç«¯è®¾ç½®ï¼š"><strong>2ï¼‰ã€ æœåŠ¡ç«¯è®¾ç½®ï¼š</strong></a></li></ul></li><li><a href=#3nginx%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86%e6%8e%a5%e5%8f%a3%e8%b7%a8%e5%9f%9f aria-label=3ã€nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ>3ã€nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ</a><ul><li><a href=#1-nginx%e9%85%8d%e7%bd%ae%e8%a7%a3%e5%86%b3iconfont%e8%b7%a8%e5%9f%9f aria-label="1ï¼‰ã€ nginxé…ç½®è§£å†³iconfontè·¨åŸŸ">1ï¼‰ã€ nginxé…ç½®è§£å†³iconfontè·¨åŸŸ</a></li><li><a href=#2nginx%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86%e6%8e%a5%e5%8f%a3%e8%b7%a8%e5%9f%9f aria-label=2ï¼‰ã€nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ>2ï¼‰ã€nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ</a></li></ul></li><li><a href=#4-vue%e6%a1%86%e6%9e%b6%e7%9a%84%e8%b7%a8%e5%9f%9fvueconfigjs%e6%96%87%e4%bb%b6%e9%85%8d%e7%bd%ae aria-label="4ã€ vueæ¡†æ¶çš„è·¨åŸŸï¼ˆvue.config.jsæ–‡ä»¶é…ç½®ï¼‰">4ã€ vueæ¡†æ¶çš„è·¨åŸŸï¼ˆvue.config.jsæ–‡ä»¶é…ç½®ï¼‰</a></li><li><a href=#%e6%89%a9%e5%b1%95%e7%9f%a5%e8%af%86-nginx-%e6%ad%a3%e5%90%91%e4%bb%a3%e7%90%86-%e4%bb%a3%e7%90%86%e5%ae%a2%e6%88%b7%e7%ab%af%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86-%e4%bb%a3%e7%90%86%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label="æ‰©å±•çŸ¥è¯†ï¼š nginx æ­£å‘ä»£ç† ä»£ç†å®¢æˆ·ç«¯ï¼Œåå‘ä»£ç† ä»£ç†æœåŠ¡å™¨ã€‚">æ‰©å±•çŸ¥è¯†ï¼š nginx <strong>æ­£å‘ä»£ç† ä»£ç†å®¢æˆ·ç«¯ï¼Œåå‘ä»£ç† ä»£ç†æœåŠ¡å™¨ã€‚</strong></a><ul><li><a href=#1nginx-%e6%ad%a3%e5%90%91%e4%bb%a3%e7%90%86 aria-label="1ã€nginx æ­£å‘ä»£ç†">1ã€nginx æ­£å‘ä»£ç†</a></li><li><a href=#2nginx%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86 aria-label=2ã€nginxåå‘ä»£ç†>2ã€nginxåå‘ä»£ç†</a></li></ul></li></ul></li><li><a href=#nginx%e5%ae%8c%e6%95%b4%e9%85%8d%e7%bd%ae aria-label=Nginxå®Œæ•´é…ç½®>Nginxå®Œæ•´é…ç½®</a></li></ul></div></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h3 id=ä»€ä¹ˆæ˜¯è·¨åŸŸ><strong>ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿ</strong><a hidden class=anchor aria-hidden=true href=#ä»€ä¹ˆæ˜¯è·¨åŸŸ>#</a></h3><p>è·¨åŸŸæ˜¯æŒ‡ä¸€ä¸ªåŸŸä¸‹çš„æ–‡æ¡£æˆ–è„šæœ¬è¯•å›¾å»è¯·æ±‚å¦ä¸€ä¸ªåŸŸä¸‹çš„èµ„æºï¼Œè¿™é‡Œè·¨åŸŸæ˜¯å¹¿ä¹‰çš„ã€‚</p><p>å¹¿ä¹‰çš„è·¨åŸŸï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>1.) èµ„æºè·³è½¬ï¼š Aé“¾æ¥ã€é‡å®šå‘ã€è¡¨å•æäº¤
</span></span><span style=display:flex><span>2.) èµ„æºåµŒå…¥ï¼š &lt;link&gt;ã€&lt;script&gt;ã€&lt;img&gt;ã€&lt;frame&gt;ç­‰domæ ‡ç­¾ï¼Œè¿˜æœ‰æ ·å¼ä¸­background:url()ã€@font-face()ç­‰æ–‡ä»¶å¤–é“¾
</span></span><span style=display:flex><span>3.) è„šæœ¬è¯·æ±‚ï¼š jså‘èµ·çš„ajaxè¯·æ±‚ã€domå’Œjså¯¹è±¡çš„è·¨åŸŸæ“ä½œç­‰
</span></span></code></pre></div><h3 id=ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥>ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥>#</a></h3><p>åŒæºç­–ç•¥/SOPï¼ˆSame origin policyï¼‰æ˜¯ä¸€ç§çº¦å®šï¼Œç”±Netscapeå…¬å¸1995å¹´å¼•å…¥æµè§ˆå™¨ï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æœç¼ºå°‘äº†åŒæºç­–ç•¥ï¼Œæµè§ˆå™¨å¾ˆå®¹æ˜“å—åˆ°XSSã€CSFRç­‰æ”»å‡»ã€‚æ‰€è°“åŒæºæ˜¯æŒ‡"åè®®+åŸŸå+ç«¯å£"ä¸‰è€…ç›¸åŒï¼Œå³ä¾¿ä¸¤ä¸ªä¸åŒçš„åŸŸåæŒ‡å‘åŒä¸€ä¸ªipåœ°å€ï¼Œä¹ŸéåŒæºã€‚</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span> Cookieã€LocalStorage å’Œ IndexDB æ— æ³•è¯»å–
</span></span><span style=display:flex><span>2.) DOM å’Œ Jså¯¹è±¡æ— æ³•è·å¾—
</span></span><span style=display:flex><span>3.) AJAX è¯·æ±‚ä¸èƒ½å‘é€
</span></span></code></pre></div><h3 id=å¸¸è§è·¨åŸŸåœºæ™¯><strong>å¸¸è§è·¨åŸŸåœºæ™¯</strong><a hidden class=anchor aria-hidden=true href=#å¸¸è§è·¨åŸŸåœºæ™¯>#</a></h3><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>URL                                      è¯´æ˜                    æ˜¯å¦å…è®¸é€šä¿¡
</span></span><span style=display:flex><span>http://www.domain.com/a.js
</span></span><span style=display:flex><span>http://www.domain.com/b.js         åŒä¸€åŸŸåï¼Œä¸åŒæ–‡ä»¶æˆ–è·¯å¾„           å…è®¸
</span></span><span style=display:flex><span>http://www.domain.com/lab/c.js
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>http://www.domain.com:8000/a.js
</span></span><span style=display:flex><span>http://www.domain.com/b.js         åŒä¸€åŸŸåï¼Œä¸åŒç«¯å£                ä¸å…è®¸
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>http://www.domain.com/a.js
</span></span><span style=display:flex><span>https://www.domain.com/b.js        åŒä¸€åŸŸåï¼Œä¸åŒåè®®                ä¸å…è®¸
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>http://www.domain.com/a.js
</span></span><span style=display:flex><span>http://192.168.4.12/b.js           åŸŸåå’ŒåŸŸåå¯¹åº”ç›¸åŒip              ä¸å…è®¸
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>http://www.domain.com/a.js
</span></span><span style=display:flex><span>http://x.domain.com/b.js           ä¸»åŸŸç›¸åŒï¼Œå­åŸŸä¸åŒ                ä¸å…è®¸
</span></span><span style=display:flex><span>http://domain.com/c.js
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>http://www.domain1.com/a.js
</span></span><span style=display:flex><span>http://www.domain2.com/b.js        ä¸åŒåŸŸå                         ä¸å…è®¸
</span></span></code></pre></div><h4 id=å„è·¨åŸŸæ–¹æ¡ˆåŒºåˆ«>å„è·¨åŸŸæ–¹æ¡ˆåŒºåˆ«<a hidden class=anchor aria-hidden=true href=#å„è·¨åŸŸæ–¹æ¡ˆåŒºåˆ«>#</a></h4><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>jsonpï¼ˆåªæ”¯æŒgetè¯·æ±‚ï¼Œæ”¯æŒè€çš„IEæµè§ˆå™¨ï¼‰é€‚åˆåŠ è½½ä¸åŒåŸŸåçš„jsã€cssï¼Œimgç­‰é™æ€èµ„æºï¼›
</span></span><span style=display:flex><span>CORSï¼ˆæ”¯æŒæ‰€æœ‰ç±»å‹çš„HTTPè¯·æ±‚ï¼Œä½†æµè§ˆå™¨IE10ä»¥ä¸‹ä¸æ”¯æŒï¼‰é€‚åˆåšajaxå„ç§è·¨åŸŸè¯·æ±‚ï¼›
</span></span><span style=display:flex><span>Nginxä»£ç†è·¨åŸŸå’Œnodejsä¸­é—´ä»¶è·¨åŸŸåŸç†éƒ½ç›¸ä¼¼ï¼Œéƒ½æ˜¯æ­å»ºä¸€ä¸ªæœåŠ¡å™¨ï¼Œç›´æ¥åœ¨æœåŠ¡å™¨ç«¯è¯·æ±‚HTTPæ¥å£ï¼Œé€‚åˆå‰åç«¯åˆ†ç¦»çš„å‰ç«¯é¡¹ç›®è°ƒåç«¯æ¥å£ã€‚
</span></span><span style=display:flex><span>document.domain+iframeé€‚åˆä¸»åŸŸåç›¸åŒï¼Œå­åŸŸåä¸åŒçš„è·¨åŸŸè¯·æ±‚ã€‚
</span></span><span style=display:flex><span>postMessageã€websocketéƒ½æ˜¯HTML5æ–°ç‰¹æ€§ï¼Œå…¼å®¹æ€§ä¸æ˜¯å¾ˆå¥½ï¼Œåªé€‚ç”¨äºä¸»æµæµè§ˆå™¨å’ŒIE10+ã€‚
</span></span></code></pre></div><h4 id=1jsonp----ç¼ºç‚¹åªèƒ½å®ç°getä¸€ç§è¯·æ±‚>1ã€jsonp ï¼ˆ ç¼ºç‚¹ï¼šåªèƒ½å®ç°getä¸€ç§è¯·æ±‚ï¼‰<a hidden class=anchor aria-hidden=true href=#1jsonp----ç¼ºç‚¹åªèƒ½å®ç°getä¸€ç§è¯·æ±‚>#</a></h4><p>1.ï¼‰jquery ajaxï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$.ajax({
</span></span><span style=display:flex><span>    url: &#39;http://www.domain2.com:8080/login&#39;,
</span></span><span style=display:flex><span>    type: &#39;get&#39;,
</span></span><span style=display:flex><span>    dataType: &#39;jsonp&#39;,  // è¯·æ±‚æ–¹å¼ä¸ºjsonp
</span></span><span style=display:flex><span>    jsonpCallback: &#34;handleCallback&#34;,    // è‡ªå®šä¹‰å›è°ƒå‡½æ•°å
</span></span><span style=display:flex><span>    data: {}
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>2.ï¼‰vue.jsï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>this.$http.jsonp(&#39;http://www.domain2.com:8080/login&#39;, {
</span></span><span style=display:flex><span>    params: {},
</span></span><span style=display:flex><span>    jsonp: &#39;handleCallback&#39;
</span></span><span style=display:flex><span>}).then((res) =&gt; {
</span></span><span style=display:flex><span>    console.log(res); 
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h4 id=2è·¨åŸŸèµ„æºå…±äº«cors-è®¾ç½®access-control-allow-origin>2ã€è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰ è®¾ç½®Access-Control-Allow-Origin<a hidden class=anchor aria-hidden=true href=#2è·¨åŸŸèµ„æºå…±äº«cors-è®¾ç½®access-control-allow-origin>#</a></h4><p>æ™®é€šè·¨åŸŸè¯·æ±‚ï¼šåªæœåŠ¡ç«¯è®¾ç½®Access-Control-Allow-Originå³å¯ï¼Œå‰ç«¯æ— é¡»è®¾ç½®ï¼Œè‹¥è¦å¸¦cookieè¯·æ±‚ï¼šå‰åç«¯éƒ½éœ€è¦è®¾ç½®ã€‚</p><p>éœ€æ³¨æ„çš„æ˜¯ï¼šç”±äºåŒæºç­–ç•¥çš„é™åˆ¶ï¼Œæ‰€è¯»å–çš„cookieä¸ºè·¨åŸŸè¯·æ±‚æ¥å£æ‰€åœ¨åŸŸçš„cookieï¼Œè€Œéå½“å‰é¡µã€‚</p><h5 id=1-å‰ç«¯è®¾ç½®><strong>1ï¼‰ã€ å‰ç«¯è®¾ç½®ï¼š</strong><a hidden class=anchor aria-hidden=true href=#1-å‰ç«¯è®¾ç½®>#</a></h5><p>åŸç”Ÿajax</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>// å‰ç«¯è®¾ç½®æ˜¯å¦å¸¦cookie
</span></span><span style=display:flex><span>xhr.withCredentials = true;
</span></span></code></pre></div><p>ç¤ºä¾‹ä»£ç ï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>var xhr = new XMLHttpRequest(); // IE8/9éœ€ç”¨window.XDomainRequestå…¼å®¹
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// å‰ç«¯è®¾ç½®æ˜¯å¦å¸¦cookie
</span></span><span style=display:flex><span>xhr.withCredentials = true;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>xhr.open(&#39;post&#39;, &#39;http://www.domain2.com:8080/login&#39;, true);
</span></span><span style=display:flex><span>xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application/x-www-form-urlencoded&#39;);
</span></span><span style=display:flex><span>xhr.send(&#39;user=admin&#39;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>xhr.onreadystatechange = function() {
</span></span><span style=display:flex><span>    if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) {
</span></span><span style=display:flex><span>        alert(xhr.responseText);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h5 id=2-æœåŠ¡ç«¯è®¾ç½®><strong>2ï¼‰ã€ æœåŠ¡ç«¯è®¾ç½®ï¼š</strong><a hidden class=anchor aria-hidden=true href=#2-æœåŠ¡ç«¯è®¾ç½®>#</a></h5><p>è‹¥åç«¯è®¾ç½®æˆåŠŸï¼Œå‰ç«¯æµè§ˆå™¨æ§åˆ¶å°åˆ™ä¸ä¼šå‡ºç°è·¨åŸŸæŠ¥é”™ä¿¡æ¯ï¼Œåä¹‹ï¼Œè¯´æ˜æ²¡è®¾æˆåŠŸã€‚</p><p>1.ï¼‰Javaåå°ï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>/*
</span></span><span style=display:flex><span> * å¯¼å…¥åŒ…ï¼šimport javax.servlet.http.HttpServletResponse;
</span></span><span style=display:flex><span> * æ¥å£å‚æ•°ä¸­å®šä¹‰ï¼šHttpServletResponse response
</span></span><span style=display:flex><span> */
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// å…è®¸è·¨åŸŸè®¿é—®çš„åŸŸåï¼šè‹¥æœ‰ç«¯å£éœ€å†™å…¨ï¼ˆåè®®+åŸŸå+ç«¯å£ï¼‰ï¼Œè‹¥æ²¡æœ‰ç«¯å£æœ«å°¾ä¸ç”¨åŠ &#39;/&#39;
</span></span><span style=display:flex><span>response.setHeader(&#34;Access-Control-Allow-Origin&#34;, &#34;http://www.domain1.com&#34;); 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// å…è®¸å‰ç«¯å¸¦è®¤è¯cookieï¼šå¯ç”¨æ­¤é¡¹åï¼Œä¸Šé¢çš„åŸŸåä¸èƒ½ä¸º&#39;*&#39;ï¼Œå¿…é¡»æŒ‡å®šå…·ä½“çš„åŸŸåï¼Œå¦åˆ™æµè§ˆå™¨ä¼šæç¤º
</span></span><span style=display:flex><span>response.setHeader(&#34;Access-Control-Allow-Credentials&#34;, &#34;true&#34;); 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// æç¤ºOPTIONSé¢„æ£€æ—¶ï¼Œåç«¯éœ€è¦è®¾ç½®çš„ä¸¤ä¸ªå¸¸ç”¨è‡ªå®šä¹‰å¤´
</span></span><span style=display:flex><span>response.setHeader(&#34;Access-Control-Allow-Headers&#34;, &#34;Content-Type,X-Requested-With&#34;);
</span></span></code></pre></div><p>2.ï¼‰Nodejsåå°ç¤ºä¾‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>var http = require(&#39;http&#39;);
</span></span><span style=display:flex><span>var server = http.createServer();
</span></span><span style=display:flex><span>var qs = require(&#39;querystring&#39;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>server.on(&#39;request&#39;, function(req, res) {
</span></span><span style=display:flex><span>    var postData = &#39;&#39;;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    // æ•°æ®å—æ¥æ”¶ä¸­
</span></span><span style=display:flex><span>    req.addListener(&#39;data&#39;, function(chunk) {
</span></span><span style=display:flex><span>        postData += chunk;
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    // æ•°æ®æ¥æ”¶å®Œæ¯•
</span></span><span style=display:flex><span>    req.addListener(&#39;end&#39;, function() {
</span></span><span style=display:flex><span>        postData = qs.parse(postData);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        // è·¨åŸŸåå°è®¾ç½®
</span></span><span style=display:flex><span>        res.writeHead(200, {
</span></span><span style=display:flex><span>            &#39;Access-Control-Allow-Credentials&#39;: &#39;true&#39;,     // åç«¯å…è®¸å‘é€Cookie
</span></span><span style=display:flex><span>            &#39;Access-Control-Allow-Origin&#39;: &#39;http://www.domain1.com&#39;,    // å…è®¸è®¿é—®çš„åŸŸï¼ˆåè®®+åŸŸå+ç«¯å£ï¼‰
</span></span><span style=display:flex><span>            /* 
</span></span><span style=display:flex><span>             * æ­¤å¤„è®¾ç½®çš„cookieè¿˜æ˜¯domain2çš„è€Œédomain1ï¼Œå› ä¸ºåç«¯ä¹Ÿä¸èƒ½è·¨åŸŸå†™cookie(nginxåå‘ä»£ç†å¯ä»¥å®ç°)ï¼Œ
</span></span><span style=display:flex><span>             * ä½†åªè¦domain2ä¸­å†™å…¥ä¸€æ¬¡cookieè®¤è¯ï¼Œåé¢çš„è·¨åŸŸæ¥å£éƒ½èƒ½ä»domain2ä¸­è·å–cookieï¼Œä»è€Œå®ç°æ‰€æœ‰çš„æ¥å£éƒ½èƒ½è·¨åŸŸè®¿é—®
</span></span><span style=display:flex><span>             */
</span></span><span style=display:flex><span>            &#39;Set-Cookie&#39;: &#39;l=a123456;Path=/;Domain=www.domain2.com;HttpOnly&#39;  // HttpOnlyçš„
</span></span></code></pre></div><h4 id=3nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ>3ã€nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ<a hidden class=anchor aria-hidden=true href=#3nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ>#</a></h4><h5 id=1-nginxé…ç½®è§£å†³iconfontè·¨åŸŸ>1ï¼‰ã€ nginxé…ç½®è§£å†³iconfontè·¨åŸŸ<a hidden class=anchor aria-hidden=true href=#1-nginxé…ç½®è§£å†³iconfontè·¨åŸŸ>#</a></h5><p>æµè§ˆå™¨è·¨åŸŸè®¿é—®jsã€cssã€imgç­‰å¸¸è§„é™æ€èµ„æºè¢«åŒæºç­–ç•¥è®¸å¯ï¼Œä½†iconfontå­—ä½“æ–‡ä»¶(eot|otf|ttf|woff|svg)ä¾‹å¤–ï¼Œæ­¤æ—¶å¯åœ¨nginxçš„é™æ€èµ„æºæœåŠ¡å™¨ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®ã€‚</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>location / {
</span></span><span style=display:flex><span>  add_header Access-Control-Allow-Origin *;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h5 id=2nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ>2ï¼‰ã€nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ<a hidden class=anchor aria-hidden=true href=#2nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ>#</a></h5><p>è·¨åŸŸåŸç†ï¼š åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥ï¼Œä¸æ˜¯HTTPåè®®çš„ä¸€éƒ¨åˆ†ã€‚æœåŠ¡å™¨ç«¯è°ƒç”¨HTTPæ¥å£åªæ˜¯ä½¿ç”¨HTTPåè®®ï¼Œä¸ä¼šæ‰§è¡ŒJSè„šæœ¬ï¼Œä¸éœ€è¦åŒæºç­–ç•¥ï¼Œä¹Ÿå°±ä¸å­˜åœ¨è·¨è¶Šé—®é¢˜ã€‚</p><p>å®ç°æ€è·¯ï¼šé€šè¿‡nginxé…ç½®ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼ˆåŸŸåä¸domain1ç›¸åŒï¼Œç«¯å£ä¸åŒï¼‰åšè·³æ¿æœºï¼Œåå‘ä»£ç†è®¿é—®domain2æ¥å£ï¼Œå¹¶ä¸”å¯ä»¥é¡ºä¾¿ä¿®æ”¹cookieä¸­domainä¿¡æ¯ï¼Œæ–¹ä¾¿å½“å‰åŸŸcookieå†™å…¥ï¼Œå®ç°è·¨åŸŸç™»å½•ã€‚</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span> server {
</span></span><span style=display:flex><span>    listen	<span style=color:#8f3f71>80</span> 				#ç›‘å¬80ç«¯å£ï¼Œè®¿é—®åŸŸåä¸ºwww.<span style=color:#8f3f71>123.</span>comï¼Œä¸åŠ ç«¯å£å·æ—¶é»˜è®¤ä¸º80ç«¯å£
</span></span><span style=display:flex><span>	listen <span style=color:#af3a03>*:</span><span style=color:#8f3f71>80</span> <span style=color:#af3a03>|</span> <span style=color:#af3a03>*:</span><span style=color:#8f3f71>8080</span> 	#ç›‘å¬æ‰€æœ‰80ç«¯å£å’Œ8080ç«¯å£
</span></span><span style=display:flex><span>	listen  IP_address		#ç›‘å¬æŒ‡å®šipåœ°å€æ‰€æœ‰ç«¯å£
</span></span><span style=display:flex><span>	listen port     		#ç›‘å¬è¯¥ç«¯å£çš„æ‰€æœ‰IPè¿æ¥
</span></span><span style=display:flex><span>	server_name  www.<span style=color:#8f3f71>123.</span>com www.baidu.com;  #å¤šä¸ªç”¨ç©ºæ ¼éš”å¼€
</span></span><span style=display:flex><span>     #è®¿é—®è¯¥åŸŸåæ—¶ä¼šè·³è½¬åˆ°127.<span style=color:#8f3f71>0.0</span>.<span style=color:#8f3f71>1</span><span style=color:#af3a03>:</span><span style=color:#8f3f71>8080</span>è·¯å¾„
</span></span><span style=display:flex><span>     #é€šé…ç¬¦åªèƒ½ç”¨åœ¨ç”±ä¸‰æ®µå­—ç¬¦ç»„æˆçš„é¦–æ®µæˆ–è€…å°¾ç«¯ï¼Œæˆ–è€…ç”±ä¸¤ç«¯å­—ç¬¦ç»„æˆçš„å°¾ç«¯ server_name <span style=color:#af3a03>*</span>.<span style=color:#8f3f71>123.</span>com www.<span style=color:#8f3f71>123.</span><span style=color:#af3a03>*</span>
</span></span><span style=display:flex><span>     #æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨â€œ<span style=color:#af3a03>~</span>â€ä½œä¸ºæ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²çš„å¼€å§‹æ ‡è®°
</span></span><span style=display:flex><span>	 #server_name <span style=color:#af3a03>~^</span>www\d<span style=color:#af3a03>+</span>\.<span style=color:#8f3f71>123</span>\.com$;
</span></span><span style=display:flex><span>     #â€œ<span style=color:#af3a03>~</span>â€è¡¨ç¤ºåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»¥wwwå¼€å¤´ï¼ˆâ€œ<span style=color:#af3a03>^</span>â€è¡¨ç¤ºå¼€å¤´ï¼‰ï¼Œç´§è·Ÿç€ä¸€ä¸ª0<span style=color:#af3a03>~</span><span style=color:#8f3f71>9</span>ä¹‹é—´çš„æ•°å­—ï¼Œå†ç´§è·Ÿâ€œ.<span style=color:#8f3f71>123.</span>coâ€ï¼Œæœ€åè·Ÿç€â€œmâ€($è¡¨ç¤ºç»“å°¾)
</span></span><span style=display:flex><span>     #åŸºäº IP åœ°å€çš„è™šæ‹Ÿä¸»æœºé…ç½® <span style=color:#af3a03>==</span> åŸŸååŒ¹é… ï¼ˆä¸è€ƒè™‘é€šé…ç¬¦å’Œæ­£åˆ™è¡¨è¾¾å¼ï¼‰ server_name <span style=color:#8f3f71>192.168</span>.<span style=color:#8f3f71>1.1</span>
</span></span><span style=display:flex><span>     åŒ¹é…é¡ºåºï¼š
</span></span><span style=display:flex><span> 		â‘ ã€å‡†ç¡®åŒ¹é… server_name
</span></span><span style=display:flex><span>        â‘¡ã€é€šé…ç¬¦åœ¨å¼€å§‹æ—¶åŒ¹é… server_name æˆåŠŸ
</span></span><span style=display:flex><span>        â‘¢ã€é€šé…ç¬¦åœ¨ç»“å°¾æ—¶åŒ¹é… server_name æˆåŠŸ
</span></span><span style=display:flex><span>        â‘£ã€æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… server_name æˆåŠŸ
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	location <span style=color:#af3a03>/</span> {    #ç”¨äºåŒ¹é… URL    
</span></span><span style=display:flex><span>		proxy_pass http<span style=color:#af3a03>:</span><span style=color:#8f3f71>127.0</span>.<span style=color:#8f3f71>0.1</span><span style=color:#af3a03>:</span><span style=color:#8f3f71>8080</span>;   #ç”¨äºè®¾ç½®è¢«ä»£ç†æœåŠ¡å™¨çš„åœ°å€ã€‚å¯ä»¥æ˜¯ä¸»æœºåç§°ã€IPåœ°å€åŠ ç«¯å£å·çš„å½¢å¼
</span></span><span style=display:flex><span>		index  index.html index.htm index.jsp; #ç”¨äºè®¾ç½®ç½‘ç«™çš„é»˜è®¤é¦–é¡µ å¯æœ‰å¤šä¸ªç”¨ç©ºæ ¼éš”å¼€  index.html index.jsp
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=4-vueæ¡†æ¶çš„è·¨åŸŸvueconfigjsæ–‡ä»¶é…ç½®>4ã€ vueæ¡†æ¶çš„è·¨åŸŸï¼ˆvue.config.jsæ–‡ä»¶é…ç½®ï¼‰<a hidden class=anchor aria-hidden=true href=#4-vueæ¡†æ¶çš„è·¨åŸŸvueconfigjsæ–‡ä»¶é…ç½®>#</a></h4><p>åˆ©ç”¨node + webpack + webpack-dev-serverä»£ç†æ¥å£è·¨åŸŸã€‚åœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œç”±äºvueæ¸²æŸ“æœåŠ¡å’Œæ¥å£ä»£ç†æœåŠ¡éƒ½æ˜¯webpack-dev-serveråŒä¸€ä¸ªï¼Œæ‰€ä»¥é¡µé¢ä¸ä»£ç†æ¥å£ä¹‹é—´ä¸å†è·¨åŸŸï¼Œæ— é¡»è®¾ç½®headersè·¨åŸŸä¿¡æ¯äº†ã€‚</p><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>module.exports = {
</span></span><span style=display:flex><span>    entry: {},
</span></span><span style=display:flex><span>    module: {},
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>    devServer: {
</span></span><span style=display:flex><span>        historyApiFallback: true,
</span></span><span style=display:flex><span>        proxy: [{
</span></span><span style=display:flex><span>            context: &#39;/login&#39;,
</span></span><span style=display:flex><span>            target: &#39;http://www.domain2.com:8080&#39;,  // ä»£ç†è·¨åŸŸç›®æ ‡æ¥å£
</span></span><span style=display:flex><span>            changeOrigin: true,
</span></span><span style=display:flex><span>            secure: false,  // å½“ä»£ç†æŸäº›httpsæœåŠ¡æŠ¥é”™æ—¶ç”¨
</span></span><span style=display:flex><span>            cookieDomainRewrite: &#39;www.domain1.com&#39;  // å¯ä»¥ä¸ºfalseï¼Œè¡¨ç¤ºä¸ä¿®æ”¹
</span></span><span style=display:flex><span>        }],
</span></span><span style=display:flex><span>        noInfo: true
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=æ‰©å±•çŸ¥è¯†-nginx-æ­£å‘ä»£ç†-ä»£ç†å®¢æˆ·ç«¯åå‘ä»£ç†-ä»£ç†æœåŠ¡å™¨>æ‰©å±•çŸ¥è¯†ï¼š nginx <strong>æ­£å‘ä»£ç† ä»£ç†å®¢æˆ·ç«¯ï¼Œåå‘ä»£ç† ä»£ç†æœåŠ¡å™¨ã€‚</strong><a hidden class=anchor aria-hidden=true href=#æ‰©å±•çŸ¥è¯†-nginx-æ­£å‘ä»£ç†-ä»£ç†å®¢æˆ·ç«¯åå‘ä»£ç†-ä»£ç†æœåŠ¡å™¨>#</a></h4><h5 id=1nginx-æ­£å‘ä»£ç†>1ã€nginx æ­£å‘ä»£ç†<a hidden class=anchor aria-hidden=true href=#1nginx-æ­£å‘ä»£ç†>#</a></h5><h5 id=2nginxåå‘ä»£ç†>2ã€nginxåå‘ä»£ç†<a hidden class=anchor aria-hidden=true href=#2nginxåå‘ä»£ç†>#</a></h5><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span> server {
</span></span><span style=display:flex><span>    listen	<span style=color:#8f3f71>80</span> 				#ç›‘å¬80ç«¯å£ï¼Œè®¿é—®åŸŸåä¸ºwww.<span style=color:#8f3f71>123.</span>comï¼Œä¸åŠ ç«¯å£å·æ—¶é»˜è®¤ä¸º80ç«¯å£
</span></span><span style=display:flex><span>	listen <span style=color:#af3a03>*:</span><span style=color:#8f3f71>80</span> <span style=color:#af3a03>|</span> <span style=color:#af3a03>*:</span><span style=color:#8f3f71>8080</span> 	#ç›‘å¬æ‰€æœ‰80ç«¯å£å’Œ8080ç«¯å£
</span></span><span style=display:flex><span>	listen  IP_address		#ç›‘å¬æŒ‡å®šipåœ°å€æ‰€æœ‰ç«¯å£
</span></span><span style=display:flex><span>	listen port     		#ç›‘å¬è¯¥ç«¯å£çš„æ‰€æœ‰IPè¿æ¥
</span></span><span style=display:flex><span>	server_name  www.<span style=color:#8f3f71>123.</span>com www.baidu.com;  #å¤šä¸ªç”¨ç©ºæ ¼éš”å¼€
</span></span><span style=display:flex><span>     #è®¿é—®è¯¥åŸŸåæ—¶ä¼šè·³è½¬åˆ°127.<span style=color:#8f3f71>0.0</span>.<span style=color:#8f3f71>1</span><span style=color:#af3a03>:</span><span style=color:#8f3f71>8080</span>è·¯å¾„
</span></span><span style=display:flex><span>     #é€šé…ç¬¦åªèƒ½ç”¨åœ¨ç”±ä¸‰æ®µå­—ç¬¦ç»„æˆçš„é¦–æ®µæˆ–è€…å°¾ç«¯ï¼Œæˆ–è€…ç”±ä¸¤ç«¯å­—ç¬¦ç»„æˆçš„å°¾ç«¯ server_name <span style=color:#af3a03>*</span>.<span style=color:#8f3f71>123.</span>com www.<span style=color:#8f3f71>123.</span><span style=color:#af3a03>*</span>
</span></span><span style=display:flex><span>     #æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨â€œ<span style=color:#af3a03>~</span>â€ä½œä¸ºæ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²çš„å¼€å§‹æ ‡è®°
</span></span><span style=display:flex><span>	 #server_name <span style=color:#af3a03>~^</span>www\d<span style=color:#af3a03>+</span>\.<span style=color:#8f3f71>123</span>\.com$;
</span></span><span style=display:flex><span>     #â€œ<span style=color:#af3a03>~</span>â€è¡¨ç¤ºåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»¥wwwå¼€å¤´ï¼ˆâ€œ<span style=color:#af3a03>^</span>â€è¡¨ç¤ºå¼€å¤´ï¼‰ï¼Œç´§è·Ÿç€ä¸€ä¸ª0<span style=color:#af3a03>~</span><span style=color:#8f3f71>9</span>ä¹‹é—´çš„æ•°å­—ï¼Œå†ç´§è·Ÿâ€œ.<span style=color:#8f3f71>123.</span>coâ€ï¼Œæœ€åè·Ÿç€â€œmâ€($è¡¨ç¤ºç»“å°¾)
</span></span><span style=display:flex><span>     #åŸºäº IP åœ°å€çš„è™šæ‹Ÿä¸»æœºé…ç½® <span style=color:#af3a03>==</span> åŸŸååŒ¹é… ï¼ˆä¸è€ƒè™‘é€šé…ç¬¦å’Œæ­£åˆ™è¡¨è¾¾å¼ï¼‰ server_name <span style=color:#8f3f71>192.168</span>.<span style=color:#8f3f71>1.1</span>
</span></span><span style=display:flex><span>     åŒ¹é…é¡ºåºï¼š
</span></span><span style=display:flex><span> 		â‘ ã€å‡†ç¡®åŒ¹é… server_name
</span></span><span style=display:flex><span>        â‘¡ã€é€šé…ç¬¦åœ¨å¼€å§‹æ—¶åŒ¹é… server_name æˆåŠŸ
</span></span><span style=display:flex><span>        â‘¢ã€é€šé…ç¬¦åœ¨ç»“å°¾æ—¶åŒ¹é… server_name æˆåŠŸ
</span></span><span style=display:flex><span>        â‘£ã€æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… server_name æˆåŠŸ
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	location <span style=color:#af3a03>/</span> {    #ç”¨äºåŒ¹é… URL    
</span></span><span style=display:flex><span>		proxy_pass http<span style=color:#af3a03>:</span><span style=color:#8f3f71>127.0</span>.<span style=color:#8f3f71>0.1</span><span style=color:#af3a03>:</span><span style=color:#8f3f71>8080</span>;   #ç”¨äºè®¾ç½®è¢«ä»£ç†æœåŠ¡å™¨çš„åœ°å€ã€‚å¯ä»¥æ˜¯ä¸»æœºåç§°ã€IPåœ°å€åŠ ç«¯å£å·çš„å½¢å¼
</span></span><span style=display:flex><span>		index  index.html index.htm index.jsp; #ç”¨äºè®¾ç½®ç½‘ç«™çš„é»˜è®¤é¦–é¡µ å¯æœ‰å¤šä¸ªç”¨ç©ºæ ¼éš”å¼€  index.html index.jsp
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=nginxå®Œæ•´é…ç½®>Nginxå®Œæ•´é…ç½®<a hidden class=anchor aria-hidden=true href=#nginxå®Œæ•´é…ç½®>#</a></h3><div class=highlight><pre tabindex=0 style=color:#3c3836;background-color:#fbf1c7;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>user  nginx;
</span></span><span style=display:flex><span>worker_processes  <span style=color:#8f3f71>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>error_log  <span style=color:#af3a03>/</span><span style=color:#af3a03>var</span>/log/nginx/error.log warn;
</span></span><span style=display:flex><span>pid        <span style=color:#af3a03>/</span><span style=color:#af3a03>var</span>/run/nginx.pid;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>events {
</span></span><span style=display:flex><span>    worker_connections  <span style=color:#8f3f71>1024</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>http {
</span></span><span style=display:flex><span>    include       <span style=color:#af3a03>/</span>etc<span style=color:#af3a03>/</span>nginx<span style=color:#af3a03>/</span>mime.types;
</span></span><span style=display:flex><span>    default_type  application<span style=color:#af3a03>/</span>octet<span style=color:#af3a03>-</span>stream;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    log_format  main  <span style=color:#79740e>&#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; &#39;</span>
</span></span><span style=display:flex><span>                      <span style=color:#79740e>&#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;</span>
</span></span><span style=display:flex><span>                      <span style=color:#79740e>&#39;&#34;$http_user_agent&#34; &#34;$http_x_forwarded_for&#34;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    access_log  <span style=color:#af3a03>/</span><span style=color:#af3a03>var</span>/log/nginx/access.log  main;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    sendfile        on;
</span></span><span style=display:flex><span>    #tcp_nopush     on;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    keepalive_timeout  <span style=color:#8f3f71>65</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    #gzip  on;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    # include <span style=color:#af3a03>/</span>etc<span style=color:#af3a03>/</span>nginx<span style=color:#af3a03>/</span>conf.d<span style=color:#af3a03>/*</span>.conf; # å¼•å…¥default.confé…ç½®æ–‡ä»¶
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>    server {
</span></span><span style=display:flex><span>        listen       <span style=color:#8f3f71>80</span>;
</span></span><span style=display:flex><span>        server_name  www.zhengqing520.com;# æœåŠ¡å™¨åœ°å€æˆ–ç»‘å®šåŸŸå
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        #charset koi8<span style=color:#af3a03>-</span>r;
</span></span><span style=display:flex><span>        #access_log  <span style=color:#af3a03>/</span><span style=color:#af3a03>var</span>/log/nginx/host.access.log  main;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        # start <span style=color:#af3a03>------------------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        location <span style=color:#af3a03>/</span> {
</span></span><span style=display:flex><span>            root   <span style=color:#af3a03>/</span>usr<span style=color:#af3a03>/</span>share<span style=color:#af3a03>/</span>nginx<span style=color:#af3a03>/</span>html;
</span></span><span style=display:flex><span>            try_files $uri $uri<span style=color:#af3a03>/</span> @router;
</span></span><span style=display:flex><span>            index  index.html index.htm;
</span></span><span style=display:flex><span>            # proxy_pass http<span style=color:#af3a03>:</span><span style=color:#928374;font-style:italic>//zhengqingya.gitee.io; # ä»£ç†çš„ipåœ°å€å’Œç«¯å£å·
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>            # proxy_connect_timeout <span style=color:#8f3f71>600</span>; #ä»£ç†çš„è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰
</span></span><span style=display:flex><span>            # proxy_read_timeout <span style=color:#8f3f71>600</span>; #ä»£ç†çš„è¯»å–èµ„æºè¶…æ—¶æ—¶é—´ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰
</span></span><span style=display:flex><span>        } 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        location @router {
</span></span><span style=display:flex><span>            rewrite <span style=color:#af3a03>^</span>.<span style=color:#af3a03>*</span>$ <span style=color:#af3a03>/</span>index.html last;  
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        location <span style=color:#af3a03>^~</span> /api {  # ^~/api/è¡¨ç¤ºåŒ¹é…å‰ç¼€ä¸ºapiçš„è¯·æ±‚
</span></span><span style=display:flex><span>            proxy_pass  http<span style=color:#af3a03>:</span><span style=color:#928374;font-style:italic>//www.zhengqing520.com:9528/api/;  
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>        	# æ³¨ï¼šproxy_passçš„ç»“å°¾æœ‰<span style=color:#af3a03>/</span>ï¼Œ <span style=color:#af3a03>-&gt;</span> æ•ˆæœï¼šä¼šåœ¨è¯·æ±‚æ—¶å°†<span style=color:#af3a03>/</span>api<span style=color:#af3a03>/*</span>åé¢çš„è·¯å¾„ç›´æ¥æ‹¼æ¥åˆ°åé¢
</span></span><span style=display:flex><span>            # proxy_set_headerä½œç”¨ï¼šè®¾ç½®å‘é€åˆ°åç«¯æœåŠ¡å™¨(ä¸Šé¢proxy_pass)çš„è¯·æ±‚å¤´å€¼  
</span></span><span style=display:flex><span>               # ã€å½“Hostè®¾ç½®ä¸º $http_host æ—¶ï¼Œåˆ™ä¸æ”¹å˜è¯·æ±‚å¤´çš„å€¼;
</span></span><span style=display:flex><span>               #  å½“Hostè®¾ç½®ä¸º $proxy_host æ—¶ï¼Œåˆ™ä¼šé‡æ–°è®¾ç½®è¯·æ±‚å¤´ä¸­çš„Hostä¿¡æ¯;
</span></span><span style=display:flex><span>               #  å½“ä¸º$hostå˜é‡æ—¶ï¼Œå®ƒçš„å€¼åœ¨è¯·æ±‚åŒ…å«Hostè¯·æ±‚å¤´æ—¶ä¸ºHostå­—æ®µçš„å€¼ï¼Œåœ¨è¯·æ±‚æœªæºå¸¦Hostè¯·æ±‚å¤´æ—¶ä¸ºè™šæ‹Ÿä¸»æœºçš„ä¸»åŸŸå;
</span></span><span style=display:flex><span>               #  å½“ä¸º$host<span style=color:#af3a03>:</span>$proxy_portæ—¶ï¼Œå³æºå¸¦ç«¯å£å‘é€ ex<span style=color:#af3a03>:</span> $host<span style=color:#af3a03>:</span><span style=color:#8f3f71>8080</span> ã€‘
</span></span><span style=display:flex><span>            proxy_set_header Host $host; 
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>            proxy_set_header X<span style=color:#af3a03>-</span>Real<span style=color:#af3a03>-</span>IP $remote_addr; 
</span></span><span style=display:flex><span>        	# åœ¨webæœåŠ¡å™¨ç«¯è·å¾—ç”¨æˆ·çš„çœŸå®ip éœ€é…ç½®æ¡ä»¶	â‘  ã€ $remote_addrå€¼ <span style=color:#af3a03>=</span> ç”¨æˆ·ip ã€‘
</span></span><span style=display:flex><span>            proxy_set_header X<span style=color:#af3a03>-</span>Forwarded<span style=color:#af3a03>-</span>For $proxy_add_x_forwarded_for;
</span></span><span style=display:flex><span>       		 # åœ¨webæœåŠ¡å™¨ç«¯è·å¾—ç”¨æˆ·çš„çœŸå®ip éœ€é…ç½®æ¡ä»¶â‘¡
</span></span><span style=display:flex><span>            proxy_set_header REMOTE<span style=color:#af3a03>-</span>HOST $remote_addr;
</span></span><span style=display:flex><span>            # proxy_set_header X<span style=color:#af3a03>-</span>Forwarded<span style=color:#af3a03>-</span>For $http_x_forwarded_for; 
</span></span><span style=display:flex><span>            # $http_x_forwarded_forå˜é‡ <span style=color:#af3a03>=</span> X<span style=color:#af3a03>-</span>Forwarded<span style=color:#af3a03>-</span>Forå˜é‡
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        location <span style=color:#af3a03>^~</span> <span style=color:#79740e>/blog/</span> { # <span style=color:#af3a03>^~</span><span style=color:#79740e>/blog/</span> è¡¨ç¤ºåŒ¹é…å‰ç¼€ä¸ºblog<span style=color:#af3a03>/</span>åçš„è¯·æ±‚
</span></span><span style=display:flex><span>            proxy_pass  http<span style=color:#af3a03>:</span><span style=color:#928374;font-style:italic>//zhengqingya.gitee.io/blog/;   
</span></span></span><span style=display:flex><span><span style=color:#928374;font-style:italic></span>      
</span></span><span style=display:flex><span>            proxy_set_header Host $proxy_host; # æ”¹å˜è¯·æ±‚å¤´å€¼ <span style=color:#af3a03>-&gt;</span> è½¬å‘åˆ°ç äº‘æ‰ä¼šæˆåŠŸ
</span></span><span style=display:flex><span>            proxy_set_header  X<span style=color:#af3a03>-</span>Real<span style=color:#af3a03>-</span>IP  $remote_addr;
</span></span><span style=display:flex><span>            proxy_set_header  X<span style=color:#af3a03>-</span>Forwarded<span style=color:#af3a03>-</span>For $proxy_add_x_forwarded_for;
</span></span><span style=display:flex><span>            proxy_set_header X<span style=color:#af3a03>-</span>NginX<span style=color:#af3a03>-</span><span style=color:#b57614>Proxy</span> <span style=color:#af3a03>true</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>       
</span></span><span style=display:flex><span>        # end <span style=color:#af3a03>---------------------------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        #error_page  <span style=color:#8f3f71>404</span>              <span style=color:#af3a03>/</span><span style=color:#8f3f71>404.</span>html;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        # redirect server error pages to the <span style=color:#af3a03>static</span> page <span style=color:#af3a03>/</span><span style=color:#8f3f71>50</span>x.html
</span></span><span style=display:flex><span>        #
</span></span><span style=display:flex><span>        error_page   <span style=color:#8f3f71>500</span> <span style=color:#8f3f71>502</span> <span style=color:#8f3f71>503</span> <span style=color:#8f3f71>504</span>  <span style=color:#af3a03>/</span><span style=color:#8f3f71>50</span>x.html;
</span></span><span style=display:flex><span>        location <span style=color:#af3a03>=</span> /50x.html {
</span></span><span style=display:flex><span>            root   <span style=color:#af3a03>/</span>usr<span style=color:#af3a03>/</span>share<span style=color:#af3a03>/</span>nginx<span style=color:#af3a03>/</span>html;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://bablvsj.github.io/tags/%E5%89%8D%E7%AB%AF%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/>å‰ç«¯ç–‘éš¾æ‚ç—‡</a></li></ul><nav class=paginav><a class=prev href=https://bablvsj.github.io/posts/tech/frontend/01-%E5%89%8D%E7%AB%AF%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/4-this%E6%8C%87%E5%90%91applycallbind/><span class=title>Â« Prev</span><br><span>thisæŒ‡å‘ã€applyã€callã€bind</span></a>
<a class=next href=https://bablvsj.github.io/posts/tech/frontend/01-%E5%89%8D%E7%AB%AF%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/%E5%8E%9F%E5%9E%8B%E5%8E%9F%E5%9E%8B%E9%93%BE/><span class=title>Next Â»</span><br><span>åŸå‹ã€åŸå‹é“¾</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://bablvsj.github.io>Bablvsj's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div class=flex-c-d><a class=flex-d-c href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target=_blank><span>æœ¬ç«™ç”±</span><img width=60 src=/images/upyun.png>æä¾›CDNåŠ é€Ÿ/äº‘å­˜å‚¨æœåŠ¡</a></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>